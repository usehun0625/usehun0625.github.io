
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Kevin의 블로그">
    <title>Kinesis Data Stream - 샤드당 제약 조건 확인 - Kevin의 블로그</title>
    <meta name="author" content="Kevin">
    
    
        <link rel="icon" href="http://usehun0625.github.io/assets/images/beer_favaicon.png">
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Kevin","sameAs":["https://github.com/usehun0625/","mailto:usehun0625@gmail.com"],"image":"beer.jpg"},"articleBody":"\nKinesis Data Stream에 샤드 제약조건(샤드당 쓰기 1000 레코드/초, 1MB/초)을 넘는 데이터가 유입되면 Datastream이 어떻게 동작하는지 확인한다.\n\n\nKinesis Data Stream(이하 Data Stream) 개발자 안내서에 나와 있는 제약조건은 다음과 같다.\n\n샤드 제약조건\n샤드당 쓰기 1000레코드/초, 1MB/초\n\n\nAPI 제약조건(생산자)\nPutRecords 호출\n호출당 데이터 레코드의 최대 개수 500개.\n레코드당 전송 가능한 용량은 최대 1MB.\n호출당 데이터 레코드 전체 용량은 최대 5MB.\n\n\n\n\n\n테스트 환경테스트 환경은 다음과 같다.\n\n테스트 리전: 서울 리전\n테스트 관련 서비스:\nAmazon Kinesis Data Stream \nAmazon Kinesis Data Firsehose\nAmazon Elasticsearch Service(이하 Amazon ES)\nAmazon S3\n\n\n\n테스트 환경 구성Data Stream 생성테스트용 Data Stream을 아래와 같은 설정으로 생성하였다.\n\nKinesis Stream name : kevin-datastream-test\nShard\n샤드 수 : 1\n쓰기 : 1 MB/초, 1000 레코드/초\n읽기 : 2 MB/초\n\n\n\nData Firehose 생성테스트용 Data Firehose을 아래와 같은 설정으로 생성하였다.\n\nDelivery Stream name : kevin-shard-per-limit\nSource \nKinesis stream :: kevin-datastream-test\n\n\nDestination\nAmazon Elastcisearch\nIndex : kevin_shard_per_limit\nType : _doc\nNo index rotation\n\n\nS3\nBackup S3 bucket : kevin-bucket-test\n\n\nDelivery Stream buffer conditions for Elasticsearch\nbuffer size : 1 MB\nbuffer interval : 60 seconds\n\n\n\n\n\n\nBuffer 관련 옵션 설정(buffer size : 1MB, buffer interval : 60 seconds)은 Destination(es, s3)에 전송되는 데이터 레코드를 빠르게 하기 위하여 설정하였으며, 상이하게 설정하여도 테스트에는 영향을 미치지 않는다.\n\nAmazon ES 도메인\n도메인 명: kevin-es-test\n버전 : Amazon Elasticsearch 6.7\n인스턴스 구성\n인스턴스 유형 : t2.small.elasticsearch(vCPU 1, Memory 2GiB)\n인스턴스 개수 : 2\n인스턴스별 일반 EBS(SSD) 10GB 각 1개\n테스트 인덱스 : kevin_datastream_limit_test\n\n\n\nPython 및 Boto3 환경 구성테스트의 편의를 위하여 python과 boto3 라이브러리를 사용하며, 다음과 같은 버전에서 테스트하였다.\n\nPython 버전 : 3.6\nboto3 버전 : 1.9.248\n\n다음과 같이 가상환경을 구설 및 활성화하여 boto3 라이브러리를 설치한다.\n12345$ mkdir datastream_shard_per_limit$ cd datastream_shard_per_limit$ virtualenv --python=python3.6 .venv/$ source .venv/bin/activate$ pip install boto3\n\n\n테스트에는 multiprocessing 모듈을 사용하며, 이는 Python 3.6에서는 내장 모듈이므로 별도의 설치가 필요하지 않다.\n\n\n테스트테스트는 다음과 같은 샤드당 제약조건 2가지 케이스에 대하여 테스트 한다.\n\n초당 1개 샤드에 전송되는 데이터 레코드가 1000개 초과시 동작확인\n초당 1개 샤드에 전송되는 데이터 레코드 크기가 1MB 초과시 동작확인\n\n테스트 과정중 “데이터 레코드 전송” 부분에서 멀티프로세스를 사용한다.이유는 다음과 같다.\n\n데이터 레코드 전송시 호출되는 함수의 제약조건을 위반하지 않기 위해서\n초당 1개 샤드에 전송되는 데이터 레코드가 1000개 초과시 동작확인- PutRecords 제약 조건( 호출당 최대 500개 데이터레코드 전송 가능)\n\n\n여러 대의 디바이스에서 데이터 레코드 전송하는 상황을 연출하기 위해서\n\n테스트는 다음과 같은 공통된 시나리오를 바탕으로 진행된다.\n\n데이터 제너레이터로 데이터 레코드를 생성하고 파일로 저장한다. (예시 : 100개의 데이터 레코드를 갖는 파일을 생성)\n데이터 레코드 전송 (파이썬 코드 main.py로 구현된 부분)\n데이터 레코드 파일을 읽어와 리스트에 저장한다.(예시: 파일에서 100개의 데이터 레코드를 읽어와 리스트에 저장한다.)\n3개의 프로세스를 실행한다. 각각의 프로세스는 다음과 같은 동작을 한다.\n“시작시간”이 되면 “지속시간” 동안 매초마다 리스트에 저장된 데이터 레코드를 Data stream에 전송한다.(예시: 2019-10-15T10:00:00+0900 시작하여 10초동안(2019-10-15T10:00:09+0900까지) 전송할 경우 총 1000개(100개 * 10초) 데이터 레코드를 전송함)\n매초마다 전송한 결과에 대하여 파일로 저장한다.( “전송한 시간, 전송 소요시간, 전송 성공한 데이터 레코드 개수, 전송 실패한 데이터 레코드 개수”를 저장)\n\n\n프로세스 별로 “전송 성공 데이터 레코드 개수의 합”과  “전송 실패 데이터 레코드 개수의 합”을 확인한다.\n\n\nDestination(es, s3) 저장 여부 확인\n\n다음과 같은 파이썬 코드를 사용하여 테스트 과정중 “데이터 레코드 전송”부분을 진행한다.\n\nmain.py\n\nmain.py 동작 확인main.py의 동작을 확인하기 위하여  다음과 같은 테스트 관련 정보를 확인한다.\n\n프로세스 개수 : 3개\n프로세스별 초당 전송되는 데이터 레코드 정보 (데이터 레코드 개수는 333개 이하이고 데이터 레코드 크기는 341KB 이하이여야 함)\n데이터 레코드 개수 : 100개\n데이터 레코드 크기 :  48KB\n\n\n\n12345$ ls -al datarecord_file.log-rw-r--r--  1 kevin  staff  47814 10 15 10:10 datarecord_file.log$ cat datarecord_file.log | wc -l     100\n\n다음은 샘플 파일 내용중 일부이다.\n12345... 중략 ...&#123;\"device_manufacturer\": \"Apple\", \"device_name\": \"I-Phone 8\", \"device_model\": \"A1905\", \"device_os\": \"iOS\", \"device_os_number\": \"11.0\", \"app_version\": \"v1.5.16(92)\", \"event\": \"post_detail_click\", \"interest_name\": \"대입/수능\", \"interest_id\": 150, \"interest_service_name\": \"취준일기\", \"interest_service_id\": \"1200\", \"interest_service_type\": \"함께해요\", \"user_id\": \"mqVz31F1qDTnKd0t\", \"device_id\": \"83NGRTpm6MCMU3F1uO6s\", \"create_at\": \"2019-07-25T09:38:23Z\", \"index\": 301&#125;&#123;\"device_manufacturer\": \"Samsung\", \"device_name\": \"Galaxy S10\", \"device_model\": \"SM-G973\", \"device_os\": \"Android\", \"device_os_number\": \"10.0\", \"app_version\": \"v1.5.16(92)\", \"event\": \"post_detail_click\", \"interest_name\": \"프로젝트\", \"interest_id\": 120, \"interest_service_name\": \"취준일기\", \"interest_service_id\": \"1200\", \"interest_service_type\": \"함께해요\", \"user_id\": \"eYaDqO2s1NG\", \"device_id\": \"lO07WKtnErZpsiBgDRmo\", \"create_at\": \"2019-07-27T19:29:03Z\", \"index\": 660&#125;&#123;\"device_manufacturer\": \"Samsung\", \"device_name\": \"Galaxy S8\", \"device_model\": \"SM-G950\", \"device_os\": \"Android\", \"device_os_number\": \"8.0\", \"app_version\": \"v1.5.15(90)\", \"event\": \"post_detail_click\", \"interest_name\": \"어학/회화\", \"interest_id\": 180, \"interest_service_name\": \"대나무숲\", \"interest_service_id\": \"1300\", \"interest_service_type\": \"물어봐요\", \"user_id\": \"1p0foQ0MbyzaFBbN2\", \"device_id\": \"Kn8rirFHqnyQ9GDzB\", \"create_at\": \"2019-07-26T10:12:11Z\", \"index\": 61&#125;\n\nmain.py를 실행하여 데이터 레코드를 전송한다.\n12$ python3 main.py[1571102092.0, 1571102093.0, 1571102094.0, 1571102095.0, 1571102096.0, 1571102097.0, 1571102098.0, 1571102099.0, 1571102100.0, 1571102101.0, 1571102102.0, 1571102103.0, 1571102104.0, 1571102105.0, 1571102106.0, 1571102107.0, 1571102108.0, 1571102109.0, 1571102110.0, 1571102111.0, 1571102112.0, 1571102113.0, 1571102114.0, 1571102115.0, 1571102116.0, 1571102117.0, 1571102118.0, 1571102119.0, 1571102120.0, 1571102121.0, 1571102122.0, 1571102123.0, 1571102124.0, 1571102125.0, 1571102126.0, 1571102127.0, 1571102128.0, 1571102129.0, 1571102130.0, 1571102131.0, 1571102132.0, 1571102133.0, 1571102134.0, 1571102135.0, 1571102136.0, 1571102137.0, 1571102138.0, 1571102139.0, 1571102140.0, 1571102141.0, 1571102142.0, 1571102143.0, 1571102144.0, 1571102145.0, 1571102146.0, 1571102147.0, 1571102148.0, 1571102149.0, 1571102150.0, 1571102151.0]\n\n3개 프로세스의 데이터 레코드 전송과 관련하여 정리하면 다음과 같다.\n\n매초마다 전송하는 데이터 레코드\n300개/초 (100개 * 3개 프로세스)\n143142바이트/초 ((47814 - 100)바이트 * 3개 프로세스, 줄바꿈 ‘\\n’ 100바이트는 제외하여 계산)\n\n\n60초동안 전송하는 데이터 레코드\n18000개 (300개 * 60초)\n약 8.19MB (8588520 바이트) ( 143142 바이트 * 60초 )\n\n\n\n각각 프로세스가 전송한 결과를 확인하면 다음과 같다.\n12345678910111213### 0번째 프로세스 로그$ cat response_result_0.logprocess id : 26635      1571102092.163 \t                0.063 \t   100 \t     0       1571102093.000 \t                0.035 \t   100 \t     0       1571102094.000 \t                0.037 \t   100 \t     0 ... 중략 ...      1571102149.000 \t                0.034 \t   100 \t     0       1571102150.000 \t                0.034 \t   100 \t     0       1571102151.000 \t                0.038 \t   100 \t     0 total_sucsess_count : 6000 \t total_fail_count : 0\n\n12345678910111213### 1번째 프로세스 로그$ cat response_result_1.logprocess id : 26636      1571102092.163 \t                0.066 \t   100 \t     0       1571102093.000 \t                0.032 \t   100 \t     0       1571102094.000 \t                0.037 \t   100 \t     0 ... 중략 ...      1571102149.000 \t                0.034 \t   100 \t     0       1571102150.000 \t                0.029 \t   100 \t     0       1571102151.000 \t                0.038 \t   100 \t     0 total_sucsess_count : 6000 \t total_fail_count : 0\n\n123456789101112### 2번째 프로세스 로그$ cat response_result_2.logprocess id : 26637      1571102092.163 \t                0.066 \t   100 \t     0       1571102093.000 \t                0.035 \t   100 \t     0       1571102094.000 \t                0.038 \t   100 \t     0 ... 중략 ...      1571102149.000 \t                0.034 \t   100 \t     0       1571102150.000 \t                0.034 \t   100 \t     0       1571102151.000 \t                0.043 \t   100 \t     0 total_sucsess_count : 6000 \t total_fail_count : 0\n\n총 18000개(100개 * 60초 * 3 프로세스)의 데이터 레코드를 전송 하였고 18000개 (6000 + 6000 + 6000개) 전부 전송 성공하였다는 응답을 확인했다.\nDestination(es, s3)에 데이터 레코드가 저장 되었는지 확인한다.es에는 18000개 Document가 생성되었다.\n12$ curl -XGET https://search-kevin-es-test-dtdgdko7cas7f6umwhssry2koq.ap-northeast-2.es.amazonaws.com/kevin_shard_per_limit/_count&#123;\"count\":18000,\"_shards\":&#123;\"total\":5,\"successful\":5,\"skipped\":0,\"failed\":0&#125;&#125;%\n\n1234567891011S3에 총 8.19MB 크기를 갖는 파일들이 생성되었다.$ aws s3 ls s3://kevin-bucket-test --recursive2019-10-15 10:15:00    1048745 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-14-52-971961f4-9e37-433c-a9e9-8795a2605a902019-10-15 10:15:08    1048745 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-14-59-b3795c35-6bfe-41ab-958c-547166ce29472019-10-15 10:15:14    1048771 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-15-06-798f1f2e-dfeb-488f-8903-2a09e4977a872019-10-15 10:15:22    1048816 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-15-13-774dd724-9f38-4b1d-81af-0ce6ec0e80532019-10-15 10:15:29    1048648 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-15-21-dfe55c59-e254-43c5-ae21-5fcc4c35fbdb2019-10-15 10:15:36    1048765 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-15-28-609faef0-ea7d-4a49-ab35-3cb5dd2577012019-10-15 10:15:44    1048856 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-15-35-0956c89c-1b8d-4f4e-8ad4-178d051bf2c52019-10-15 10:15:51    1048674 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-15-43-04ddbb29-4021-4a57-9415-9de8ef48c1f82019-10-15 10:16:52     198500 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-15-50-23c2b957-0c57-4092-9ec1-ad1acd6f1f78\n\nmain.py 동작 확인 결과는 다음과 같다.\n\n총 18000개의 데이터 레코드를 Data stream에 전송하였고 18000개 모두 전송 성공하였다는 응답을 받았다.\nDestination(es, S3)에는 데이터 레코드가 모두 저장된 것을 확인하였다.\nes - 18000개 Documents 생성 확인\nS3 - 생성된 파일들의 총 크기가 8588520 바이트임을 확인\n\n\n\n\n테스트 케이스 : 초당 1개 샤드에 전송되는 데이터 레코드가 1000개 초과시 동작확인초당 1000개 이상의 레코드를 전송하는 상황을 연출하기 위하여 다음과 같은 테스트 관련 정보를 확인한다.\n\n프로세스 개수 : 3개\n프로세스별 초당 전송하는 데이터 레코드 정보 (데이터 레코드 개수는 334개이상이고 데이터 레코드 크기는 341KB 이하여야 함)\n데이터 레코드 개수 : 500개 (PutRecords는 최대 500개 데이터 레코드 전송 가능하기 때문)\n데이터 레코드 크기 : 233KB\n\n\n\n123456### 샘플 파일의 크기, 데이터 레코드 개수$ ls -al datarecord_file.log-rw-r--r--  1 kevin  staff  238871 10 15 10:36 datarecord_file.log$ cat datarecord_file.log | wc -l     500\n\n다음은 샘플 파일 내용중 일부이다.\n12345... 중략 ...&#123;\"device_manufacturer\": \"LG\", \"device_name\": \"LG V50\", \"device_model\": \"LM-V500N\", \"device_os\": \"Android\", \"device_os_number\": \"9.0\", \"app_version\": \"v1.5.14(89)\", \"event\": \"post_detail_click\", \"interest_name\": \"취업\", \"interest_id\": 130, \"interest_service_name\": \"Q&amp;A\", \"interest_service_id\": \"1400\", \"interest_service_type\": \"물어봐요\", \"user_id\": \"kKWTbZRbC3K3v\", \"device_id\": \"5eHVWKKt99DMWknc1u8Q\", \"create_at\": \"2019-07-25T21:38:36Z\", \"index\": 181&#125;&#123;\"device_manufacturer\": \"Samsung\", \"device_name\": \"Galaxy S10\", \"device_model\": \"SM-G973\", \"device_os\": \"Android\", \"device_os_number\": \"10.0\", \"app_version\": \"v1.5.14(89)\", \"event\": \"post_like_click\", \"interest_name\": \"대입/수능\", \"interest_id\": 150, \"interest_service_name\": \"취준일기\", \"interest_service_id\": \"1200\", \"interest_service_type\": \"함께해요\", \"user_id\": \"WcyByhbOifWoh7ha\", \"device_id\": \"UoPGYYDHAItig2xbWX\", \"create_at\": \"2019-07-24T22:24:36Z\", \"index\": 214&#125;&#123;\"device_manufacturer\": \"LG\", \"device_name\": \"LG V50\", \"device_model\": \"LM-V500N\", \"device_os\": \"Android\", \"device_os_number\": \"9.0\", \"app_version\": \"v1.5.14(89)\", \"event\": \"post_like_click\", \"interest_name\": \"공무원/임용\", \"interest_id\": 160, \"interest_service_name\": \"대나무숲\", \"interest_service_id\": \"1300\", \"interest_service_type\": \"물어봐요\", \"user_id\": \"6K65FIDOkhegH8Yw\", \"device_id\": \"lvSZCt6YtdEjyC\", \"create_at\": \"2019-07-23T03:10:01Z\", \"index\": 395&#125;\n\nmain.py를 실행하여 데이터 레코드를 전송한다.\n12$ python3 main.py[1571103605.0, 1571103606.0, 1571103607.0, 1571103608.0, 1571103609.0, 1571103610.0, 1571103611.0, 1571103612.0, 1571103613.0, 1571103614.0, 1571103615.0, 1571103616.0, 1571103617.0, 1571103618.0, 1571103619.0, 1571103620.0, 1571103621.0, 1571103622.0, 1571103623.0, 1571103624.0, 1571103625.0, 1571103626.0, 1571103627.0, 1571103628.0, 1571103629.0, 1571103630.0, 1571103631.0, 1571103632.0, 1571103633.0, 1571103634.0, 1571103635.0, 1571103636.0, 1571103637.0, 1571103638.0, 1571103639.0, 1571103640.0, 1571103641.0, 1571103642.0, 1571103643.0, 1571103644.0, 1571103645.0, 1571103646.0, 1571103647.0, 1571103648.0, 1571103649.0, 1571103650.0, 1571103651.0, 1571103652.0, 1571103653.0, 1571103654.0, 1571103655.0, 1571103656.0, 1571103657.0, 1571103658.0, 1571103659.0, 1571103660.0, 1571103661.0, 1571103662.0, 1571103663.0, 1571103664.0]\n\n3개 프로세스의 데이터 레코드 전송과 관련하여 정리하면 다음과 같다.\n\n매초마다 전송하는 데이터 레코드\n1500개/초 전송 (500개 * 3 프로세스)\n715113 바이트/초 전송 ((238871 - 500)바이트 * 3개 프로세스, 줄바꿈 ‘\\n’ 500바이트는 제외하여 계산)  \n\n\n60초동안 전송하는 데이터 레코드\n90000개 데이터 레코드 (1500개 * 60초)\n40.9MB (42906780 바이트) (715113 바이트 * 60초)\n\n\n\n각각 프로세스가 전송한 결과를 확인하면 다음과 같다.\n123456789101112$ cat response_result_0.logprocess id : 26949      1571103605.000 \t                0.231 \t   500 \t     0       1571103606.000 \t                0.108 \t   500 \t     0       1571103607.000 \t                0.076 \t   125 \t   375 ... 중략 ...      1571103662.000 \t                0.202 \t   500 \t     0       1571103663.000 \t                0.392 \t    62 \t   438       1571103664.000 \t                0.424 \t   500 \t     0 total_sucsess_count : 20006 \t total_fail_count : 9994\n\n123456789101112$ cat response_result_1.logprocess id : 26950      1571103605.000 \t                0.204 \t   500 \t     0       1571103606.000 \t                0.108 \t   500 \t     0       1571103607.000 \t                0.786 \t   125 \t   375 ... 중략 ...            1571103662.000 \t                0.136 \t   500 \t     0       1571103663.000 \t                0.316 \t   125 \t   375       1571103664.000 \t                0.210 \t   500 \t     0 total_sucsess_count : 21077 \t total_fail_count : 8923\n\n123456789101112$ cat response_result_2.logprocess id : 26953      1571103605.000 \t                0.233 \t   500 \t     0       1571103606.000 \t                0.131 \t   500 \t     0       1571103607.000 \t                0.104 \t   125 \t   375 ... 중략 ... \t  1571103662.000 \t                0.246 \t   500 \t     0       1571103663.000 \t                0.294 \t     0 \t   500       1571103664.000 \t                0.505 \t   500 \t     0 total_sucsess_count : 20983 \t total_fail_count : 9017\n\n90000개 데이터 레코드 전송과 관련하여 전송 성공/실패한 결과를 정리하면 다음과 같다.\n\n전송 성공\n총 62066 개 (20006개 + 21077개 + 20983개)\n평균 1034.43개/초 (62066개 / 60초)\n\n\n전송 실패\n총 27934 개 (9994개 + 8923개 + 9017개)\n평균 465.57개 / 초 (27934개 / 60초)\n\n\n\nDestination(es, s3)에 데이터 레코드가 저장 되었는지 확인한다.es를 확인하면 62066개의 Document가 생성되었다.\n12$ curl -XGET https://search-kevin-es-test-dtdgdko7cas7f6umwhssry2koq.ap-northeast-2.es.amazonaws.com/kevin_shard_per_limit/_count&#123;\"count\":62066,\"_shards\":&#123;\"total\":5,\"successful\":5,\"skipped\":0,\"failed\":0&#125;&#125;%\n\nS3에 총 28.2MB 크기를 갖는 파일들이 생성되었다.\n12345678910$ aws s3 ls s3://kevin-bucket-test --recursive2019-10-15 10:40:07    1048719 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-40-05-46b29bc0-c90e-4336-8e41-e2e223a60f5b2019-10-15 10:40:09    1049011 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-40-06-6a791755-2ac9-46e3-b359-9e5afe18f3a42019-10-15 10:40:11    1048719 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-40-08-bbfa1e19-6c5b-467d-a755-191733f43353... 중략 ...2019-10-15 10:41:03    1048893 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-40-59-9ab2a36d-1ce1-47cd-b286-4cd04235b9dd2019-10-15 10:41:06    1048858 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-41-02-e8628263-fd0d-485c-ae08-e3078f7065bb2019-10-15 10:42:06     221154 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-41-04-8ca8c8da-4b3c-4821-8db5-68b1df9ee0e5\n\n\n“전송 성공한 데이터 레코드가 S3에 저장되었다”고 추정\n“S3에 저장된 파일들의 내용”과 “전송 성공한 데이터 레코드”를 일일이 대조한다면 “전송 성공한 데이터 레코드가 S3에 저장되었다”고 확정할 수 있다.하지만 많은 시간이 소요될 것이라 판단되어 “전송 성공한 데이터 레코드가 S3에 저장되었다” 추정하는 것으로 마무리 짓는다.\n전송 성공하였을 것이라 추정되는 데이터 레코드 크기는 28.2MB(약 29589469 바이트)이다.\n\n715113 바이트 * 60초 * (62066 개 / 90000개) =   42906780 * 0.689622222222222 = 약 29589469 바이트\n\nS3에 저장된 파일들의 크기의 합은 28.2MB (29588562 바이트)이다.\n따라서 전송 성공한 데이터 레코드가 S3에 저장되었다는 것을 추정할 수 있다.\n\n테스트 결과를 정리하면 다음과 같다.\n\n60초동안 초당 1500개의 데이터 레코드를 전송한 결과, 개발자 안내서에서 제시한 제약조건과 유사하다는 것을 알 수 있다.\n전송 성공은 1034.43개/초\n전송 실패는 465.57개/초\n\n\n전송 성공한 데이터 레코드 62066 개에 대하여 Amazon es는 저장되었고, S3에는 저장된 것으로 추정한다.\n\n\n테스트 케이스 : 초당 1개 샤드에 전송되는 데이터 레코드 크기가 1MB 초과시 동작확인초당 1MB이상 데이터 레코드를 전송하는 상황을 연출하기 위하여 다음과 같은 테스트 관련 정보를 확인한다.\n\n프로세스 개수 : 3개\n프로세스별 초당 전송하는 데이터 레코드(데이터 레코드 개수는 333개 이하이고 데이터 레코드 크기는 341KB 이상이여야 함)\n데이터 레코드 개수 : 100개\n데이터 레코드 크기 : 584KB\n\n\n\n123456### 샘플 파일의 크기, 데이터 레코드 개수$ ls -al datarecord_file.log-rw-r--r--  1 kevin  staff  583807 10 15 11:53 datarecord_file.log$ cat datarecord_file.log | wc -l     100\n\n다음은 샘플 파일 내용중 일부이다.\n12345... 중략 ...&#123;\"device_manufacturer\": \"Samsung\", \"device_name\": \"Galaxy S8\", \"device_model\": \"SM-G950\", \"device_os\": \"Android\", \"device_os_number\": \"8.0\", \"app_version\": \"v1.5.15(90)\", \"event\": \"post_detail_click\", \"interest_name\": \"공무원/임용\", \"interest_id\": 160, \"interest_service_name\": \"비밀자료\", \"interest_service_id\": \"1100\", \"interest_service_type\": \"비밀이에요\", \"user_id\": \"xx1m60ZHJj1K\", \"device_id\": \"6oZsdoQmuYYYmEJPC\", \"create_at\": \"2019-07-27T04:33:16Z\", \"index\": 384, \"additional_field_0\": \"WCfGJQ8aIopfHp NqhcJD9YHaJEXL99GJrTNfE wHZe3oVUGCuNzEW GdXoIdLWs UkPbHXkBk8TJ1BzqtejAzibTcToteHKphGE0GIgWcg0ZvDWTXEBrwL8Iftlb8MyWUpfrZk5CmHduuWsCGBbfoTM4ZlggEFmqy7aSq5DnT Bm3U7T29LA8xLMIiriaMtlVeksm0Dc7KZiSZSAkeBwJBTeHDzA3rJAzSNnyrZPGwaDyIjrWDVVwf8AQ1OcRkn1x7Zg64fqabT2GoGYir7FNwpbU9wbPKB Y6GbCsw8lNLB5Q531MnlAzhrXW Ja4JJUL1U97v5cQaCFJuWB56FYWinFi2INPDraXUGpStRZ9RF4haaznT81zoj6It2m Ipru xIylWMz4vFvwX2Gzo3ToKRRIMW 4Uc w7VVS6DmPvNdl59fgXw ELwTyd8mStwXAhj78MYk8mLaNqxJgmoCqcneN1CISEI 9vubPDdFyHyHCP5PrM9E0lscJmAyguhqm\", \"additional_field_1\": \"AZUGbTMML2cBnBAT4HDfYxS05qB9UFsoP4Y4hNg6b2QCQq6ToBS28sJCOHxGjljr05R4HGGjU3RQVcZeKOe8lOsxrPOIArhsGgYrJ6zLGd1sIhgB i1AWMYwU2WxonyvLp4nPYpUM3RAWIppqnDzVkvyo8Mzuci0d5jimJFskrLIHgF8zj WN4kxoyA4YRzA4Ej3T47k5cSPO5yCrS6oAnJVUmCiazvQgEv0l0JEPcZmRRHlwTYxGiGyYroJzXJ6ARAEMYX2kmjGDGyx8XNlMmhTzGD8cgWYyGRmR0K2VC8Au6UEtMJQSpXF2POxFe1z8ji8u2QS3kvZxxqOxMJMgo1IWrEfbNrJlt2B lMAsvJuSF3eDjVOldjETXOi7t7HmaoxA8gKgBVplpP73nHjECTWFTYtTHkSAqpCGpRPZ7G4sE5lYfu952puXLJLTb1Qsngc75er0uX3p3Q2 rzqWHiXa VnFfzd0rp311GcMPxqg YuuPCfY Kodyi9EbAfE8\", \"additional_field_2\": \"rrrudpuxgdJ9lKO4LWhiJxxPeFGbvp5DPMzrMbAIlvW2bTqndm3aw1Hxj iym7Jq4HSzJMIYn31wVRPHdDVWy9lylgDDO3Tjl4Z74NPYClCvo6F8uVYCGz2o2aWakId71bx2b8gnM493pBHx30Yq4msIeYvWBrMN6WtZ3t66zA1CA2NB3TOvoH7bjTCGDsFHJ9o 0bjBHhEy0PrmwU6Pq0vhb 4s0HWl wERtjHJez9FkDhx0sTmKRx5tOp4SujMmm 3jnPDYx9riwb9hYfdD8HM3c4P68Z9Tqg8B8fQcJdZwS0Sg6yd4VkSqHz1nt y2Z1uAH83ZuByYCvN5tyeFhPnAQs19FpTAHDcqEIE5W9KtkJWauHL 7gcobOWHxwefJRUIb25IpKyvZiDn88EuqUQ7zOQOiZA9zxY qn wBudHmcCTnJIOe4NSKRJttjWWZvi5nqyMNUCLqQkuHy1U9TaxqBQKV4wHomN4q9hM1UVCfm5myvH\", \"additional_field_3\": \"XLrY3vT49h4oqky3PjUREnHKcekg8KGsuNoYbEKxgcoUSfmojjCOMfxUmQTOfD9iLp5xK4SOw3SS9ra9BYQsLQMW4NKQEFkImWjU LaFKpoVnoX5U4swuUAfXBfjMxnARQzeCSr6ANGuRoA4v9pi5p77kUMPrOSjnVP3CAYpui6TZgmPNSyO9kPYByqu9sZSI pqfsaIsEUjBapbz9Fj0Z3kl6SVQOzR0 vtP0HGzjYSmVDtXkyHsdYBzxMdLByML EgLrKwPkj38vFBj6an4lfNEi2E3 yqkHP9ZowuzAFhk8mg7qsGIuiSh43dNBuAWBmntCkiYLKECjqH6efZhITx CebmrL4omumJ 2YI75aJDvKJKq7ow3HVZ0Gjicc4U9wbwAhJK70AxNMbAivZJ oonjlKHhPOWyw2v4FUFZ9gTppRA81RiJF08QkLkDPeuf gYWbgtmFWtzNAbDr22dzosSAxK3JQqUhp1713hshKyYPt1KiM5RU32cY5qqjD\", \"additional_field_4\": \"keZErkS42RNwM33MDLE3b8GEmSS2f8SWopEudOy54mf4jn99sXVY4EvPUK48gHNpOVsZP3RoI961GR3w6FMjhvfgk4rUv6Xt9OUClGHyxeZf8 1uQKKmHLrfQLuVG2oaCcAfDfuEvBm2ehkOLe7Aa8AKz GLylBqE27Dh6BKETFwJZRbFCd7w7jdayhMncJX9NsqcavyMJASD1kJ21nmhETfXuSOmfohImt tUMmIv4QkIFNFvW8IAD3t64xi8gV6joMmhYLHZ9N9DGO kjJXCFiuOpUl 8CyltqaIGvkJ3Mfi4B4tosssWsugRDt4OLxFQcw8fBnlndjRUHFlxAviAuIrkNcsJAkrYPSqmwgbvjyoaYnhZXuaASFfiTY6Uum2aOqRmnSekL9aztJjNgplApj2X0TGWVhvHN0WUsnONtFafnw4 lPn7OEsP2s9eYmhrfBmxl JfKRYYphY4YdsoMmp3R8s43DwgmzUpvrbd9eO86YPvHoS FARTuK7oBYcaEU\", \"additional_field_5\": \"RZ S4844uTxKDg6WwDFdr3ERAijtuXOeNkAvbH8PWAOP8 R434k38saZbojLmKDVHm4j8k1 GoblH74woP uqfUkRf3L 7FSd0FfTkxlSi6QOk HuM7LytqM91sh udeZ5zt66xyydjrQZ1TiI rXRhUQG6NyajLdm81qScAekjxq5Da6wvA7T6ODeIBRKz6XYM8s3rLvwD NeHOXTfqeJjxNSQBHlgPEDrXMaIenF x9nCDS8lHUtPAMPCIMc8uciv3iovtugufB sW16Ko3jBkzafiQZ6NxDG4AJnm3x tJYKmdu1y9P6seuNqNndlqssFj7ZWf6dHLDiuyM10a8p3oOj rdBorM229n4mk6oBPaRf3UJKzHidqJpxb7ZNzFR08iSau69ktrEJYZqMXU1v057cwT4HSsFZwY4mtRaLvv2 iKqnAuCx2S123vvBljhkPakW4E1CwcbqeOWcbQB3cPsQ3ERf2H8BLYKK6jdy01KBDyXZTnYXQ3\", \"additional_field_6\": \"CnJVAUvhd7K91IUuz9TmXXWn8zPIwrBIxKTkOd5dt2 D8 xvOLHmz7G6a1JEH6zb6BQPrzRcU3MMpPOooRlM6Geo5KFkwfqrURVrpDXx9ZiJqowzwVTqnXNylQB6V9Z22k9VFmCyMEUWRBh1z1ISxzy3OdvCDOg0b5MDBf1cTaqTLL6KhnEC6jtV31uRQEgW 5irCd1OI9z6wWiL8b2bfUblrdB0paaZG8nsBKoNwg8pWY4rsi1CBTTNvnQ3gZEKKKQRNm1mUo4vdba6RZZ2 vv9idmlJVNFSLfLxYTdfgm9d8szzYWQyavtGsvaZWgoiU3t23TGfZuuxZ2GLzSFaYT8SnEyvCABNsNCUqnehlVIFbmdE5 reA5NLT4qacpdoQPoDzz99EKlxtzHhm1eZMmNzIOqzgX1YlYTRJVKH1P4yCicAYAcIcLu9B6oADpR3dXDcmmeCFnuh0M M1lWP7nnjcIBucy4LWE2AnLVhTFaFfm3YRCobeMSCWIlXEssEj3FRaN\", \"additional_field_7\": \"8Cxmz7mEXFU8ChOOJdaBWTygw69spo4e6qa8aUb4wShfse7zousHT3WB8crVNXy9tZwhk1ZjuqQJHmTyf7PLXKt17xMz LFIQUemjlN8lyie796cqCAEJMvjmflhOT0vRyPExoz1BjfQaJ2hPZxVUqKZ8LIJGVtz5cbyRysg30faRvVreWuTQ4VZTUFQzS0LmMXgwqlTSbv8WtGLu1UPSf8UrpR1PH9TuLuAcklXnve3Df4r Th59W0Ue7a3a5EXD4DqTpuEnMcX9O5eXPBK8CVUZiXyIjp0r6XMJq8AEu9TQNzrtjBLygLGlWCaJMMYlHWpDdXJc9uy66p89rLPGSg58H8oGO7fE8pYBK2Hrl0wtgHkrmYKF1KpncrrmtAm9jn8AzkwSG3YjPdMaUwWd0KY8zR9sVpDThiM0mpeMDehz1xYxov VXFYVf0kaBxMryaztaatFvKZrviIMEfqgyM0NBmIygpuXAznxLWBVGspEmc7EAG7nhkqNOr KPZz xM\", \"additional_field_8\": \"SxL1exCRSgsDHmlZ8Dgx3oApGSM9XhjiEkRGntpQgEss3liNyu37JTMKYQVeC 33c6Q7F8A4d03RIr feAXYBkgJKmD08F8Fdu0kuQjlXHeTBDnMZ6VepE5qOdD2xDcxd2KMptkuuKuPyhF2xoO8OwbXq7wNs81 gUMWE87yWtPzashJqr5LPoO W8UBRqlu8eUtsqTnmssK7ZkLJV3dnBcu5taIBg7DX5Di1yYuNJ59sdcKP2i0emx9hAJpPYi78axjCXCc22yB7bFDfG9rf6gDbUexZ5DSMOmQaRorQZ2m3YfemHmunkFfGlBlrAQJxKhpuLYAIZfI0v2S46ueIsLqb5D1wSwOQWa72hRXBthWt5a1VbOYJXZirAHtbIf4v4X0jisgAnmJVUkgjXIrrF8jaJnrffEoqFthkE7bc0jjfJGbM53Grfqyp4v3hAkmiT1abe5UNCsDjx7DYWud32FF9lfmX0zkUmfheRn5WP6p6gWDbJUa\", \"additional_field_9\": \"zoFMEGUNZvnfynGGlsKPMKSKa45TyxKG9Owkx0fvCvHnxfd04pc314r8EmJ5C4DKqC91k0HRx7UON1eoh8tAh2PDvXUfqLrOkb0z8ZaoIozdsDIwcfwu03dciSJoVoIFDnUJByKv8yHfIeduc5kD17zjdvGLV0Xz7efUBaK2jLgUYNAmsnrCdfBezA6BRkkEe7g2RLpE2tuxK Z6NtPeqFs 9C1SgGUC WNGkRodKASQeQ9G7Ji8x3qxbr mt H2lzjwSAhZjsCrFzmc50FifgrrCx3iJJTJ8SAf5iyJKydeJceFjQLuH1ZIUXa0EeliiwnSFPA1YYeC2Ta2LiolFAqJW1Mugoe1s97 AHWljIeYutZ qc7xbmQgR4vV0Ff5StX lc848HUmvI1K9JPsuvHVncXdddFcaHnniSMlTPPG1qSl0hMQ1sQrZdH9GzrsrVvFlkym2XUNz3hK3n 8VFjwapK6YhVKjuzVH8iutWPEqlw3eTmVoZF1Pl\"&#125;&#123;\"device_manufacturer\": \"LG\", \"device_name\": \"LG G8\", \"device_model\": \"LM-G820N\", \"device_os\": \"Android\", \"device_os_number\": \"8.0\", \"app_version\": \"v1.5.14(89)\", \"event\": \"post_detail_click\", \"interest_name\": \"공무원/임용\", \"interest_id\": 160, \"interest_service_name\": \"비밀모임\", \"interest_service_id\": \"1150\", \"interest_service_type\": \"비밀이에요\", \"user_id\": \"TuUDG1v9flu\", \"device_id\": \"NxFJR5dJ4xJOdDU\", \"create_at\": \"2019-07-27T11:39:28Z\", \"index\": 261, \"additional_field_0\": \"2MOio5dvxglawIdQR2OrgXy5VSEgYNH2KntJ62PWLFNGD otCoYKEpVgAB0xPELf4tEN15Gbfw3N4deUbKAOfPNCQhvbiYqtvvtD778Afzxwyj FS oFqreWEfiRyQqGdID8ZBrlNPzcxNcXnY EgTvOW3 DcCprS2Y6O0BDiNeghOsldm2qP9EDsc2 BIAOJ1uhLejxNX4Ohd8zkoM82s e6Gcb3PhDIYIUsqS6n2Q v7FYfrhxea1eDXFVblgOM0syYQrhgPYkLEFZgdWhepmL7kROd7go1cHTShGNOinl7iy32 gtKJ3ggBWywCutRsZvFzxBwiqaq5n6osCeH1Re329Cr8ks5TBtCLhKULyhYOSjOlizHCGLHT2XXnVyaoOjdSqJWXeVlM3krq3iCBjimPlgF1ct0HQbzLF2uZYzxq1NONkPKUQexRZSnd4AnLyBu06PpzuDuGL7KwpT36vdAmq0FHgYdEjnSu9o6lrK 7Y TPfNxpLfU439Bn5if\", \"additional_field_1\": \"Yn2qBnmhaN4rwMQjLFiEqMG6FsNnJztUngX2IGnT41w5fFj8YQRZp1oqD72xzuQ7K1tdLvvm7nk9JgQlKHfB6xSNPYOk1S5IBSlbdmyabPPiM5SjkQmBqRo9xmjisM2Mr6tT5aIgaIiHaIFvCQ975QvpNgs pDtMWLIsFXN3r5IU5bUL8w8LvLzBAe6SAEsq4KMPFoid77 UzA7q7EMkuZNYufWhHv3n8DyDVbHz0jOflU sh9HN1B45LmQz2ZS0xvHv4gigIUhNUmljrdbBk2VET6krkv2KJ9Zuc7O5WzdgpA1hjqCCz6qFVsv0Ah0Q7BBcrw99QiAJeRhIRUDWR8tdWtKiBZXWEXg2LopSjRGviJX5CNE BB2LHs4HQu2wIj3sgjpJhdZNTL2nzBBIZ70dRczdQicCSi2QnKqA7WSlAlpNL3hUMcCGAwn9HaNLEXfYojYS64OgpwhVaGcbe6iwMjsVKJMgc0SHfFShuodhBW9da8ckImcxhgCUCIv9i2NH\", \"additional_field_2\": \"xOtqQJRp8P5unnMAWpbfDlY6Wa2BneiEE8SNE3V2mfcs7h1P JHQSjFtSudF0fdVz EPjIpFGk9RjzAwOV27fwRpDSQgt8TqZGyvQcQRFY8SiXONrXqqab3u4A7ud2pLhHJWwoFqbm0vnkxGUIjy8tCeBTB8 fgLNjK9Uzfdp6Kjllr sXDCrcqcSn1cQkqh1XQaksq IqojN8cqaGDhJCu7Ze Z1LZCmT3w009aUUp0hi0I00MZ5purhbnudKe7uLV77lZuNme6ABGtTIWkQJyy6IVIl3ddvhfWX4Lvrozj2E5HfS9myZWjgA20ojI2s1Dw8Nu7pU1gvxaEeDtHgvEgFTtXCv9MfAxNDfDipZhZIXsSLHlTXPBSeJP06zTpYDMeLDfVaeCYauJF7y9DCQ2rZ3VGIlngpY0iwsCyBy0SheecC35B3ZFPYsmRb4fy56NVl6uiygnqK4slXROhPeyRWjj0plyS7M  kgpl4D8bBi2FaphHoag3YvEdZK414eG\", \"additional_field_3\": \"YuBo3Teu1Glp6xkAVWiTlGMVaWsFO6YvalGI4G4ZUIPaWg2SSj6U1DhGfC9Jx9HKbJNK L9dShaZ7y70HMe7ETPa4nW98rWRzK1Ok3KwLLT5Jx0mRImHiA kEiBXKudp Zcj9jT158VcR8OQa6pwzXhIr p6RD2HYpnxVMljIV 1g4n 3QWYdspCEyKrz7Y1T16miEGEdl5Er gtx6EXlvRmux3vrzG0OwAz4f4Tv3a6b5zYSIXySYa v2Fq09w7f3XV5N 6wnTmQduEg j5 lxTxextW8aPpb0WEnyy5nNmTgzLLUuClg05vSdoVWZpYYHzI3M19gP6Ab6 EATfswPZDsIZ49TLWckWjvL0fdAQpzIaTu JssJFgb1bkkZdQAjWj0RJRpzSlh ukYF6SdQ4ZtZyoa9TX5Th36U0KBA0ouhzexdA4pskKGjrVsTupy2aTHqAym49Cxu6kmjU9UclDe866DcxF2SOo6Q3TWIOPNxLEhIU\", \"additional_field_4\": \"ymm21n2ooni 6M8kTnFuMLo6zZN5lwRRJjDFiMy5aVxYCGJx0 AJICNql akN5dv TFQ TUNqSZsOi01fiBjNTJgUMI25aeKxRZHtPTzJ4xYoiFX OWGyVxjgxXnoxq81DGLjvJBcjEGzpMyzdoC2qt3FigIcekpMYH9yJNM3PlEQkBTpN9EBzQIk9czb6RrI5bJGxNWzCMyA2Y9XGjtwRijNxASKQ7S5z38CW43nCh05p7BIwu24Azl9X38umv6305MXDEUILXKbHYfi8GGuJTOLw3hbPaXdj1V5QGPoLs0ByHEFc 1JpZztWGpwEBugLYE9zb9GAF6q W7Uty7UawGV5fv 2fLYxVRayWpkA5MhBKdDTBoyOYxGA75fjlVvFqCqj3vcujGx962U51 7ohYjaBrSaaXlAtxjhPG79Vgc60KJpLIskPnUs0I43ook94gOu0ybdJPtqLkXZ4Wj6qIfPx7jSN2WtrbEnT1UO9NofxQdcHUQ\", \"additional_field_5\": \"1z0Hs3s6JlDxg1bCLgYr0oCDmPuAUyZTr fH3Qc1fxvJHal9CpURIK5UTtJGefaXmwkstJkdnPu88E62GIpbkwprmMSLkyzafJpucysjTKvrxPvkFcdn9BixsZEnyf9oqCgjuYe8eEtsQfzkaoR7pvhSXYzYdqmnkLBuSaJvS0 hrn6pEAevR3idQxGAjKYoZ5ghB4wtnJhVx7ZEc6n8apEP4SdOJ7MSGcqQneIgKyxuItOQtHv0hUtDeKJKjS5JFm4yQrIRoTPxJZLdf6J4Xk0oQpEVPeB2XiEGLdwzfN6gmEUKQiXaJ H8xDCkM DHqZUUHtNHKOTJTPE8ODcen84EU9O6LiSe3X4yBhYcc0Jq1t4ysDgIaRnJK HtdKUVE04sqZ9By2iN1jusi2Lah29KTnr3Kcr0cCDjFawkde5odnqPaF1H3k2ahh8QnT2lC03MTuA7Fduu9CAQf1AV4Dhq776ju4ZTdgqQRSxfT0POiKKSP9Gko9zBMwO\", \"additional_field_6\": \"2D t60yPIJJMuss8LgV5Ulrx7f0MhN4m3GlWvdmNtOb1bFUhDLmXLetZlOJo vWVAklfi89BodveM2Eh9ShR8qeNqynEf6rAZHBx7mRQUVQPZF3XBGOGvDll1EmPXQbxKj8SEXCnXXgVdAHgIgp3bOPXLpIk9Wjo6SG1Kpx0LNxo9O6So5VdXEV4sJ7uK2fTQqRdrfhXM 93H6iam4t NdTf229clhktZrsQus Y4ywXwGeVvAW13MjyPa76OjXE8xuK6fKFodPdVl6Qf9JUVDu8M vzG5J6F adcuScA8l12UMmW4uu24g65cFKMW6FvkUXiTXM30yrl5M5fR8sOtxEopbNVRJfsP0rtbh5CtWd2aB2qQf7ZdW0RME6X01Bu Guj7ezwO4LQkPvTHnQLYwzOi19 8NCwoI6yVb9TFG8ZM2wohjVnO74GIn2F5iNgwPgZGqyhvT0NEFQUsXsAAaXjukp93AnjEwclBcl15RYqXw6ZfdaXu7OhozGya0Aqd\", \"additional_field_7\": \"e7 GcLte3TYTXTZT4BLvys A2NhifV4wcGsH2lIJ2Py7LwXyoIXSl6LhZrsNVFMiQaKjrVohhkmVmMBHsRvH9j9xSbp6IAMC7BXWFxZqwnxW4TkziPVhgpQuAPoCSpAwwKB6OpNkF7IeJfjAWkyBwO4FSpqA2DZqPmIe8 Yc6VzI85TTT0ipBBKKYdKyiFIcLbWrQZvkonTqJfOZj4vF8dlmJzprah9FglZailFeATuTtlkGFCVHiEHpkgNRwEq5urAzbzcrKqkYFE2ROzj4BB 24jnFxgtNNfGgvP2BAu35SbXXiISZJXIQVtOhUjwWs BDyaLymU5Ul89 M XWcE7r1JJhsyMuj369PThJNbTe09BMM TgDkvWib8q75tFeCpvGiLxGqAXumS Y20f4mzT1nxFw4FwL9Ps9dQrj93umnPVrF7vU7s6NT3riNGMaYw15T3s45liL0pCLJ3n2i31qw67hK7wnSXerXBjJuJa1NtUIQ128I3XHyNZMRJgvB\", \"additional_field_8\": \"lNeVyBMz7pJMihLvVvgFfSsXEP6uLG4ktF2Z42KFfPF57rAv4mTy28PzIn93Jv91oW0npkY6cLm2cZdvehp0lB6qTP8vMlZQmjD227jxOYMqu0 plCvvOwEmDOu3pxVxF1ymJLPvw9UOkVQ0Vbs3fdasqD07iu9w7VgaBCkNzFQ3VNkNZl54pj7bUwQAHTIL3pFhAMcM5JmOFPAqlXdDCUEkdLx1EfbPjqbed1IOOY 4osp3GAzhKa13IqLVghCmEZRm30ta  wGpqgD9fKBlaU4dQofEsWVoxhII VKsDky5NQQhN2rDC7ul3p9pUj Oj7elr6eity4McRwoCytU4eDnSe NtXJ5CgaApBDz9Sjgr84AK1rDH6J7CdKu8dMET VmHP9 aWgypvd6q621Z4NilXrUOcQOClTm439aYA kyNLUcAg7kEQQXAAgsyWdUPNpDCf2WzmbjgtN8Hz17YVsEefH Lpu4JKjYtbgepfGfehaQ41eP66Ak8Y\", \"additional_field_9\": \"Xa4HsXcx7OxE2RCpLHlyJx8UI9p4Bg9eIXMKHnBbGNpddzOgAFlyiXNQDRIcest A821fmq7ZDq9Y X3KbuP1ASlXhA7etnCT1xQcOIaQnEjArvBOnL2zLmV2FC5vK3O2lBvBSW1ku80 qArwrwRg62PiH2PB5tLgQCOcKWmxUy3ag3S6Pt C1YGJdK OvRfTF0xXjXkAJnepoFH7IRD7xCGyljQWgLvIPnR3 NwEQXZTArvGObNp8vxdYIy6Cf1GhNtSVdrWvHaBUkCSTRMEyNPP3wUmHdQloEVoWKONMLMnWa71vMpli eH6Tg4tRZ9lufkcF6SyPJJfWTwgdWgoCZQY1uSCoEoccFM9BZL5ayuXA1xYnrf7xuzl9XMnjX Km02jlHG57NISRSrSzDlTo2TGPEsYm0kuhw17E1hTw2ia7rLhHM7uXK4njvz7WKRfymGcZQ7qnMTQWD4eicCZxW1vvopGNLdw7xlJBW6k2DxEOSPDRp1YipuC1vb\"&#125;&#123;\"device_manufacturer\": \"LG\", \"device_name\": \"LG V50\", \"device_model\": \"LM-V500N\", \"device_os\": \"Android\", \"device_os_number\": \"9.0\", \"app_version\": \"v1.5.14(89)\", \"event\": \"post_like_click\", \"interest_name\": \"공인중개사\", \"interest_id\": 170, \"interest_service_name\": \"Q&amp;A\", \"interest_service_id\": \"1400\", \"interest_service_type\": \"물어봐요\", \"user_id\": \"AJRPcuKdCXTFfArv\", \"device_id\": \"Y0LVSMlL3kr3cPfvR\", \"create_at\": \"2019-07-27T12:05:28Z\", \"index\": 913, \"additional_field_0\": \"brLmDNsfTDNRw qSDnAIeipTpyjxPfhMpacsRONh98Ul44r7Kc3nxst7mhGMU Sq8hb4v4N06mGY16HJwJLESz47LrjIKb39Zt9eLfOwSzDh0ANBgM6pEftdBzjHvRJBQyNsIBIUrg9EnzQWQl2JRsSQHW6KGQb74KFLTagL7uzqKRjjluAWbWU6DnAgvxoUxfQ1sqxQPYP PTTksCsJ5vqwO ufaGVdfhI09pkqJmA0tcD GCLw7NqjSOsSYdJXTCtQXg42Gjo2C5H93FycBg3f3XqhFFpsfFhFIKDIF5RUJ3mB62w6 N3SqcJOAhG5qjDMtKq0htWTgSDbKDIE6MdzgxhB49ESrVBb9OuImKsEi9OLyEmOTgbUMeebIBGVyk854bv347u1 9U QTFpmq2hOfhF5jFw1DI1wgrEYuk6 nAmqvM0vXKOJ33pvqcrzmkeUgwxwTZ6mpkd3ABkeMGFzQFpM GWD4dTRER92j4EUN SxNdSfOH\", \"additional_field_1\": \"e2 QDdRCR6Gzu vMEWuwhAz7C3575YMcpHbgLn8pI5kN8802eKpsl3kJlHPhXbGt7umGyi8NTyl4dSjCqWBz9HGefG1SjRfjm3sfZzHVxLcxqckpU8OaipDTvOvRHu8hHA5K3a EfLxNPyTCz5zgYu5MeDKRTkJtF5xnJUxpJc3NqD5O8N4kFlBKoBw5eDDGYEbKq6SvlVlGhzguXQ0LAtGbnBpRqIwVxa9vEH7x f2LMJsgJHG3x0f3J2Ab8MS4g66AOciXkvzKP YASTEyT1LfMWsJwbEHLPzBmRYvVVKO0Rk1A3HD78TGI9Suyq9scw8Oc8BnGdcT6nllpSeYSKXDnqkFL2myHxE3zRFp9F6gR4JjJelSe339eRhKguA6BVN4TXRoyiUlIQe7zr0MLG4lT8AclGdJMt0Fgx9ZZPbcF2osl6JNkXkMERfZxwwOJyEUw4GF7vwi7TPJAWOQhVf1bgoIk05jH4fy31n0WFRjbwpssYsidRi60WWGMz0OLB \", \"additional_field_2\": \"cNKz Kq3NmIstx47T11pw6KjSfsRnnhXsHVY5RBxbk317DtoPzifwNGKHLPb0wylvmoDpaJYpRvv5uY02k429wj8jnJzfFQvDtulI0fNSJjc7VmLr9sxI2O8UwC2h0R4hp1DwRBn7GnY 07ridS5W5j0HNGAOzQpOzr WBmC5bqYTgAuFXQOh2hU2jhFp1eLZRGR0aeR715WYCeVb9jwlpev5OVPW3qmCDRgoXEuKmdWWYVwKQOL5RHfikj27Y77rSxXz6UJJ0nD3TrEClQaIRKk2UMbFHmzGmmh2CK62CxOVkMkcPcq7KWz XuKTAGPwV4hquBUCohLPpijyPtqNcQhyzGLtY55V5vrTMXoO8yVH8VoI2jmjmV6n3H5GJhUBg88PGfM0ggov5CdrvSZjPoKSScNkBVd6xPWh6gOwnTeD2AUEj0qS8IoAibJJMMG8kVNThpJn8Nj4esr8zMCRfiiAK79V0DVAYiPNQmJU0aIgtUNN4tvstRmYZWptdTDFs1\", \"additional_field_3\": \"oVapFNfWa1vxi1qx1aQeDEBTs FTSd0uXX8HuUYTWR1mK9L2sZwfYAxOR6fDZUgu7dfPTGfXmlgIFub2fKb6ltf9mikJgOLI3PbhPJOJWfxL7pRik5RJkubPJ03O21L5jz hyXrz1vx7AbkkXrKm Mo3Wcq86p0O0oDFS98qVkEaFjNNwHx2WcHpzAy8VMe86IiXvrY2UDau8LbpbEB2LDbNRCkPbaHgFtbKrSckdLbnonvOZ2qetWMTvXukF7xysvVcLVGvxIJbPVF1YN5fkMu4Jb0xtRw9BJjcALvvwZNj07aryHb1onSYupAiF2xF6whMmYYvldJj3aMLyJC8OvcwwRjOU1OMjbIjpAes Lo1lTsPxPQaQmlWpbPlMUuIYwDylXdJYjPr86fLSOW71UvjZIaLGUnQk9B8mkC3uOUmgYv7XTQhE6FX5g403SRfz4OTZfcwYPGF3A9KcNKbAp8C4svzil10YxOjaLj4F3Ohy39XNyKLP6TxVwgUC7\", \"additional_field_4\": \"9SvbTiU1w79vSlj4n4zWbUWVTy0jv7avO6Foxz7XppJzpdG2NqxK7 0BZs56Ak3OsQY68pzFxo5BDWmVi9KZqL28QgGNb3uESF3MUEFOhiij9QUPEH4WzBWZA6 nd9BAtgTZuGjbgEz0pc6 yjRmjliHh4sDopJQwJ9PGp3biiNvmq0tuwhoRq5HwZacO1OLjXMpT7LZiQyRSY9eV4KeNq1xPH283Uixu23EGZ7lywM5EKGhxvh48wcL0PvZOiw83MuaGXp2uC4vkHtCYa MqVcQFrCkGV3DHomVLI7LD0zA2JMxdOSaCARvJXYwWqaWkEofXx3gChmxljbJ3TJv jF82m9EMgvFKv8ZUXkC4zUWcw2FFc5Mv9VI11aq CijWAQQlHvS7QjNmsMFj QpXNm8xwRE rnzZqjgHIwia4OaXgU9yh1pJh1wgJ6YhSEF5SZ81Zacj9nPa eCKGXBkYsBDauN7 NS3ugkJfNtysXeuITSfDrz3ud3529T\", \"additional_field_5\": \"NLp3l5e25iSBwHThwtPImxHC6OEnSPsddR7tiAYIgdU9xX87jwQEcZazDVeuI8l0RwGoTJ6Ee9oJx9ZtJIB5sNMsrWPb3NaeS2lqpEXskWwl9q6ePVyP2bxe5xe3mcM4ndr7O8wqVdHlergZeLuFNDd1MRcFwq08PYvjFf9Y8gIsTjgF8ZQTcWO9u4QwlnmIRGbxav6Cv5jFhxJ9KA6wx sFRayN6ljARzWQuYQCpua1V9C6NuwOIu88JuXt5OSGwMmI5b9Km 0OPmnEq1uyPu2ACsxQrjPpR7gyyU5f K zKWCv8wzP7t5aRJg27vN3Qv81MugBa0EFM0vJ6PcvFUb57aIgzahy49V3Xk7cNa6FMHHEjOcpsySZriiUVonDHCVmYCcYWM41mAbOt344Xrhbmu2nL7YY3xCMCUEoXursFZh3gsdiILvSETZRRfK6n07a03scau 5Vw0thyhQmXbSkHlYEwTWB6HvdT8EdhE1AyhcbHAx3dde4coOCwZgP\", \"additional_field_6\": \"1SOS74N rcJ7ZHy1t6Nbp9LmKWm6FRscGy07LYuM5xBnVwsuZYAypuMEvCjG7nOhzAmz e61pxUFIoejcb1h7nu8DertzzknvlP3nrBr1fu3j0EFOBxdTYwNd2 seRdkgMuAgFhyHN9ys52G4T3EID1zMG8MNcFxc2iKguyJwwBQQPysI rzeSevK4fUFILODNj7a9PgTsx5ByCbR5mcqu4XreiDKOlXjcUe7ghseANxSuSEMZyCB6rlHx2XMyknEnSGQX2j9h6JHJXwifcwX424oL5lUN1PwtY sIQd1XQhExTvUEif7PLpnBTt3RiXqOoonqN40I05OnfXQcOpjUac2CSUK9qEwhH6TVT022UejT6xopYdb8PzaWjW zsozhRCFjfOa4H9DSMcmzHeQM N qANizOrxnbi9UARar0HQEjufmAeuHqfSvKCQfZQijjVD3sUANjy66mTr3opLkOU1pML82bZmeeJQOpBFHJT6sp kX512OFIjWTFDZUX\", \"additional_field_7\": \"FQZ4Azv3XjGy iVL2MN8ILX3DSZvCoozkJQvb tpiUHXYmLbf8fjou0FeVkfr6uSLwdnrNMVUwSMNPgwidBK7mpzFSYldlK813flgOfR341PI28EvKAMeNHWoqbZyfoH2BsCpKNSufFaEohsfrnOXwsYOcTNouizfKWCyxz8eeuSQCB4UnwNCK mUYJxR0ifGfxrzun5ywWvzVHuuMy6gEm112fAROpFmHBOuoLWIkrM99fXNdRx2TSNeFgJ8TvirZtpv2rfIS9rpnbX3Tl7H ASERfUgOkhN4tkz3fepM2bJp0JOQpc8BAaVERt9pZgDfwrlKn3NtsYW5QFxWCpMPFnoBLpql9e61Pkl8hplvFvMUCPL3CVfTUZTRIK3l1v7f5SERIU1HR5fGhewqQStdf4eTI5djTfRf6lhFwpno97ejSBTpnVpa2dxmgvVkFaOqyNaTPSR7XHGa8rl TvwLfkpwFu6LCKlH7Cacy81xKJKsRSSfRVVTZOkKmt\", \"additional_field_8\": \"zAnFflDq mwKlR01r7N3J2DnwKiKYXwQlu0TJiuuZAqS hD5Zv4P5gOveNPkMGTIBdiqjvLhw sPz8Oa2FcDWucIYYsI410VXWEyVSlGUzPiFZ047Eh M2UKSvtBfM0EUHScU7At8 9jWZzsbiUzIh7gxHq4SAB8FGZZZsNqkJbKAulomuaNuMQcJSpf4IDdddjOEcMFvcu9RpnjwvSaSBiKz9JqTs2RI4rRlu9nJzahuXRJSmlnu1FzH4V4B7j9NGE6Ov8mKYKagisGr9j9 1DxyrrE7SKry1 OjBiIV8vqxafQuFJn19iQYxPxgfRXYRfVbURUCJcKrjxyUwAl1JKAU3 45l2shYg62r82HgHh 3KhU7XQLNSRMT6Ad2XC5rQzaksqr0sXdnm5akvwhBJxptZSdO1iomsmdWLOXIoNjx0LyYqTeyRtcI otvaLYgEbOGdZ09B01fINWSDAR7Kciesu0CmvZWKK6dRq7JcclR1iDfAZR9Fi\", \"additional_field_9\": \"JWt0Up3iWSNRGSoGbKeS9pM4oeKvEtP5xCC7 XcY8wLcYjpffL5OXA32Qxk3Zn0tdKFeK3mc5FdqwDRzgfN5T1H z8cXJ4Jnif6rxylghVVZl8n5UKTCFo2IwzjSpIcRXsKO4OxG7zCRe9okbShqgaCK27s5OtYPGjYtyXpFE7VWaZQlXM3YmNVnSr99gMAPPbIfhH6JIGwebky0nhctJZ38No6DQaqwhELbbC61GfOuc0ghxl1VTig4AqaulouGID8d1e SXgtVxQjlHXXWeHQql5hypJpbnqXM3AbL0aCF6beio1tXfcc7xBxptjJnfPfqff1GQpXUmpRf5tQhJ5qcVH eH6zbTQ89xPHKKX82mEmknkb3td669tfTiLiRDBa4aGMEcYoM1M9bnHa8o8fXSvBxZa8QXzG7IZwk9xVLQrQ2kpvRIKnqc2KyxfcKV2EWqmvs3qbAWrJ48235bV302cCDw7FY6dno44abeZ3gM62XuhzRp\"&#125;\n\nmain.py를 실행하여 데이터 레코드를 전송한다.\n12$ python3 main.py[1571108232.0, 1571108233.0, 1571108234.0, 1571108235.0, 1571108236.0, 1571108237.0, 1571108238.0, 1571108239.0, 1571108240.0, 1571108241.0, 1571108242.0, 1571108243.0, 1571108244.0, 1571108245.0, 1571108246.0, 1571108247.0, 1571108248.0, 1571108249.0, 1571108250.0, 1571108251.0, 1571108252.0, 1571108253.0, 1571108254.0, 1571108255.0, 1571108256.0, 1571108257.0, 1571108258.0, 1571108259.0, 1571108260.0, 1571108261.0, 1571108262.0, 1571108263.0, 1571108264.0, 1571108265.0, 1571108266.0, 1571108267.0, 1571108268.0, 1571108269.0, 1571108270.0, 1571108271.0, 1571108272.0, 1571108273.0, 1571108274.0, 1571108275.0, 1571108276.0, 1571108277.0, 1571108278.0, 1571108279.0, 1571108280.0, 1571108281.0, 1571108282.0, 1571108283.0, 1571108284.0, 1571108285.0, 1571108286.0, 1571108287.0, 1571108288.0, 1571108289.0, 1571108290.0, 1571108291.0]\n\n3개 프로세스의 데이터 레코드 전송과 관련하여 정리하면 다음과 같다.\n\n매초마다 전송하는 데이터 레코드\n300개/초 전송 (100개 * 3개 프로세스)\n1751121 바이트/초 전송 ((583807 - 100) 바이트 * 3개 프로세스, 줄바꿈 ‘\\n’ 100바이트는 제외하여 계산)\n\n\n60초동안 전송하는 데이터 레코드와 관련하여 정리하면 다음과 같다.\n18000개 데이터 레코드 (300개 * 60초)\n105067260 바이트 (1751121바이트 * 60초)\n\n\n\n각각 프로세스가 전송한 결과를 확인하면 다음과 같다.\n1234567891011121314$ cat response_result_0.logprocess id : 27681      1571108232.000 \t                0.341 \t   100 \t     0       1571108233.000 \t                0.148 \t   100 \t     0       1571108234.000 \t                0.135 \t   100 \t     0       1571108235.000 \t                0.162 \t    50 \t    50 ... 중략 ...      1571108288.000 \t                0.478 \t   100 \t     0       1571108289.000 \t                0.342 \t    25 \t    75       1571108290.000 \t                0.356 \t    50 \t    50       1571108291.000 \t                0.215 \t   100 \t     0 total_sucsess_count : 4575 \t total_fail_count : 1425\n\n1234567891011121314$ cat response_result_1.logprocess id : 27682      1571108232.000 \t                2.271 \t    50 \t    50       1571108234.271 \t                0.187 \t    50 \t    50       1571108234.458 \t                0.091 \t    25 \t    75       1571108235.000 \t                0.118 \t     0 \t   100 ... 중략 ...      1571108288.000 \t                0.393 \t   100 \t     0       1571108289.000 \t                0.117 \t     0 \t   100       1571108290.000 \t                0.083 \t     6 \t    94       1571108291.000 \t                0.116 \t    50 \t    50 total_sucsess_count : 1666 \t total_fail_count : 4334\n\n1234567891011121314$ cat response_result_2.logprocess id : 27685      1571108232.000 \t                0.463 \t   100 \t     0       1571108233.000 \t                0.082 \t   100 \t     0       1571108234.000 \t                0.159 \t   100 \t     0       1571108235.000 \t                0.137 \t   100 \t     0 ... 중략 ...      1571108288.000 \t                0.156 \t   100 \t     0       1571108289.000 \t                0.211 \t   100 \t     0       1571108290.000 \t                0.178 \t    50 \t    50       1571108291.000 \t                0.193 \t   100 \t     0 total_sucsess_count : 4578 \t total_fail_count : 1422\n\n18000개 데이터 레코드 전송과 관련하여 전송 성공/실패한 결과를 정리하면 다음과 같다.\n데이터 레코드 전송, 실패\n\n전송 성공\n총 10819 개 (4575 + 1666 + 4578)\n평균 180.3167개 / 초,\n(추정치) 평균 약 1.0MB/초 (1052521 바이트/초)\n\n\n전송 실패\n총 7181 개 (1425 + 4334 + 1422)\n평균 119.683개 / 초\n(추정치) 평균 약 0.6MB/초 (698598 바이트/초)\n\n\n\nDestination(es, s3)에 데이터 레코드가 저장 되었는지 확인한다.es에는 10819개의 Document가 생성되었다.\n12$ curl -XGET https://search-kevin-es-test-dtdgdko7cas7f6umwhssry2koq.ap-northeast-2.es.amazonaws.com/kevin_shard_per_limit/_count&#123;\"count\":10819,\"_shards\":&#123;\"total\":5,\"successful\":5,\"skipped\":0,\"failed\":0&#125;&#125;%\n\nS3에 총 60.2MB 크기를 갖는 파일들이 생성되었다.\n12345678910$ aws s3 ls s3://kevin-bucket-test --recursive2019-10-15 11:57:13    1050614 2019/10/15/02/kevin-shard-per-limit-1-2019-10-15-02-57-12-1e0b3f2f-ad22-4f26-9d0c-5741f96178da2019-10-15 11:57:14    1050797 2019/10/15/02/kevin-shard-per-limit-1-2019-10-15-02-57-12-9139e196-5b5b-4ed0-9b69-d92d9fc3ad082019-10-15 11:57:15    1050691 2019/10/15/02/kevin-shard-per-limit-1-2019-10-15-02-57-13-f0395a0b-5c64-4678-9584-6708ddda5987... 중략 ...2019-10-15 11:58:12    1050966 2019/10/15/02/kevin-shard-per-limit-1-2019-10-15-02-58-09-4e6995a7-be7d-42ba-9bc3-fa554280f01e2019-10-15 11:58:13    1050674 2019/10/15/02/kevin-shard-per-limit-1-2019-10-15-02-58-11-9766d09a-25d4-4dc7-8c69-7d8a5db52d732019-10-15 11:59:14     110940 2019/10/15/02/kevin-shard-per-limit-1-2019-10-15-02-58-11-c8ed5eb6-3a00-4d25-b2b8-49930407983b\n\n“전송 성공한 데이터 레코드가 S3에 저장되었다”고 추정\ns3 버킷에는 60.2MB(63156884바이트)가 저장 된 것을 알 수 있다.“S3에 저장된 파일들의 내용”과 “전송 성공한 데이터 레코드”를 일일이 대조한다면 “전송 성공한 데이터 레코드가 S3에 저장되었다”고 확정할 수 있다.하지만 많은 시간이 소요될 것이라 판단되어 “전송 성공한 데이터 레코드가 S3에 저장되었다” 추정하는 것으로 마무리 짓는다.\n전송 성공하였을 것이라 추정되는 데이터 레코드 크기는 약 60.2MB (약 63151260 바이트)이다.\n\n1751121 바이트 * 60초 * (10819개 / 18000개) =   105067260 * 0.601055555555556 = 약 63151260 바이트\n\nS3에 저장된 파일들의 크기의 합은 60.2MB (63156884 바이트) 이다.\n따라서 전송 성공한 데이터 레코드는 S3에 저장되었다는 것으로 추정할 수 있다.\n\n테스트 결과를 정리하면 다음과 같다.\n\n60초동안 초당 1.6MB의 데이터 레코드를 전송한 결과,  개발자 안내서에서 제시한 제약조건과 유사하다는 것을 알 수 있다.\n전송 성공은 1.0MB/초\n전송 실패는 0.6MB/초\n\n\n전송 성공한 데이터 레코드 10819개는 Amazon es는 저장되었고, S3에는 저장된 것으로 추정한다.\n\n\n테스트 결과테스트 결과를 정리하면 다음과 같다.\n\n\n샤드 제약조건(샤드당 쓰기 1000레코드/초, 1MB/초)과 유사한 데이터 레코드는 Data steam에 전송되고 나머지 데이터 레코드는 저장되지 않는다.\n\n전송 성공한 데이터 레코드에 대하여 Amazon es에 저장되는 것을 확인하였고, S3에는 저장되는 것으로 추정된다.\n\n\n따라서 Data stream의 샤드 개수를 고려하여 샤드 1개당 1MB/초 미만, 1000개/초 미만이 되는 데이터 레코드를 전송하는 것을 권장한다.\n\n","dateCreated":"2019-10-16T14:17:16+09:00","dateModified":"2020-04-04T15:14:30+09:00","datePublished":"2019-10-16T14:17:16+09:00","description":"\nKinesis Data Stream에 샤드 제약조건(샤드당 쓰기 1000 레코드/초, 1MB/초)을 넘는 데이터가 유입되면 Datastream이 어떻게 동작하는지 확인한다.","headline":"Kinesis Data Stream - 샤드당 제약 조건 확인","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"http://usehun0625.github.io/2019/10/16/Kinesis-Data-Stream-%EC%83%A4%EB%93%9C%EB%8B%B9-%EC%A0%9C%EC%95%BD-%EC%A1%B0%EA%B1%B4-%ED%99%95%EC%9D%B8/"},"publisher":{"@type":"Organization","name":"Kevin","sameAs":["https://github.com/usehun0625/","mailto:usehun0625@gmail.com"],"image":"beer.jpg","logo":{"@type":"ImageObject","url":"beer.jpg"}},"url":"http://usehun0625.github.io/2019/10/16/Kinesis-Data-Stream-%EC%83%A4%EB%93%9C%EB%8B%B9-%EC%A0%9C%EC%95%BD-%EC%A1%B0%EA%B1%B4-%ED%99%95%EC%9D%B8/","keywords":"Kinesis Data Stream"}</script>
    <meta name="description" content="Kinesis Data Stream에 샤드 제약조건(샤드당 쓰기 1000 레코드&#x2F;초, 1MB&#x2F;초)을 넘는 데이터가 유입되면 Datastream이 어떻게 동작하는지 확인한다.">
<meta property="og:type" content="blog">
<meta property="og:title" content="Kinesis Data Stream - 샤드당 제약 조건 확인">
<meta property="og:url" content="http://usehun0625.github.io/2019/10/16/Kinesis-Data-Stream-%EC%83%A4%EB%93%9C%EB%8B%B9-%EC%A0%9C%EC%95%BD-%EC%A1%B0%EA%B1%B4-%ED%99%95%EC%9D%B8/index.html">
<meta property="og:site_name" content="Kevin의 블로그">
<meta property="og:description" content="Kinesis Data Stream에 샤드 제약조건(샤드당 쓰기 1000 레코드&#x2F;초, 1MB&#x2F;초)을 넘는 데이터가 유입되면 Datastream이 어떻게 동작하는지 확인한다.">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2019-10-16T05:17:16.000Z">
<meta property="article:modified_time" content="2020-04-04T06:14:30.977Z">
<meta property="article:author" content="Kevin">
<meta property="article:tag" content="Kinesis Data Stream">
<meta name="twitter:card" content="summary">
    
    
        
    
    
        <meta property="og:image" content="http://usehun0625.github.io/assets/images/beer.jpg"/>
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/all.css">

    
<link rel="stylesheet" href="/assets/css/jquery.fancybox.css">

    
<link rel="stylesheet" href="/assets/css/thumbs.css">

    
<link rel="stylesheet" href="/assets/css/tranquilpeak.css">

    <!--STYLES END-->
    

    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            Kevin의 블로그
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
            <img class="header-picture" src="/assets/images/beer.jpg" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="Read more about the author"
                >
                    <img class="sidebar-profile-picture" src="/assets/images/beer.jpg" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">Kevin</h4>
                
                    <h5 class="sidebar-profile-bio"><p>Kevin, 이용훈<br>어릴 때부터 코딩에 흥미를 가지고 살아왔습니다. 새로운 기술도 열정적으로 받아들이며 더 좋은 개발을 위하여 학습하고 경험하고 노력하고 있습니다.</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/"
                            title="홈"
                        >
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">홈</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                            title="카테고리"
                        >
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">카테고리</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                            title="태그"
                        >
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">태그</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link open-algolia-search"
                             href="/all-archives"
                            
                            title="아카이브"
                        >
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">아카이브</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/usehun0625/" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="mailto:usehun0625@gmail.com" target="_blank" rel="noopener" title="Mail">
                    
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="5"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            Kinesis Data Stream - 샤드당 제약 조건 확인
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2019-10-16T14:17:16+09:00">
	
		    Oct 16, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%88%98%EC%A7%91/">데이터 수집</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <h1 id="table-of-contents">Table of Contents</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#테스트-환경"><span class="toc-text">테스트 환경</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#테스트-환경-구성"><span class="toc-text">테스트 환경 구성</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Data-Stream-생성"><span class="toc-text">Data Stream 생성</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Data-Firehose-생성"><span class="toc-text">Data Firehose 생성</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Amazon-ES-도메인"><span class="toc-text">Amazon ES 도메인</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Python-및-Boto3-환경-구성"><span class="toc-text">Python 및 Boto3 환경 구성</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#테스트"><span class="toc-text">테스트</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#main-py-동작-확인"><span class="toc-text">main.py 동작 확인</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#테스트-케이스-초당-1개-샤드에-전송되는-데이터-레코드가-1000개-초과시-동작확인"><span class="toc-text">테스트 케이스 : 초당 1개 샤드에 전송되는 데이터 레코드가 1000개 초과시 동작확인</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#테스트-케이스-초당-1개-샤드에-전송되는-데이터-레코드-크기가-1MB-초과시-동작확인"><span class="toc-text">테스트 케이스 : 초당 1개 샤드에 전송되는 데이터 레코드 크기가 1MB 초과시 동작확인</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#테스트-결과"><span class="toc-text">테스트 결과</span></a></li></ol>
<p>Kinesis Data Stream에 샤드 제약조건(샤드당 쓰기 1000 레코드/초, 1MB/초)을 넘는 데이터가 유입되면 Datastream이 어떻게 동작하는지 확인한다.</p>
<a id="more"></a>

<p>Kinesis Data Stream(이하 Data Stream) 개발자 안내서에 나와 있는 제약조건은 다음과 같다.</p>
<ul>
<li>샤드 제약조건<ul>
<li>샤드당 쓰기 1000레코드/초, 1MB/초</li>
</ul>
</li>
<li>API 제약조건(생산자)<ul>
<li>PutRecords 호출<ul>
<li>호출당 데이터 레코드의 최대 개수 500개.</li>
<li>레코드당 전송 가능한 용량은 최대 1MB.</li>
<li>호출당 데이터 레코드 전체 용량은 최대 5MB.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="테스트-환경"><a href="#테스트-환경" class="headerlink" title="테스트 환경"></a>테스트 환경</h1><p>테스트 환경은 다음과 같다.</p>
<ul>
<li>테스트 리전: 서울 리전</li>
<li>테스트 관련 서비스:<ul>
<li>Amazon Kinesis Data Stream </li>
<li>Amazon Kinesis Data Firsehose</li>
<li>Amazon Elasticsearch Service(이하 Amazon ES)</li>
<li>Amazon S3</li>
</ul>
</li>
</ul>
<h1 id="테스트-환경-구성"><a href="#테스트-환경-구성" class="headerlink" title="테스트 환경 구성"></a>테스트 환경 구성</h1><h2 id="Data-Stream-생성"><a href="#Data-Stream-생성" class="headerlink" title="Data Stream 생성"></a>Data Stream 생성</h2><p>테스트용 Data Stream을 아래와 같은 설정으로 생성하였다.</p>
<ul>
<li>Kinesis Stream name : kevin-datastream-test</li>
<li>Shard<ul>
<li>샤드 수 : 1</li>
<li>쓰기 : 1 MB/초, 1000 레코드/초</li>
<li>읽기 : 2 MB/초</li>
</ul>
</li>
</ul>
<h2 id="Data-Firehose-생성"><a href="#Data-Firehose-생성" class="headerlink" title="Data Firehose 생성"></a>Data Firehose 생성</h2><p>테스트용 Data Firehose을 아래와 같은 설정으로 생성하였다.</p>
<ul>
<li>Delivery Stream name : kevin-shard-per-limit</li>
<li>Source <ul>
<li>Kinesis stream :: kevin-datastream-test</li>
</ul>
</li>
<li>Destination<ul>
<li>Amazon Elastcisearch<ul>
<li>Index : kevin_shard_per_limit</li>
<li>Type : _doc</li>
<li>No index rotation</li>
</ul>
</li>
<li>S3<ul>
<li>Backup S3 bucket : kevin-bucket-test</li>
</ul>
</li>
<li>Delivery Stream buffer conditions for Elasticsearch<ul>
<li>buffer size : 1 MB</li>
<li>buffer interval : 60 seconds</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>Buffer 관련 옵션 설정(buffer size : 1MB, buffer interval : 60 seconds)은 Destination(es, s3)에 전송되는 데이터 레코드를 빠르게 하기 위하여 설정하였으며, 상이하게 설정하여도 테스트에는 영향을 미치지 않는다.</p>
</blockquote>
<h2 id="Amazon-ES-도메인"><a href="#Amazon-ES-도메인" class="headerlink" title="Amazon ES 도메인"></a>Amazon ES 도메인</h2><ul>
<li>도메인 명: kevin-es-test</li>
<li>버전 : Amazon Elasticsearch 6.7</li>
<li>인스턴스 구성<ul>
<li>인스턴스 유형 : t2.small.elasticsearch(vCPU 1, Memory 2GiB)</li>
<li>인스턴스 개수 : 2</li>
<li>인스턴스별 일반 EBS(SSD) 10GB 각 1개</li>
<li>테스트 인덱스 : kevin_datastream_limit_test</li>
</ul>
</li>
</ul>
<h2 id="Python-및-Boto3-환경-구성"><a href="#Python-및-Boto3-환경-구성" class="headerlink" title="Python 및 Boto3 환경 구성"></a>Python 및 Boto3 환경 구성</h2><p>테스트의 편의를 위하여 python과 boto3 라이브러리를 사용하며, 다음과 같은 버전에서 테스트하였다.</p>
<ul>
<li>Python 버전 : 3.6</li>
<li>boto3 버전 : 1.9.248</li>
</ul>
<p>다음과 같이 가상환경을 구설 및 활성화하여 boto3 라이브러리를 설치한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir datastream_shard_per_limit</span><br><span class="line">$ <span class="built_in">cd</span> datastream_shard_per_limit</span><br><span class="line">$ virtualenv --python=python3.6 .venv/</span><br><span class="line">$ <span class="built_in">source</span> .venv/bin/activate</span><br><span class="line">$ pip install boto3</span><br></pre></td></tr></table></figure>

<blockquote>
<p>테스트에는 multiprocessing 모듈을 사용하며, 이는 Python 3.6에서는 내장 모듈이므로 별도의 설치가 필요하지 않다.</p>
</blockquote>
<hr>
<h1 id="테스트"><a href="#테스트" class="headerlink" title="테스트"></a>테스트</h1><p>테스트는 다음과 같은 샤드당 제약조건 2가지 케이스에 대하여 테스트 한다.</p>
<ul>
<li>초당 1개 샤드에 전송되는 데이터 레코드가 1000개 초과시 동작확인</li>
<li>초당 1개 샤드에 전송되는 데이터 레코드 크기가 1MB 초과시 동작확인</li>
</ul>
<p><em>테스트 과정중 “데이터 레코드 전송” 부분에서 멀티프로세스를 사용한다.</em><br>이유는 다음과 같다.</p>
<ul>
<li>데이터 레코드 전송시 호출되는 함수의 제약조건을 위반하지 않기 위해서<ul>
<li>초당 1개 샤드에 전송되는 데이터 레코드가 1000개 초과시 동작확인- PutRecords 제약 조건( 호출당 최대 500개 데이터레코드 전송 가능)</li>
</ul>
</li>
<li>여러 대의 디바이스에서 데이터 레코드 전송하는 상황을 연출하기 위해서</li>
</ul>
<p>테스트는 다음과 같은 공통된 시나리오를 바탕으로 진행된다.</p>
<ol>
<li>데이터 제너레이터로 데이터 레코드를 생성하고 파일로 저장한다. (예시 : 100개의 데이터 레코드를 갖는 파일을 생성)</li>
<li>데이터 레코드 전송 (파이썬 코드 main.py로 구현된 부분)<ul>
<li>데이터 레코드 파일을 읽어와 리스트에 저장한다.(예시: 파일에서 100개의 데이터 레코드를 읽어와 리스트에 저장한다.)</li>
<li>3개의 프로세스를 실행한다. 각각의 프로세스는 다음과 같은 동작을 한다.<ol>
<li>“시작시간”이 되면 “지속시간” 동안 매초마다 리스트에 저장된 데이터 레코드를 Data stream에 전송한다.<br>(예시: 2019-10-15T10:00:00+0900 시작하여 10초동안(2019-10-15T10:00:09+0900까지) 전송할 경우 총 1000개(100개 * 10초) 데이터 레코드를 전송함)</li>
<li>매초마다 전송한 결과에 대하여 파일로 저장한다.( “전송한 시간, 전송 소요시간, 전송 성공한 데이터 레코드 개수, 전송 실패한 데이터 레코드 개수”를 저장)</li>
</ol>
</li>
<li>프로세스 별로 “전송 성공 데이터 레코드 개수의 합”과  “전송 실패 데이터 레코드 개수의 합”을 확인한다.</li>
</ul>
</li>
<li>Destination(es, s3) 저장 여부 확인</li>
</ol>
<p>다음과 같은 파이썬 코드를 사용하여 테스트 과정중 “데이터 레코드 전송”부분을 진행한다.</p>
<ul>
<li><a href="/post_attachment/Kinesis-Data-Stream-샤드당-제약-조건-확인/main.py" target="_blank">main.py</a></li>
</ul>
<h1 id="main-py-동작-확인"><a href="#main-py-동작-확인" class="headerlink" title="main.py 동작 확인"></a>main.py 동작 확인</h1><p>main.py의 동작을 확인하기 위하여  다음과 같은 테스트 관련 정보를 확인한다.</p>
<ul>
<li>프로세스 개수 : 3개</li>
<li>프로세스별 초당 전송되는 데이터 레코드 정보 (데이터 레코드 개수는 333개 이하이고 데이터 레코드 크기는 341KB 이하이여야 함)<ul>
<li>데이터 레코드 개수 : 100개</li>
<li>데이터 레코드 크기 :  48KB</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ ls -al datarecord_file.log</span><br><span class="line">-rw-r--r--  1 kevin  staff  47814 10 15 10:10 datarecord_file.log</span><br><span class="line"></span><br><span class="line">$ cat datarecord_file.log | wc -l</span><br><span class="line">     100</span><br></pre></td></tr></table></figure>

<p>다음은 샘플 파일 내용중 일부이다.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">... 중략 ...</span><br><span class="line"></span><br><span class="line">&#123;<span class="attr">"device_manufacturer"</span>: <span class="string">"Apple"</span>, <span class="attr">"device_name"</span>: <span class="string">"I-Phone 8"</span>, <span class="attr">"device_model"</span>: <span class="string">"A1905"</span>, <span class="attr">"device_os"</span>: <span class="string">"iOS"</span>, <span class="attr">"device_os_number"</span>: <span class="string">"11.0"</span>, <span class="attr">"app_version"</span>: <span class="string">"v1.5.16(92)"</span>, <span class="attr">"event"</span>: <span class="string">"post_detail_click"</span>, <span class="attr">"interest_name"</span>: <span class="string">"대입/수능"</span>, <span class="attr">"interest_id"</span>: <span class="number">150</span>, <span class="attr">"interest_service_name"</span>: <span class="string">"취준일기"</span>, <span class="attr">"interest_service_id"</span>: <span class="string">"1200"</span>, <span class="attr">"interest_service_type"</span>: <span class="string">"함께해요"</span>, <span class="attr">"user_id"</span>: <span class="string">"mqVz31F1qDTnKd0t"</span>, <span class="attr">"device_id"</span>: <span class="string">"83NGRTpm6MCMU3F1uO6s"</span>, <span class="attr">"create_at"</span>: <span class="string">"2019-07-25T09:38:23Z"</span>, <span class="attr">"index"</span>: <span class="number">301</span>&#125;</span><br><span class="line">&#123;<span class="attr">"device_manufacturer"</span>: <span class="string">"Samsung"</span>, <span class="attr">"device_name"</span>: <span class="string">"Galaxy S10"</span>, <span class="attr">"device_model"</span>: <span class="string">"SM-G973"</span>, <span class="attr">"device_os"</span>: <span class="string">"Android"</span>, <span class="attr">"device_os_number"</span>: <span class="string">"10.0"</span>, <span class="attr">"app_version"</span>: <span class="string">"v1.5.16(92)"</span>, <span class="attr">"event"</span>: <span class="string">"post_detail_click"</span>, <span class="attr">"interest_name"</span>: <span class="string">"프로젝트"</span>, <span class="attr">"interest_id"</span>: <span class="number">120</span>, <span class="attr">"interest_service_name"</span>: <span class="string">"취준일기"</span>, <span class="attr">"interest_service_id"</span>: <span class="string">"1200"</span>, <span class="attr">"interest_service_type"</span>: <span class="string">"함께해요"</span>, <span class="attr">"user_id"</span>: <span class="string">"eYaDqO2s1NG"</span>, <span class="attr">"device_id"</span>: <span class="string">"lO07WKtnErZpsiBgDRmo"</span>, <span class="attr">"create_at"</span>: <span class="string">"2019-07-27T19:29:03Z"</span>, <span class="attr">"index"</span>: <span class="number">660</span>&#125;</span><br><span class="line">&#123;<span class="attr">"device_manufacturer"</span>: <span class="string">"Samsung"</span>, <span class="attr">"device_name"</span>: <span class="string">"Galaxy S8"</span>, <span class="attr">"device_model"</span>: <span class="string">"SM-G950"</span>, <span class="attr">"device_os"</span>: <span class="string">"Android"</span>, <span class="attr">"device_os_number"</span>: <span class="string">"8.0"</span>, <span class="attr">"app_version"</span>: <span class="string">"v1.5.15(90)"</span>, <span class="attr">"event"</span>: <span class="string">"post_detail_click"</span>, <span class="attr">"interest_name"</span>: <span class="string">"어학/회화"</span>, <span class="attr">"interest_id"</span>: <span class="number">180</span>, <span class="attr">"interest_service_name"</span>: <span class="string">"대나무숲"</span>, <span class="attr">"interest_service_id"</span>: <span class="string">"1300"</span>, <span class="attr">"interest_service_type"</span>: <span class="string">"물어봐요"</span>, <span class="attr">"user_id"</span>: <span class="string">"1p0foQ0MbyzaFBbN2"</span>, <span class="attr">"device_id"</span>: <span class="string">"Kn8rirFHqnyQ9GDzB"</span>, <span class="attr">"create_at"</span>: <span class="string">"2019-07-26T10:12:11Z"</span>, <span class="attr">"index"</span>: <span class="number">61</span>&#125;</span><br></pre></td></tr></table></figure>

<p>main.py를 실행하여 데이터 레코드를 전송한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ python3 main.py</span><br><span class="line">[1571102092.0, 1571102093.0, 1571102094.0, 1571102095.0, 1571102096.0, 1571102097.0, 1571102098.0, 1571102099.0, 1571102100.0, 1571102101.0, 1571102102.0, 1571102103.0, 1571102104.0, 1571102105.0, 1571102106.0, 1571102107.0, 1571102108.0, 1571102109.0, 1571102110.0, 1571102111.0, 1571102112.0, 1571102113.0, 1571102114.0, 1571102115.0, 1571102116.0, 1571102117.0, 1571102118.0, 1571102119.0, 1571102120.0, 1571102121.0, 1571102122.0, 1571102123.0, 1571102124.0, 1571102125.0, 1571102126.0, 1571102127.0, 1571102128.0, 1571102129.0, 1571102130.0, 1571102131.0, 1571102132.0, 1571102133.0, 1571102134.0, 1571102135.0, 1571102136.0, 1571102137.0, 1571102138.0, 1571102139.0, 1571102140.0, 1571102141.0, 1571102142.0, 1571102143.0, 1571102144.0, 1571102145.0, 1571102146.0, 1571102147.0, 1571102148.0, 1571102149.0, 1571102150.0, 1571102151.0]</span><br></pre></td></tr></table></figure>

<p>3개 프로세스의 데이터 레코드 전송과 관련하여 정리하면 다음과 같다.</p>
<ul>
<li>매초마다 전송하는 데이터 레코드<ul>
<li>300개/초 (100개 * 3개 프로세스)</li>
<li>143142바이트/초 ((47814 - 100)바이트 * 3개 프로세스, 줄바꿈 ‘\n’ 100바이트는 제외하여 계산)</li>
</ul>
</li>
<li>60초동안 전송하는 데이터 레코드<ul>
<li>18000개 (300개 * 60초)</li>
<li>약 8.19MB (8588520 바이트) ( 143142 바이트 * 60초 )</li>
</ul>
</li>
</ul>
<p>각각 프로세스가 전송한 결과를 확인하면 다음과 같다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### 0번째 프로세스 로그</span></span><br><span class="line">$ cat response_result_0.log</span><br><span class="line">process id : 26635</span><br><span class="line">      1571102092.163 	                0.063 	   100 	     0 </span><br><span class="line">      1571102093.000 	                0.035 	   100 	     0 </span><br><span class="line">      1571102094.000 	                0.037 	   100 	     0 </span><br><span class="line"></span><br><span class="line">... 중략 ...</span><br><span class="line"></span><br><span class="line">      1571102149.000 	                0.034 	   100 	     0 </span><br><span class="line">      1571102150.000 	                0.034 	   100 	     0 </span><br><span class="line">      1571102151.000 	                0.038 	   100 	     0 </span><br><span class="line">total_sucsess_count : 6000 	 total_fail_count : 0</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### 1번째 프로세스 로그</span></span><br><span class="line">$ cat response_result_1.log</span><br><span class="line">process id : 26636</span><br><span class="line">      1571102092.163 	                0.066 	   100 	     0 </span><br><span class="line">      1571102093.000 	                0.032 	   100 	     0 </span><br><span class="line">      1571102094.000 	                0.037 	   100 	     0 </span><br><span class="line"></span><br><span class="line">... 중략 ...</span><br><span class="line"></span><br><span class="line">      1571102149.000 	                0.034 	   100 	     0 </span><br><span class="line">      1571102150.000 	                0.029 	   100 	     0 </span><br><span class="line">      1571102151.000 	                0.038 	   100 	     0 </span><br><span class="line">total_sucsess_count : 6000 	 total_fail_count : 0</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### 2번째 프로세스 로그</span></span><br><span class="line">$ cat response_result_2.log</span><br><span class="line">process id : 26637</span><br><span class="line">      1571102092.163 	                0.066 	   100 	     0 </span><br><span class="line">      1571102093.000 	                0.035 	   100 	     0 </span><br><span class="line">      1571102094.000 	                0.038 	   100 	     0 </span><br><span class="line"></span><br><span class="line">... 중략 ...</span><br><span class="line">      1571102149.000 	                0.034 	   100 	     0 </span><br><span class="line">      1571102150.000 	                0.034 	   100 	     0 </span><br><span class="line">      1571102151.000 	                0.043 	   100 	     0 </span><br><span class="line">total_sucsess_count : 6000 	 total_fail_count : 0</span><br></pre></td></tr></table></figure>

<p>총 18000개(100개 * 60초 * 3 프로세스)의 데이터 레코드를 전송 하였고 18000개 (6000 + 6000 + 6000개) 전부 전송 성공하였다는 응답을 확인했다.</p>
<p>Destination(es, s3)에 데이터 레코드가 저장 되었는지 확인한다.<br>es에는 18000개 Document가 생성되었다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ curl -XGET https://search-kevin-es-test-dtdgdko7cas7f6umwhssry2koq.ap-northeast-2.es.amazonaws.com/kevin_shard_per_limit/_count</span><br><span class="line">&#123;<span class="string">"count"</span>:18000,<span class="string">"_shards"</span>:&#123;<span class="string">"total"</span>:5,<span class="string">"successful"</span>:5,<span class="string">"skipped"</span>:0,<span class="string">"failed"</span>:0&#125;&#125;%</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">S3에 총 8.19MB 크기를 갖는 파일들이 생성되었다.</span><br><span class="line">$ aws s3 ls s3://kevin-bucket-test --recursive</span><br><span class="line">2019-10-15 10:15:00    1048745 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-14-52-971961f4-9e37-433c-a9e9-8795a2605a90</span><br><span class="line">2019-10-15 10:15:08    1048745 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-14-59-b3795c35-6bfe-41ab-958c-547166ce2947</span><br><span class="line">2019-10-15 10:15:14    1048771 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-15-06-798f1f2e-dfeb-488f-8903-2a09e4977a87</span><br><span class="line">2019-10-15 10:15:22    1048816 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-15-13-774dd724-9f38-4b1d-81af-0ce6ec0e8053</span><br><span class="line">2019-10-15 10:15:29    1048648 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-15-21-dfe55c59-e254-43c5-ae21-5fcc4c35fbdb</span><br><span class="line">2019-10-15 10:15:36    1048765 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-15-28-609faef0-ea7d-4a49-ab35-3cb5dd257701</span><br><span class="line">2019-10-15 10:15:44    1048856 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-15-35-0956c89c-1b8d-4f4e-8ad4-178d051bf2c5</span><br><span class="line">2019-10-15 10:15:51    1048674 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-15-43-04ddbb29-4021-4a57-9415-9de8ef48c1f8</span><br><span class="line">2019-10-15 10:16:52     198500 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-15-50-23c2b957-0c57-4092-9ec1-ad1acd6f1f78</span><br></pre></td></tr></table></figure>

<p>main.py 동작 확인 결과는 다음과 같다.</p>
<ul>
<li>총 18000개의 데이터 레코드를 Data stream에 전송하였고 18000개 모두 전송 성공하였다는 응답을 받았다.</li>
<li>Destination(es, S3)에는 데이터 레코드가 모두 저장된 것을 확인하였다.<ul>
<li>es - 18000개 Documents 생성 확인</li>
<li>S3 - 생성된 파일들의 총 크기가 8588520 바이트임을 확인</li>
</ul>
</li>
</ul>
<hr>
<h2 id="테스트-케이스-초당-1개-샤드에-전송되는-데이터-레코드가-1000개-초과시-동작확인"><a href="#테스트-케이스-초당-1개-샤드에-전송되는-데이터-레코드가-1000개-초과시-동작확인" class="headerlink" title="테스트 케이스 : 초당 1개 샤드에 전송되는 데이터 레코드가 1000개 초과시 동작확인"></a>테스트 케이스 : 초당 1개 샤드에 전송되는 데이터 레코드가 1000개 초과시 동작확인</h2><p>초당 1000개 이상의 레코드를 전송하는 상황을 연출하기 위하여 다음과 같은 테스트 관련 정보를 확인한다.</p>
<ul>
<li>프로세스 개수 : 3개</li>
<li>프로세스별 초당 전송하는 데이터 레코드 정보 (데이터 레코드 개수는 334개이상이고 데이터 레코드 크기는 341KB 이하여야 함)<ul>
<li>데이터 레코드 개수 : 500개 (PutRecords는 최대 500개 데이터 레코드 전송 가능하기 때문)</li>
<li>데이터 레코드 크기 : 233KB</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### 샘플 파일의 크기, 데이터 레코드 개수</span></span><br><span class="line">$ ls -al datarecord_file.log</span><br><span class="line">-rw-r--r--  1 kevin  staff  238871 10 15 10:36 datarecord_file.log</span><br><span class="line"></span><br><span class="line">$ cat datarecord_file.log | wc -l</span><br><span class="line">     500</span><br></pre></td></tr></table></figure>

<p>다음은 샘플 파일 내용중 일부이다.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">... 중략 ...</span><br><span class="line"></span><br><span class="line">&#123;<span class="attr">"device_manufacturer"</span>: <span class="string">"LG"</span>, <span class="attr">"device_name"</span>: <span class="string">"LG V50"</span>, <span class="attr">"device_model"</span>: <span class="string">"LM-V500N"</span>, <span class="attr">"device_os"</span>: <span class="string">"Android"</span>, <span class="attr">"device_os_number"</span>: <span class="string">"9.0"</span>, <span class="attr">"app_version"</span>: <span class="string">"v1.5.14(89)"</span>, <span class="attr">"event"</span>: <span class="string">"post_detail_click"</span>, <span class="attr">"interest_name"</span>: <span class="string">"취업"</span>, <span class="attr">"interest_id"</span>: <span class="number">130</span>, <span class="attr">"interest_service_name"</span>: <span class="string">"Q&amp;A"</span>, <span class="attr">"interest_service_id"</span>: <span class="string">"1400"</span>, <span class="attr">"interest_service_type"</span>: <span class="string">"물어봐요"</span>, <span class="attr">"user_id"</span>: <span class="string">"kKWTbZRbC3K3v"</span>, <span class="attr">"device_id"</span>: <span class="string">"5eHVWKKt99DMWknc1u8Q"</span>, <span class="attr">"create_at"</span>: <span class="string">"2019-07-25T21:38:36Z"</span>, <span class="attr">"index"</span>: <span class="number">181</span>&#125;</span><br><span class="line">&#123;<span class="attr">"device_manufacturer"</span>: <span class="string">"Samsung"</span>, <span class="attr">"device_name"</span>: <span class="string">"Galaxy S10"</span>, <span class="attr">"device_model"</span>: <span class="string">"SM-G973"</span>, <span class="attr">"device_os"</span>: <span class="string">"Android"</span>, <span class="attr">"device_os_number"</span>: <span class="string">"10.0"</span>, <span class="attr">"app_version"</span>: <span class="string">"v1.5.14(89)"</span>, <span class="attr">"event"</span>: <span class="string">"post_like_click"</span>, <span class="attr">"interest_name"</span>: <span class="string">"대입/수능"</span>, <span class="attr">"interest_id"</span>: <span class="number">150</span>, <span class="attr">"interest_service_name"</span>: <span class="string">"취준일기"</span>, <span class="attr">"interest_service_id"</span>: <span class="string">"1200"</span>, <span class="attr">"interest_service_type"</span>: <span class="string">"함께해요"</span>, <span class="attr">"user_id"</span>: <span class="string">"WcyByhbOifWoh7ha"</span>, <span class="attr">"device_id"</span>: <span class="string">"UoPGYYDHAItig2xbWX"</span>, <span class="attr">"create_at"</span>: <span class="string">"2019-07-24T22:24:36Z"</span>, <span class="attr">"index"</span>: <span class="number">214</span>&#125;</span><br><span class="line">&#123;<span class="attr">"device_manufacturer"</span>: <span class="string">"LG"</span>, <span class="attr">"device_name"</span>: <span class="string">"LG V50"</span>, <span class="attr">"device_model"</span>: <span class="string">"LM-V500N"</span>, <span class="attr">"device_os"</span>: <span class="string">"Android"</span>, <span class="attr">"device_os_number"</span>: <span class="string">"9.0"</span>, <span class="attr">"app_version"</span>: <span class="string">"v1.5.14(89)"</span>, <span class="attr">"event"</span>: <span class="string">"post_like_click"</span>, <span class="attr">"interest_name"</span>: <span class="string">"공무원/임용"</span>, <span class="attr">"interest_id"</span>: <span class="number">160</span>, <span class="attr">"interest_service_name"</span>: <span class="string">"대나무숲"</span>, <span class="attr">"interest_service_id"</span>: <span class="string">"1300"</span>, <span class="attr">"interest_service_type"</span>: <span class="string">"물어봐요"</span>, <span class="attr">"user_id"</span>: <span class="string">"6K65FIDOkhegH8Yw"</span>, <span class="attr">"device_id"</span>: <span class="string">"lvSZCt6YtdEjyC"</span>, <span class="attr">"create_at"</span>: <span class="string">"2019-07-23T03:10:01Z"</span>, <span class="attr">"index"</span>: <span class="number">395</span>&#125;</span><br></pre></td></tr></table></figure>

<p>main.py를 실행하여 데이터 레코드를 전송한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ python3 main.py</span><br><span class="line">[1571103605.0, 1571103606.0, 1571103607.0, 1571103608.0, 1571103609.0, 1571103610.0, 1571103611.0, 1571103612.0, 1571103613.0, 1571103614.0, 1571103615.0, 1571103616.0, 1571103617.0, 1571103618.0, 1571103619.0, 1571103620.0, 1571103621.0, 1571103622.0, 1571103623.0, 1571103624.0, 1571103625.0, 1571103626.0, 1571103627.0, 1571103628.0, 1571103629.0, 1571103630.0, 1571103631.0, 1571103632.0, 1571103633.0, 1571103634.0, 1571103635.0, 1571103636.0, 1571103637.0, 1571103638.0, 1571103639.0, 1571103640.0, 1571103641.0, 1571103642.0, 1571103643.0, 1571103644.0, 1571103645.0, 1571103646.0, 1571103647.0, 1571103648.0, 1571103649.0, 1571103650.0, 1571103651.0, 1571103652.0, 1571103653.0, 1571103654.0, 1571103655.0, 1571103656.0, 1571103657.0, 1571103658.0, 1571103659.0, 1571103660.0, 1571103661.0, 1571103662.0, 1571103663.0, 1571103664.0]</span><br></pre></td></tr></table></figure>

<p>3개 프로세스의 데이터 레코드 전송과 관련하여 정리하면 다음과 같다.</p>
<ul>
<li>매초마다 전송하는 데이터 레코드<ul>
<li>1500개/초 전송 (500개 * 3 프로세스)</li>
<li>715113 바이트/초 전송 ((238871 - 500)바이트 * 3개 프로세스, 줄바꿈 ‘\n’ 500바이트는 제외하여 계산)  </li>
</ul>
</li>
<li>60초동안 전송하는 데이터 레코드<ul>
<li>90000개 데이터 레코드 (1500개 * 60초)</li>
<li>40.9MB (42906780 바이트) (715113 바이트 * 60초)</li>
</ul>
</li>
</ul>
<p>각각 프로세스가 전송한 결과를 확인하면 다음과 같다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ cat response_result_0.log</span><br><span class="line">process id : 26949</span><br><span class="line">      1571103605.000 	                0.231 	   500 	     0 </span><br><span class="line">      1571103606.000 	                0.108 	   500 	     0 </span><br><span class="line">      1571103607.000 	                0.076 	   125 	   375 </span><br><span class="line"></span><br><span class="line">... 중략 ...</span><br><span class="line"></span><br><span class="line">      1571103662.000 	                0.202 	   500 	     0 </span><br><span class="line">      1571103663.000 	                0.392 	    62 	   438 </span><br><span class="line">      1571103664.000 	                0.424 	   500 	     0 </span><br><span class="line">total_sucsess_count : 20006 	 total_fail_count : 9994</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ cat response_result_1.log</span><br><span class="line">process id : 26950</span><br><span class="line">      1571103605.000 	                0.204 	   500 	     0 </span><br><span class="line">      1571103606.000 	                0.108 	   500 	     0 </span><br><span class="line">      1571103607.000 	                0.786 	   125 	   375 </span><br><span class="line"></span><br><span class="line">... 중략 ...</span><br><span class="line"></span><br><span class="line">            1571103662.000 	                0.136 	   500 	     0 </span><br><span class="line">      1571103663.000 	                0.316 	   125 	   375 </span><br><span class="line">      1571103664.000 	                0.210 	   500 	     0 </span><br><span class="line">total_sucsess_count : 21077 	 total_fail_count : 8923</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ cat response_result_2.log</span><br><span class="line">process id : 26953</span><br><span class="line">      1571103605.000 	                0.233 	   500 	     0 </span><br><span class="line">      1571103606.000 	                0.131 	   500 	     0 </span><br><span class="line">      1571103607.000 	                0.104 	   125 	   375 </span><br><span class="line"></span><br><span class="line">... 중략 ...</span><br><span class="line"></span><br><span class="line"> 	  1571103662.000 	                0.246 	   500 	     0 </span><br><span class="line">      1571103663.000 	                0.294 	     0 	   500 </span><br><span class="line">      1571103664.000 	                0.505 	   500 	     0 </span><br><span class="line">total_sucsess_count : 20983 	 total_fail_count : 9017</span><br></pre></td></tr></table></figure>

<p>90000개 데이터 레코드 전송과 관련하여 전송 성공/실패한 결과를 정리하면 다음과 같다.</p>
<ul>
<li>전송 성공<ul>
<li>총 62066 개 (20006개 + 21077개 + 20983개)</li>
<li>평균 1034.43개/초 (62066개 / 60초)</li>
</ul>
</li>
<li>전송 실패<ul>
<li>총 27934 개 (9994개 + 8923개 + 9017개)</li>
<li>평균 465.57개 / 초 (27934개 / 60초)</li>
</ul>
</li>
</ul>
<p>Destination(es, s3)에 데이터 레코드가 저장 되었는지 확인한다.<br>es를 확인하면 62066개의 Document가 생성되었다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ curl -XGET https://search-kevin-es-test-dtdgdko7cas7f6umwhssry2koq.ap-northeast-2.es.amazonaws.com/kevin_shard_per_limit/_count</span><br><span class="line">&#123;<span class="string">"count"</span>:62066,<span class="string">"_shards"</span>:&#123;<span class="string">"total"</span>:5,<span class="string">"successful"</span>:5,<span class="string">"skipped"</span>:0,<span class="string">"failed"</span>:0&#125;&#125;%</span><br></pre></td></tr></table></figure>

<p>S3에 총 28.2MB 크기를 갖는 파일들이 생성되었다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ aws s3 ls s3://kevin-bucket-test --recursive</span><br><span class="line">2019-10-15 10:40:07    1048719 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-40-05-46b29bc0-c90e-4336-8e41-e2e223a60f5b</span><br><span class="line">2019-10-15 10:40:09    1049011 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-40-06-6a791755-2ac9-46e3-b359-9e5afe18f3a4</span><br><span class="line">2019-10-15 10:40:11    1048719 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-40-08-bbfa1e19-6c5b-467d-a755-191733f43353</span><br><span class="line"></span><br><span class="line">... 중략 ...</span><br><span class="line"></span><br><span class="line">2019-10-15 10:41:03    1048893 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-40-59-9ab2a36d-1ce1-47cd-b286-4cd04235b9dd</span><br><span class="line">2019-10-15 10:41:06    1048858 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-41-02-e8628263-fd0d-485c-ae08-e3078f7065bb</span><br><span class="line">2019-10-15 10:42:06     221154 2019/10/15/01/kevin-shard-per-limit-1-2019-10-15-01-41-04-8ca8c8da-4b3c-4821-8db5-68b1df9ee0e5</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>“전송 성공한 데이터 레코드가 S3에 저장되었다”고 추정</strong></p>
<p>“S3에 저장된 파일들의 내용”과 “전송 성공한 데이터 레코드”를 일일이 대조한다면 “전송 성공한 데이터 레코드가 S3에 저장되었다”고 확정할 수 있다.<br>하지만 많은 시간이 소요될 것이라 판단되어 “전송 성공한 데이터 레코드가 S3에 저장되었다” 추정하는 것으로 마무리 짓는다.</p>
<p>전송 성공하였을 것이라 추정되는 데이터 레코드 크기는 28.2MB(약 29589469 바이트)이다.</p>
<ul>
<li>715113 바이트 * 60초 * (62066 개 / 90000개) =   42906780 * 0.689622222222222 = 약 29589469 바이트</li>
</ul>
<p>S3에 저장된 파일들의 크기의 합은 28.2MB (29588562 바이트)이다.</p>
<p>따라서 전송 성공한 데이터 레코드가 S3에 저장되었다는 것을 추정할 수 있다.</p>
</blockquote>
<p>테스트 결과를 정리하면 다음과 같다.</p>
<ul>
<li>60초동안 초당 1500개의 데이터 레코드를 전송한 결과, 개발자 안내서에서 제시한 제약조건과 유사하다는 것을 알 수 있다.<ul>
<li>전송 성공은 1034.43개/초</li>
<li>전송 실패는 465.57개/초</li>
</ul>
</li>
<li>전송 성공한 데이터 레코드 62066 개에 대하여 Amazon es는 저장되었고, S3에는 저장된 것으로 추정한다.</li>
</ul>
<hr>
<h2 id="테스트-케이스-초당-1개-샤드에-전송되는-데이터-레코드-크기가-1MB-초과시-동작확인"><a href="#테스트-케이스-초당-1개-샤드에-전송되는-데이터-레코드-크기가-1MB-초과시-동작확인" class="headerlink" title="테스트 케이스 : 초당 1개 샤드에 전송되는 데이터 레코드 크기가 1MB 초과시 동작확인"></a>테스트 케이스 : 초당 1개 샤드에 전송되는 데이터 레코드 크기가 1MB 초과시 동작확인</h2><p>초당 1MB이상 데이터 레코드를 전송하는 상황을 연출하기 위하여 다음과 같은 테스트 관련 정보를 확인한다.</p>
<ul>
<li>프로세스 개수 : 3개</li>
<li>프로세스별 초당 전송하는 데이터 레코드<br>(데이터 레코드 개수는 333개 이하이고 데이터 레코드 크기는 341KB 이상이여야 함)<ul>
<li>데이터 레코드 개수 : 100개</li>
<li>데이터 레코드 크기 : 584KB</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### 샘플 파일의 크기, 데이터 레코드 개수</span></span><br><span class="line">$ ls -al datarecord_file.log</span><br><span class="line">-rw-r--r--  1 kevin  staff  583807 10 15 11:53 datarecord_file.log</span><br><span class="line"></span><br><span class="line">$ cat datarecord_file.log | wc -l</span><br><span class="line">     100</span><br></pre></td></tr></table></figure>

<p>다음은 샘플 파일 내용중 일부이다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">... 중략 ...</span><br><span class="line"></span><br><span class="line">&#123;<span class="string">"device_manufacturer"</span>: <span class="string">"Samsung"</span>, <span class="string">"device_name"</span>: <span class="string">"Galaxy S8"</span>, <span class="string">"device_model"</span>: <span class="string">"SM-G950"</span>, <span class="string">"device_os"</span>: <span class="string">"Android"</span>, <span class="string">"device_os_number"</span>: <span class="string">"8.0"</span>, <span class="string">"app_version"</span>: <span class="string">"v1.5.15(90)"</span>, <span class="string">"event"</span>: <span class="string">"post_detail_click"</span>, <span class="string">"interest_name"</span>: <span class="string">"공무원/임용"</span>, <span class="string">"interest_id"</span>: 160, <span class="string">"interest_service_name"</span>: <span class="string">"비밀자료"</span>, <span class="string">"interest_service_id"</span>: <span class="string">"1100"</span>, <span class="string">"interest_service_type"</span>: <span class="string">"비밀이에요"</span>, <span class="string">"user_id"</span>: <span class="string">"xx1m60ZHJj1K"</span>, <span class="string">"device_id"</span>: <span class="string">"6oZsdoQmuYYYmEJPC"</span>, <span class="string">"create_at"</span>: <span class="string">"2019-07-27T04:33:16Z"</span>, <span class="string">"index"</span>: 384, <span class="string">"additional_field_0"</span>: <span class="string">"WCfGJQ8aIopfHp NqhcJD9YHaJEXL99GJrTNfE wHZe3oVUGCuNzEW GdXoIdLWs UkPbHXkBk8TJ1BzqtejAzibTcToteHKphGE0GIgWcg0ZvDWTXEBrwL8Iftlb8MyWUpfrZk5CmHduuWsCGBbfoTM4ZlggEFmqy7aSq5DnT Bm3U7T29LA8xLMIiriaMtlVeksm0Dc7KZiSZSAkeBwJBTeHDzA3rJAzSNnyrZPGwaDyIjrWDVVwf8AQ1OcRkn1x7Zg64fqabT2GoGYir7FNwpbU9wbPKB Y6GbCsw8lNLB5Q531MnlAzhrXW Ja4JJUL1U97v5cQaCFJuWB56FYWinFi2INPDraXUGpStRZ9RF4haaznT81zoj6It2m Ipru xIylWMz4vFvwX2Gzo3ToKRRIMW 4Uc w7VVS6DmPvNdl59fgXw ELwTyd8mStwXAhj78MYk8mLaNqxJgmoCqcneN1CISEI 9vubPDdFyHyHCP5PrM9E0lscJmAyguhqm"</span>, <span class="string">"additional_field_1"</span>: <span class="string">"AZUGbTMML2cBnBAT4HDfYxS05qB9UFsoP4Y4hNg6b2QCQq6ToBS28sJCOHxGjljr05R4HGGjU3RQVcZeKOe8lOsxrPOIArhsGgYrJ6zLGd1sIhgB i1AWMYwU2WxonyvLp4nPYpUM3RAWIppqnDzVkvyo8Mzuci0d5jimJFskrLIHgF8zj WN4kxoyA4YRzA4Ej3T47k5cSPO5yCrS6oAnJVUmCiazvQgEv0l0JEPcZmRRHlwTYxGiGyYroJzXJ6ARAEMYX2kmjGDGyx8XNlMmhTzGD8cgWYyGRmR0K2VC8Au6UEtMJQSpXF2POxFe1z8ji8u2QS3kvZxxqOxMJMgo1IWrEfbNrJlt2B lMAsvJuSF3eDjVOldjETXOi7t7HmaoxA8gKgBVplpP73nHjECTWFTYtTHkSAqpCGpRPZ7G4sE5lYfu952puXLJLTb1Qsngc75er0uX3p3Q2 rzqWHiXa VnFfzd0rp311GcMPxqg YuuPCfY Kodyi9EbAfE8"</span>, <span class="string">"additional_field_2"</span>: <span class="string">"rrrudpuxgdJ9lKO4LWhiJxxPeFGbvp5DPMzrMbAIlvW2bTqndm3aw1Hxj iym7Jq4HSzJMIYn31wVRPHdDVWy9lylgDDO3Tjl4Z74NPYClCvo6F8uVYCGz2o2aWakId71bx2b8gnM493pBHx30Yq4msIeYvWBrMN6WtZ3t66zA1CA2NB3TOvoH7bjTCGDsFHJ9o 0bjBHhEy0PrmwU6Pq0vhb 4s0HWl wERtjHJez9FkDhx0sTmKRx5tOp4SujMmm 3jnPDYx9riwb9hYfdD8HM3c4P68Z9Tqg8B8fQcJdZwS0Sg6yd4VkSqHz1nt y2Z1uAH83ZuByYCvN5tyeFhPnAQs19FpTAHDcqEIE5W9KtkJWauHL 7gcobOWHxwefJRUIb25IpKyvZiDn88EuqUQ7zOQOiZA9zxY qn wBudHmcCTnJIOe4NSKRJttjWWZvi5nqyMNUCLqQkuHy1U9TaxqBQKV4wHomN4q9hM1UVCfm5myvH"</span>, <span class="string">"additional_field_3"</span>: <span class="string">"XLrY3vT49h4oqky3PjUREnHKcekg8KGsuNoYbEKxgcoUSfmojjCOMfxUmQTOfD9iLp5xK4SOw3SS9ra9BYQsLQMW4NKQEFkImWjU LaFKpoVnoX5U4swuUAfXBfjMxnARQzeCSr6ANGuRoA4v9pi5p77kUMPrOSjnVP3CAYpui6TZgmPNSyO9kPYByqu9sZSI pqfsaIsEUjBapbz9Fj0Z3kl6SVQOzR0 vtP0HGzjYSmVDtXkyHsdYBzxMdLByML EgLrKwPkj38vFBj6an4lfNEi2E3 yqkHP9ZowuzAFhk8mg7qsGIuiSh43dNBuAWBmntCkiYLKECjqH6efZhITx CebmrL4omumJ 2YI75aJDvKJKq7ow3HVZ0Gjicc4U9wbwAhJK70AxNMbAivZJ oonjlKHhPOWyw2v4FUFZ9gTppRA81RiJF08QkLkDPeuf gYWbgtmFWtzNAbDr22dzosSAxK3JQqUhp1713hshKyYPt1KiM5RU32cY5qqjD"</span>, <span class="string">"additional_field_4"</span>: <span class="string">"keZErkS42RNwM33MDLE3b8GEmSS2f8SWopEudOy54mf4jn99sXVY4EvPUK48gHNpOVsZP3RoI961GR3w6FMjhvfgk4rUv6Xt9OUClGHyxeZf8 1uQKKmHLrfQLuVG2oaCcAfDfuEvBm2ehkOLe7Aa8AKz GLylBqE27Dh6BKETFwJZRbFCd7w7jdayhMncJX9NsqcavyMJASD1kJ21nmhETfXuSOmfohImt tUMmIv4QkIFNFvW8IAD3t64xi8gV6joMmhYLHZ9N9DGO kjJXCFiuOpUl 8CyltqaIGvkJ3Mfi4B4tosssWsugRDt4OLxFQcw8fBnlndjRUHFlxAviAuIrkNcsJAkrYPSqmwgbvjyoaYnhZXuaASFfiTY6Uum2aOqRmnSekL9aztJjNgplApj2X0TGWVhvHN0WUsnONtFafnw4 lPn7OEsP2s9eYmhrfBmxl JfKRYYphY4YdsoMmp3R8s43DwgmzUpvrbd9eO86YPvHoS FARTuK7oBYcaEU"</span>, <span class="string">"additional_field_5"</span>: <span class="string">"RZ S4844uTxKDg6WwDFdr3ERAijtuXOeNkAvbH8PWAOP8 R434k38saZbojLmKDVHm4j8k1 GoblH74woP uqfUkRf3L 7FSd0FfTkxlSi6QOk HuM7LytqM91sh udeZ5zt66xyydjrQZ1TiI rXRhUQG6NyajLdm81qScAekjxq5Da6wvA7T6ODeIBRKz6XYM8s3rLvwD NeHOXTfqeJjxNSQBHlgPEDrXMaIenF x9nCDS8lHUtPAMPCIMc8uciv3iovtugufB sW16Ko3jBkzafiQZ6NxDG4AJnm3x tJYKmdu1y9P6seuNqNndlqssFj7ZWf6dHLDiuyM10a8p3oOj rdBorM229n4mk6oBPaRf3UJKzHidqJpxb7ZNzFR08iSau69ktrEJYZqMXU1v057cwT4HSsFZwY4mtRaLvv2 iKqnAuCx2S123vvBljhkPakW4E1CwcbqeOWcbQB3cPsQ3ERf2H8BLYKK6jdy01KBDyXZTnYXQ3"</span>, <span class="string">"additional_field_6"</span>: <span class="string">"CnJVAUvhd7K91IUuz9TmXXWn8zPIwrBIxKTkOd5dt2 D8 xvOLHmz7G6a1JEH6zb6BQPrzRcU3MMpPOooRlM6Geo5KFkwfqrURVrpDXx9ZiJqowzwVTqnXNylQB6V9Z22k9VFmCyMEUWRBh1z1ISxzy3OdvCDOg0b5MDBf1cTaqTLL6KhnEC6jtV31uRQEgW 5irCd1OI9z6wWiL8b2bfUblrdB0paaZG8nsBKoNwg8pWY4rsi1CBTTNvnQ3gZEKKKQRNm1mUo4vdba6RZZ2 vv9idmlJVNFSLfLxYTdfgm9d8szzYWQyavtGsvaZWgoiU3t23TGfZuuxZ2GLzSFaYT8SnEyvCABNsNCUqnehlVIFbmdE5 reA5NLT4qacpdoQPoDzz99EKlxtzHhm1eZMmNzIOqzgX1YlYTRJVKH1P4yCicAYAcIcLu9B6oADpR3dXDcmmeCFnuh0M M1lWP7nnjcIBucy4LWE2AnLVhTFaFfm3YRCobeMSCWIlXEssEj3FRaN"</span>, <span class="string">"additional_field_7"</span>: <span class="string">"8Cxmz7mEXFU8ChOOJdaBWTygw69spo4e6qa8aUb4wShfse7zousHT3WB8crVNXy9tZwhk1ZjuqQJHmTyf7PLXKt17xMz LFIQUemjlN8lyie796cqCAEJMvjmflhOT0vRyPExoz1BjfQaJ2hPZxVUqKZ8LIJGVtz5cbyRysg30faRvVreWuTQ4VZTUFQzS0LmMXgwqlTSbv8WtGLu1UPSf8UrpR1PH9TuLuAcklXnve3Df4r Th59W0Ue7a3a5EXD4DqTpuEnMcX9O5eXPBK8CVUZiXyIjp0r6XMJq8AEu9TQNzrtjBLygLGlWCaJMMYlHWpDdXJc9uy66p89rLPGSg58H8oGO7fE8pYBK2Hrl0wtgHkrmYKF1KpncrrmtAm9jn8AzkwSG3YjPdMaUwWd0KY8zR9sVpDThiM0mpeMDehz1xYxov VXFYVf0kaBxMryaztaatFvKZrviIMEfqgyM0NBmIygpuXAznxLWBVGspEmc7EAG7nhkqNOr KPZz xM"</span>, <span class="string">"additional_field_8"</span>: <span class="string">"SxL1exCRSgsDHmlZ8Dgx3oApGSM9XhjiEkRGntpQgEss3liNyu37JTMKYQVeC 33c6Q7F8A4d03RIr feAXYBkgJKmD08F8Fdu0kuQjlXHeTBDnMZ6VepE5qOdD2xDcxd2KMptkuuKuPyhF2xoO8OwbXq7wNs81 gUMWE87yWtPzashJqr5LPoO W8UBRqlu8eUtsqTnmssK7ZkLJV3dnBcu5taIBg7DX5Di1yYuNJ59sdcKP2i0emx9hAJpPYi78axjCXCc22yB7bFDfG9rf6gDbUexZ5DSMOmQaRorQZ2m3YfemHmunkFfGlBlrAQJxKhpuLYAIZfI0v2S46ueIsLqb5D1wSwOQWa72hRXBthWt5a1VbOYJXZirAHtbIf4v4X0jisgAnmJVUkgjXIrrF8jaJnrffEoqFthkE7bc0jjfJGbM53Grfqyp4v3hAkmiT1abe5UNCsDjx7DYWud32FF9lfmX0zkUmfheRn5WP6p6gWDbJUa"</span>, <span class="string">"additional_field_9"</span>: <span class="string">"zoFMEGUNZvnfynGGlsKPMKSKa45TyxKG9Owkx0fvCvHnxfd04pc314r8EmJ5C4DKqC91k0HRx7UON1eoh8tAh2PDvXUfqLrOkb0z8ZaoIozdsDIwcfwu03dciSJoVoIFDnUJByKv8yHfIeduc5kD17zjdvGLV0Xz7efUBaK2jLgUYNAmsnrCdfBezA6BRkkEe7g2RLpE2tuxK Z6NtPeqFs 9C1SgGUC WNGkRodKASQeQ9G7Ji8x3qxbr mt H2lzjwSAhZjsCrFzmc50FifgrrCx3iJJTJ8SAf5iyJKydeJceFjQLuH1ZIUXa0EeliiwnSFPA1YYeC2Ta2LiolFAqJW1Mugoe1s97 AHWljIeYutZ qc7xbmQgR4vV0Ff5StX lc848HUmvI1K9JPsuvHVncXdddFcaHnniSMlTPPG1qSl0hMQ1sQrZdH9GzrsrVvFlkym2XUNz3hK3n 8VFjwapK6YhVKjuzVH8iutWPEqlw3eTmVoZF1Pl"</span>&#125;</span><br><span class="line">&#123;<span class="string">"device_manufacturer"</span>: <span class="string">"LG"</span>, <span class="string">"device_name"</span>: <span class="string">"LG G8"</span>, <span class="string">"device_model"</span>: <span class="string">"LM-G820N"</span>, <span class="string">"device_os"</span>: <span class="string">"Android"</span>, <span class="string">"device_os_number"</span>: <span class="string">"8.0"</span>, <span class="string">"app_version"</span>: <span class="string">"v1.5.14(89)"</span>, <span class="string">"event"</span>: <span class="string">"post_detail_click"</span>, <span class="string">"interest_name"</span>: <span class="string">"공무원/임용"</span>, <span class="string">"interest_id"</span>: 160, <span class="string">"interest_service_name"</span>: <span class="string">"비밀모임"</span>, <span class="string">"interest_service_id"</span>: <span class="string">"1150"</span>, <span class="string">"interest_service_type"</span>: <span class="string">"비밀이에요"</span>, <span class="string">"user_id"</span>: <span class="string">"TuUDG1v9flu"</span>, <span class="string">"device_id"</span>: <span class="string">"NxFJR5dJ4xJOdDU"</span>, <span class="string">"create_at"</span>: <span class="string">"2019-07-27T11:39:28Z"</span>, <span class="string">"index"</span>: 261, <span class="string">"additional_field_0"</span>: <span class="string">"2MOio5dvxglawIdQR2OrgXy5VSEgYNH2KntJ62PWLFNGD otCoYKEpVgAB0xPELf4tEN15Gbfw3N4deUbKAOfPNCQhvbiYqtvvtD778Afzxwyj FS oFqreWEfiRyQqGdID8ZBrlNPzcxNcXnY EgTvOW3 DcCprS2Y6O0BDiNeghOsldm2qP9EDsc2 BIAOJ1uhLejxNX4Ohd8zkoM82s e6Gcb3PhDIYIUsqS6n2Q v7FYfrhxea1eDXFVblgOM0syYQrhgPYkLEFZgdWhepmL7kROd7go1cHTShGNOinl7iy32 gtKJ3ggBWywCutRsZvFzxBwiqaq5n6osCeH1Re329Cr8ks5TBtCLhKULyhYOSjOlizHCGLHT2XXnVyaoOjdSqJWXeVlM3krq3iCBjimPlgF1ct0HQbzLF2uZYzxq1NONkPKUQexRZSnd4AnLyBu06PpzuDuGL7KwpT36vdAmq0FHgYdEjnSu9o6lrK 7Y TPfNxpLfU439Bn5if"</span>, <span class="string">"additional_field_1"</span>: <span class="string">"Yn2qBnmhaN4rwMQjLFiEqMG6FsNnJztUngX2IGnT41w5fFj8YQRZp1oqD72xzuQ7K1tdLvvm7nk9JgQlKHfB6xSNPYOk1S5IBSlbdmyabPPiM5SjkQmBqRo9xmjisM2Mr6tT5aIgaIiHaIFvCQ975QvpNgs pDtMWLIsFXN3r5IU5bUL8w8LvLzBAe6SAEsq4KMPFoid77 UzA7q7EMkuZNYufWhHv3n8DyDVbHz0jOflU sh9HN1B45LmQz2ZS0xvHv4gigIUhNUmljrdbBk2VET6krkv2KJ9Zuc7O5WzdgpA1hjqCCz6qFVsv0Ah0Q7BBcrw99QiAJeRhIRUDWR8tdWtKiBZXWEXg2LopSjRGviJX5CNE BB2LHs4HQu2wIj3sgjpJhdZNTL2nzBBIZ70dRczdQicCSi2QnKqA7WSlAlpNL3hUMcCGAwn9HaNLEXfYojYS64OgpwhVaGcbe6iwMjsVKJMgc0SHfFShuodhBW9da8ckImcxhgCUCIv9i2NH"</span>, <span class="string">"additional_field_2"</span>: <span class="string">"xOtqQJRp8P5unnMAWpbfDlY6Wa2BneiEE8SNE3V2mfcs7h1P JHQSjFtSudF0fdVz EPjIpFGk9RjzAwOV27fwRpDSQgt8TqZGyvQcQRFY8SiXONrXqqab3u4A7ud2pLhHJWwoFqbm0vnkxGUIjy8tCeBTB8 fgLNjK9Uzfdp6Kjllr sXDCrcqcSn1cQkqh1XQaksq IqojN8cqaGDhJCu7Ze Z1LZCmT3w009aUUp0hi0I00MZ5purhbnudKe7uLV77lZuNme6ABGtTIWkQJyy6IVIl3ddvhfWX4Lvrozj2E5HfS9myZWjgA20ojI2s1Dw8Nu7pU1gvxaEeDtHgvEgFTtXCv9MfAxNDfDipZhZIXsSLHlTXPBSeJP06zTpYDMeLDfVaeCYauJF7y9DCQ2rZ3VGIlngpY0iwsCyBy0SheecC35B3ZFPYsmRb4fy56NVl6uiygnqK4slXROhPeyRWjj0plyS7M  kgpl4D8bBi2FaphHoag3YvEdZK414eG"</span>, <span class="string">"additional_field_3"</span>: <span class="string">"YuBo3Teu1Glp6xkAVWiTlGMVaWsFO6YvalGI4G4ZUIPaWg2SSj6U1DhGfC9Jx9HKbJNK L9dShaZ7y70HMe7ETPa4nW98rWRzK1Ok3KwLLT5Jx0mRImHiA kEiBXKudp Zcj9jT158VcR8OQa6pwzXhIr p6RD2HYpnxVMljIV 1g4n 3QWYdspCEyKrz7Y1T16miEGEdl5Er gtx6EXlvRmux3vrzG0OwAz4f4Tv3a6b5zYSIXySYa v2Fq09w7f3XV5N 6wnTmQduEg j5 lxTxextW8aPpb0WEnyy5nNmTgzLLUuClg05vSdoVWZpYYHzI3M19gP6Ab6 EATfswPZDsIZ49TLWckWjvL0fdAQpzIaTu JssJFgb1bkkZdQAjWj0RJRpzSlh ukYF6SdQ4ZtZyoa9TX5Th36U0KBA0ouhzexdA4pskKGjrVsTupy2aTHqAym49Cxu6kmjU9UclDe866DcxF2SOo6Q3TWIOPNxLEhIU"</span>, <span class="string">"additional_field_4"</span>: <span class="string">"ymm21n2ooni 6M8kTnFuMLo6zZN5lwRRJjDFiMy5aVxYCGJx0 AJICNql akN5dv TFQ TUNqSZsOi01fiBjNTJgUMI25aeKxRZHtPTzJ4xYoiFX OWGyVxjgxXnoxq81DGLjvJBcjEGzpMyzdoC2qt3FigIcekpMYH9yJNM3PlEQkBTpN9EBzQIk9czb6RrI5bJGxNWzCMyA2Y9XGjtwRijNxASKQ7S5z38CW43nCh05p7BIwu24Azl9X38umv6305MXDEUILXKbHYfi8GGuJTOLw3hbPaXdj1V5QGPoLs0ByHEFc 1JpZztWGpwEBugLYE9zb9GAF6q W7Uty7UawGV5fv 2fLYxVRayWpkA5MhBKdDTBoyOYxGA75fjlVvFqCqj3vcujGx962U51 7ohYjaBrSaaXlAtxjhPG79Vgc60KJpLIskPnUs0I43ook94gOu0ybdJPtqLkXZ4Wj6qIfPx7jSN2WtrbEnT1UO9NofxQdcHUQ"</span>, <span class="string">"additional_field_5"</span>: <span class="string">"1z0Hs3s6JlDxg1bCLgYr0oCDmPuAUyZTr fH3Qc1fxvJHal9CpURIK5UTtJGefaXmwkstJkdnPu88E62GIpbkwprmMSLkyzafJpucysjTKvrxPvkFcdn9BixsZEnyf9oqCgjuYe8eEtsQfzkaoR7pvhSXYzYdqmnkLBuSaJvS0 hrn6pEAevR3idQxGAjKYoZ5ghB4wtnJhVx7ZEc6n8apEP4SdOJ7MSGcqQneIgKyxuItOQtHv0hUtDeKJKjS5JFm4yQrIRoTPxJZLdf6J4Xk0oQpEVPeB2XiEGLdwzfN6gmEUKQiXaJ H8xDCkM DHqZUUHtNHKOTJTPE8ODcen84EU9O6LiSe3X4yBhYcc0Jq1t4ysDgIaRnJK HtdKUVE04sqZ9By2iN1jusi2Lah29KTnr3Kcr0cCDjFawkde5odnqPaF1H3k2ahh8QnT2lC03MTuA7Fduu9CAQf1AV4Dhq776ju4ZTdgqQRSxfT0POiKKSP9Gko9zBMwO"</span>, <span class="string">"additional_field_6"</span>: <span class="string">"2D t60yPIJJMuss8LgV5Ulrx7f0MhN4m3GlWvdmNtOb1bFUhDLmXLetZlOJo vWVAklfi89BodveM2Eh9ShR8qeNqynEf6rAZHBx7mRQUVQPZF3XBGOGvDll1EmPXQbxKj8SEXCnXXgVdAHgIgp3bOPXLpIk9Wjo6SG1Kpx0LNxo9O6So5VdXEV4sJ7uK2fTQqRdrfhXM 93H6iam4t NdTf229clhktZrsQus Y4ywXwGeVvAW13MjyPa76OjXE8xuK6fKFodPdVl6Qf9JUVDu8M vzG5J6F adcuScA8l12UMmW4uu24g65cFKMW6FvkUXiTXM30yrl5M5fR8sOtxEopbNVRJfsP0rtbh5CtWd2aB2qQf7ZdW0RME6X01Bu Guj7ezwO4LQkPvTHnQLYwzOi19 8NCwoI6yVb9TFG8ZM2wohjVnO74GIn2F5iNgwPgZGqyhvT0NEFQUsXsAAaXjukp93AnjEwclBcl15RYqXw6ZfdaXu7OhozGya0Aqd"</span>, <span class="string">"additional_field_7"</span>: <span class="string">"e7 GcLte3TYTXTZT4BLvys A2NhifV4wcGsH2lIJ2Py7LwXyoIXSl6LhZrsNVFMiQaKjrVohhkmVmMBHsRvH9j9xSbp6IAMC7BXWFxZqwnxW4TkziPVhgpQuAPoCSpAwwKB6OpNkF7IeJfjAWkyBwO4FSpqA2DZqPmIe8 Yc6VzI85TTT0ipBBKKYdKyiFIcLbWrQZvkonTqJfOZj4vF8dlmJzprah9FglZailFeATuTtlkGFCVHiEHpkgNRwEq5urAzbzcrKqkYFE2ROzj4BB 24jnFxgtNNfGgvP2BAu35SbXXiISZJXIQVtOhUjwWs BDyaLymU5Ul89 M XWcE7r1JJhsyMuj369PThJNbTe09BMM TgDkvWib8q75tFeCpvGiLxGqAXumS Y20f4mzT1nxFw4FwL9Ps9dQrj93umnPVrF7vU7s6NT3riNGMaYw15T3s45liL0pCLJ3n2i31qw67hK7wnSXerXBjJuJa1NtUIQ128I3XHyNZMRJgvB"</span>, <span class="string">"additional_field_8"</span>: <span class="string">"lNeVyBMz7pJMihLvVvgFfSsXEP6uLG4ktF2Z42KFfPF57rAv4mTy28PzIn93Jv91oW0npkY6cLm2cZdvehp0lB6qTP8vMlZQmjD227jxOYMqu0 plCvvOwEmDOu3pxVxF1ymJLPvw9UOkVQ0Vbs3fdasqD07iu9w7VgaBCkNzFQ3VNkNZl54pj7bUwQAHTIL3pFhAMcM5JmOFPAqlXdDCUEkdLx1EfbPjqbed1IOOY 4osp3GAzhKa13IqLVghCmEZRm30ta  wGpqgD9fKBlaU4dQofEsWVoxhII VKsDky5NQQhN2rDC7ul3p9pUj Oj7elr6eity4McRwoCytU4eDnSe NtXJ5CgaApBDz9Sjgr84AK1rDH6J7CdKu8dMET VmHP9 aWgypvd6q621Z4NilXrUOcQOClTm439aYA kyNLUcAg7kEQQXAAgsyWdUPNpDCf2WzmbjgtN8Hz17YVsEefH Lpu4JKjYtbgepfGfehaQ41eP66Ak8Y"</span>, <span class="string">"additional_field_9"</span>: <span class="string">"Xa4HsXcx7OxE2RCpLHlyJx8UI9p4Bg9eIXMKHnBbGNpddzOgAFlyiXNQDRIcest A821fmq7ZDq9Y X3KbuP1ASlXhA7etnCT1xQcOIaQnEjArvBOnL2zLmV2FC5vK3O2lBvBSW1ku80 qArwrwRg62PiH2PB5tLgQCOcKWmxUy3ag3S6Pt C1YGJdK OvRfTF0xXjXkAJnepoFH7IRD7xCGyljQWgLvIPnR3 NwEQXZTArvGObNp8vxdYIy6Cf1GhNtSVdrWvHaBUkCSTRMEyNPP3wUmHdQloEVoWKONMLMnWa71vMpli eH6Tg4tRZ9lufkcF6SyPJJfWTwgdWgoCZQY1uSCoEoccFM9BZL5ayuXA1xYnrf7xuzl9XMnjX Km02jlHG57NISRSrSzDlTo2TGPEsYm0kuhw17E1hTw2ia7rLhHM7uXK4njvz7WKRfymGcZQ7qnMTQWD4eicCZxW1vvopGNLdw7xlJBW6k2DxEOSPDRp1YipuC1vb"</span>&#125;</span><br><span class="line">&#123;<span class="string">"device_manufacturer"</span>: <span class="string">"LG"</span>, <span class="string">"device_name"</span>: <span class="string">"LG V50"</span>, <span class="string">"device_model"</span>: <span class="string">"LM-V500N"</span>, <span class="string">"device_os"</span>: <span class="string">"Android"</span>, <span class="string">"device_os_number"</span>: <span class="string">"9.0"</span>, <span class="string">"app_version"</span>: <span class="string">"v1.5.14(89)"</span>, <span class="string">"event"</span>: <span class="string">"post_like_click"</span>, <span class="string">"interest_name"</span>: <span class="string">"공인중개사"</span>, <span class="string">"interest_id"</span>: 170, <span class="string">"interest_service_name"</span>: <span class="string">"Q&amp;A"</span>, <span class="string">"interest_service_id"</span>: <span class="string">"1400"</span>, <span class="string">"interest_service_type"</span>: <span class="string">"물어봐요"</span>, <span class="string">"user_id"</span>: <span class="string">"AJRPcuKdCXTFfArv"</span>, <span class="string">"device_id"</span>: <span class="string">"Y0LVSMlL3kr3cPfvR"</span>, <span class="string">"create_at"</span>: <span class="string">"2019-07-27T12:05:28Z"</span>, <span class="string">"index"</span>: 913, <span class="string">"additional_field_0"</span>: <span class="string">"brLmDNsfTDNRw qSDnAIeipTpyjxPfhMpacsRONh98Ul44r7Kc3nxst7mhGMU Sq8hb4v4N06mGY16HJwJLESz47LrjIKb39Zt9eLfOwSzDh0ANBgM6pEftdBzjHvRJBQyNsIBIUrg9EnzQWQl2JRsSQHW6KGQb74KFLTagL7uzqKRjjluAWbWU6DnAgvxoUxfQ1sqxQPYP PTTksCsJ5vqwO ufaGVdfhI09pkqJmA0tcD GCLw7NqjSOsSYdJXTCtQXg42Gjo2C5H93FycBg3f3XqhFFpsfFhFIKDIF5RUJ3mB62w6 N3SqcJOAhG5qjDMtKq0htWTgSDbKDIE6MdzgxhB49ESrVBb9OuImKsEi9OLyEmOTgbUMeebIBGVyk854bv347u1 9U QTFpmq2hOfhF5jFw1DI1wgrEYuk6 nAmqvM0vXKOJ33pvqcrzmkeUgwxwTZ6mpkd3ABkeMGFzQFpM GWD4dTRER92j4EUN SxNdSfOH"</span>, <span class="string">"additional_field_1"</span>: <span class="string">"e2 QDdRCR6Gzu vMEWuwhAz7C3575YMcpHbgLn8pI5kN8802eKpsl3kJlHPhXbGt7umGyi8NTyl4dSjCqWBz9HGefG1SjRfjm3sfZzHVxLcxqckpU8OaipDTvOvRHu8hHA5K3a EfLxNPyTCz5zgYu5MeDKRTkJtF5xnJUxpJc3NqD5O8N4kFlBKoBw5eDDGYEbKq6SvlVlGhzguXQ0LAtGbnBpRqIwVxa9vEH7x f2LMJsgJHG3x0f3J2Ab8MS4g66AOciXkvzKP YASTEyT1LfMWsJwbEHLPzBmRYvVVKO0Rk1A3HD78TGI9Suyq9scw8Oc8BnGdcT6nllpSeYSKXDnqkFL2myHxE3zRFp9F6gR4JjJelSe339eRhKguA6BVN4TXRoyiUlIQe7zr0MLG4lT8AclGdJMt0Fgx9ZZPbcF2osl6JNkXkMERfZxwwOJyEUw4GF7vwi7TPJAWOQhVf1bgoIk05jH4fy31n0WFRjbwpssYsidRi60WWGMz0OLB "</span>, <span class="string">"additional_field_2"</span>: <span class="string">"cNKz Kq3NmIstx47T11pw6KjSfsRnnhXsHVY5RBxbk317DtoPzifwNGKHLPb0wylvmoDpaJYpRvv5uY02k429wj8jnJzfFQvDtulI0fNSJjc7VmLr9sxI2O8UwC2h0R4hp1DwRBn7GnY 07ridS5W5j0HNGAOzQpOzr WBmC5bqYTgAuFXQOh2hU2jhFp1eLZRGR0aeR715WYCeVb9jwlpev5OVPW3qmCDRgoXEuKmdWWYVwKQOL5RHfikj27Y77rSxXz6UJJ0nD3TrEClQaIRKk2UMbFHmzGmmh2CK62CxOVkMkcPcq7KWz XuKTAGPwV4hquBUCohLPpijyPtqNcQhyzGLtY55V5vrTMXoO8yVH8VoI2jmjmV6n3H5GJhUBg88PGfM0ggov5CdrvSZjPoKSScNkBVd6xPWh6gOwnTeD2AUEj0qS8IoAibJJMMG8kVNThpJn8Nj4esr8zMCRfiiAK79V0DVAYiPNQmJU0aIgtUNN4tvstRmYZWptdTDFs1"</span>, <span class="string">"additional_field_3"</span>: <span class="string">"oVapFNfWa1vxi1qx1aQeDEBTs FTSd0uXX8HuUYTWR1mK9L2sZwfYAxOR6fDZUgu7dfPTGfXmlgIFub2fKb6ltf9mikJgOLI3PbhPJOJWfxL7pRik5RJkubPJ03O21L5jz hyXrz1vx7AbkkXrKm Mo3Wcq86p0O0oDFS98qVkEaFjNNwHx2WcHpzAy8VMe86IiXvrY2UDau8LbpbEB2LDbNRCkPbaHgFtbKrSckdLbnonvOZ2qetWMTvXukF7xysvVcLVGvxIJbPVF1YN5fkMu4Jb0xtRw9BJjcALvvwZNj07aryHb1onSYupAiF2xF6whMmYYvldJj3aMLyJC8OvcwwRjOU1OMjbIjpAes Lo1lTsPxPQaQmlWpbPlMUuIYwDylXdJYjPr86fLSOW71UvjZIaLGUnQk9B8mkC3uOUmgYv7XTQhE6FX5g403SRfz4OTZfcwYPGF3A9KcNKbAp8C4svzil10YxOjaLj4F3Ohy39XNyKLP6TxVwgUC7"</span>, <span class="string">"additional_field_4"</span>: <span class="string">"9SvbTiU1w79vSlj4n4zWbUWVTy0jv7avO6Foxz7XppJzpdG2NqxK7 0BZs56Ak3OsQY68pzFxo5BDWmVi9KZqL28QgGNb3uESF3MUEFOhiij9QUPEH4WzBWZA6 nd9BAtgTZuGjbgEz0pc6 yjRmjliHh4sDopJQwJ9PGp3biiNvmq0tuwhoRq5HwZacO1OLjXMpT7LZiQyRSY9eV4KeNq1xPH283Uixu23EGZ7lywM5EKGhxvh48wcL0PvZOiw83MuaGXp2uC4vkHtCYa MqVcQFrCkGV3DHomVLI7LD0zA2JMxdOSaCARvJXYwWqaWkEofXx3gChmxljbJ3TJv jF82m9EMgvFKv8ZUXkC4zUWcw2FFc5Mv9VI11aq CijWAQQlHvS7QjNmsMFj QpXNm8xwRE rnzZqjgHIwia4OaXgU9yh1pJh1wgJ6YhSEF5SZ81Zacj9nPa eCKGXBkYsBDauN7 NS3ugkJfNtysXeuITSfDrz3ud3529T"</span>, <span class="string">"additional_field_5"</span>: <span class="string">"NLp3l5e25iSBwHThwtPImxHC6OEnSPsddR7tiAYIgdU9xX87jwQEcZazDVeuI8l0RwGoTJ6Ee9oJx9ZtJIB5sNMsrWPb3NaeS2lqpEXskWwl9q6ePVyP2bxe5xe3mcM4ndr7O8wqVdHlergZeLuFNDd1MRcFwq08PYvjFf9Y8gIsTjgF8ZQTcWO9u4QwlnmIRGbxav6Cv5jFhxJ9KA6wx sFRayN6ljARzWQuYQCpua1V9C6NuwOIu88JuXt5OSGwMmI5b9Km 0OPmnEq1uyPu2ACsxQrjPpR7gyyU5f K zKWCv8wzP7t5aRJg27vN3Qv81MugBa0EFM0vJ6PcvFUb57aIgzahy49V3Xk7cNa6FMHHEjOcpsySZriiUVonDHCVmYCcYWM41mAbOt344Xrhbmu2nL7YY3xCMCUEoXursFZh3gsdiILvSETZRRfK6n07a03scau 5Vw0thyhQmXbSkHlYEwTWB6HvdT8EdhE1AyhcbHAx3dde4coOCwZgP"</span>, <span class="string">"additional_field_6"</span>: <span class="string">"1SOS74N rcJ7ZHy1t6Nbp9LmKWm6FRscGy07LYuM5xBnVwsuZYAypuMEvCjG7nOhzAmz e61pxUFIoejcb1h7nu8DertzzknvlP3nrBr1fu3j0EFOBxdTYwNd2 seRdkgMuAgFhyHN9ys52G4T3EID1zMG8MNcFxc2iKguyJwwBQQPysI rzeSevK4fUFILODNj7a9PgTsx5ByCbR5mcqu4XreiDKOlXjcUe7ghseANxSuSEMZyCB6rlHx2XMyknEnSGQX2j9h6JHJXwifcwX424oL5lUN1PwtY sIQd1XQhExTvUEif7PLpnBTt3RiXqOoonqN40I05OnfXQcOpjUac2CSUK9qEwhH6TVT022UejT6xopYdb8PzaWjW zsozhRCFjfOa4H9DSMcmzHeQM N qANizOrxnbi9UARar0HQEjufmAeuHqfSvKCQfZQijjVD3sUANjy66mTr3opLkOU1pML82bZmeeJQOpBFHJT6sp kX512OFIjWTFDZUX"</span>, <span class="string">"additional_field_7"</span>: <span class="string">"FQZ4Azv3XjGy iVL2MN8ILX3DSZvCoozkJQvb tpiUHXYmLbf8fjou0FeVkfr6uSLwdnrNMVUwSMNPgwidBK7mpzFSYldlK813flgOfR341PI28EvKAMeNHWoqbZyfoH2BsCpKNSufFaEohsfrnOXwsYOcTNouizfKWCyxz8eeuSQCB4UnwNCK mUYJxR0ifGfxrzun5ywWvzVHuuMy6gEm112fAROpFmHBOuoLWIkrM99fXNdRx2TSNeFgJ8TvirZtpv2rfIS9rpnbX3Tl7H ASERfUgOkhN4tkz3fepM2bJp0JOQpc8BAaVERt9pZgDfwrlKn3NtsYW5QFxWCpMPFnoBLpql9e61Pkl8hplvFvMUCPL3CVfTUZTRIK3l1v7f5SERIU1HR5fGhewqQStdf4eTI5djTfRf6lhFwpno97ejSBTpnVpa2dxmgvVkFaOqyNaTPSR7XHGa8rl TvwLfkpwFu6LCKlH7Cacy81xKJKsRSSfRVVTZOkKmt"</span>, <span class="string">"additional_field_8"</span>: <span class="string">"zAnFflDq mwKlR01r7N3J2DnwKiKYXwQlu0TJiuuZAqS hD5Zv4P5gOveNPkMGTIBdiqjvLhw sPz8Oa2FcDWucIYYsI410VXWEyVSlGUzPiFZ047Eh M2UKSvtBfM0EUHScU7At8 9jWZzsbiUzIh7gxHq4SAB8FGZZZsNqkJbKAulomuaNuMQcJSpf4IDdddjOEcMFvcu9RpnjwvSaSBiKz9JqTs2RI4rRlu9nJzahuXRJSmlnu1FzH4V4B7j9NGE6Ov8mKYKagisGr9j9 1DxyrrE7SKry1 OjBiIV8vqxafQuFJn19iQYxPxgfRXYRfVbURUCJcKrjxyUwAl1JKAU3 45l2shYg62r82HgHh 3KhU7XQLNSRMT6Ad2XC5rQzaksqr0sXdnm5akvwhBJxptZSdO1iomsmdWLOXIoNjx0LyYqTeyRtcI otvaLYgEbOGdZ09B01fINWSDAR7Kciesu0CmvZWKK6dRq7JcclR1iDfAZR9Fi"</span>, <span class="string">"additional_field_9"</span>: <span class="string">"JWt0Up3iWSNRGSoGbKeS9pM4oeKvEtP5xCC7 XcY8wLcYjpffL5OXA32Qxk3Zn0tdKFeK3mc5FdqwDRzgfN5T1H z8cXJ4Jnif6rxylghVVZl8n5UKTCFo2IwzjSpIcRXsKO4OxG7zCRe9okbShqgaCK27s5OtYPGjYtyXpFE7VWaZQlXM3YmNVnSr99gMAPPbIfhH6JIGwebky0nhctJZ38No6DQaqwhELbbC61GfOuc0ghxl1VTig4AqaulouGID8d1e SXgtVxQjlHXXWeHQql5hypJpbnqXM3AbL0aCF6beio1tXfcc7xBxptjJnfPfqff1GQpXUmpRf5tQhJ5qcVH eH6zbTQ89xPHKKX82mEmknkb3td669tfTiLiRDBa4aGMEcYoM1M9bnHa8o8fXSvBxZa8QXzG7IZwk9xVLQrQ2kpvRIKnqc2KyxfcKV2EWqmvs3qbAWrJ48235bV302cCDw7FY6dno44abeZ3gM62XuhzRp"</span>&#125;</span><br></pre></td></tr></table></figure>

<p>main.py를 실행하여 데이터 레코드를 전송한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ python3 main.py</span><br><span class="line">[1571108232.0, 1571108233.0, 1571108234.0, 1571108235.0, 1571108236.0, 1571108237.0, 1571108238.0, 1571108239.0, 1571108240.0, 1571108241.0, 1571108242.0, 1571108243.0, 1571108244.0, 1571108245.0, 1571108246.0, 1571108247.0, 1571108248.0, 1571108249.0, 1571108250.0, 1571108251.0, 1571108252.0, 1571108253.0, 1571108254.0, 1571108255.0, 1571108256.0, 1571108257.0, 1571108258.0, 1571108259.0, 1571108260.0, 1571108261.0, 1571108262.0, 1571108263.0, 1571108264.0, 1571108265.0, 1571108266.0, 1571108267.0, 1571108268.0, 1571108269.0, 1571108270.0, 1571108271.0, 1571108272.0, 1571108273.0, 1571108274.0, 1571108275.0, 1571108276.0, 1571108277.0, 1571108278.0, 1571108279.0, 1571108280.0, 1571108281.0, 1571108282.0, 1571108283.0, 1571108284.0, 1571108285.0, 1571108286.0, 1571108287.0, 1571108288.0, 1571108289.0, 1571108290.0, 1571108291.0]</span><br></pre></td></tr></table></figure>

<p>3개 프로세스의 데이터 레코드 전송과 관련하여 정리하면 다음과 같다.</p>
<ul>
<li>매초마다 전송하는 데이터 레코드<ul>
<li>300개/초 전송 (100개 * 3개 프로세스)</li>
<li>1751121 바이트/초 전송 ((583807 - 100) 바이트 * 3개 프로세스, 줄바꿈 ‘\n’ 100바이트는 제외하여 계산)</li>
</ul>
</li>
<li>60초동안 전송하는 데이터 레코드와 관련하여 정리하면 다음과 같다.<ul>
<li>18000개 데이터 레코드 (300개 * 60초)</li>
<li>105067260 바이트 (1751121바이트 * 60초)</li>
</ul>
</li>
</ul>
<p>각각 프로세스가 전송한 결과를 확인하면 다음과 같다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ cat response_result_0.log</span><br><span class="line">process id : 27681</span><br><span class="line">      1571108232.000 	                0.341 	   100 	     0 </span><br><span class="line">      1571108233.000 	                0.148 	   100 	     0 </span><br><span class="line">      1571108234.000 	                0.135 	   100 	     0 </span><br><span class="line">      1571108235.000 	                0.162 	    50 	    50 </span><br><span class="line"></span><br><span class="line">... 중략 ...</span><br><span class="line"></span><br><span class="line">      1571108288.000 	                0.478 	   100 	     0 </span><br><span class="line">      1571108289.000 	                0.342 	    25 	    75 </span><br><span class="line">      1571108290.000 	                0.356 	    50 	    50 </span><br><span class="line">      1571108291.000 	                0.215 	   100 	     0 </span><br><span class="line">total_sucsess_count : 4575 	 total_fail_count : 1425</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ cat response_result_1.log</span><br><span class="line">process id : 27682</span><br><span class="line">      1571108232.000 	                2.271 	    50 	    50 </span><br><span class="line">      1571108234.271 	                0.187 	    50 	    50 </span><br><span class="line">      1571108234.458 	                0.091 	    25 	    75 </span><br><span class="line">      1571108235.000 	                0.118 	     0 	   100 </span><br><span class="line"></span><br><span class="line">... 중략 ...</span><br><span class="line"></span><br><span class="line">      1571108288.000 	                0.393 	   100 	     0 </span><br><span class="line">      1571108289.000 	                0.117 	     0 	   100 </span><br><span class="line">      1571108290.000 	                0.083 	     6 	    94 </span><br><span class="line">      1571108291.000 	                0.116 	    50 	    50 </span><br><span class="line">total_sucsess_count : 1666 	 total_fail_count : 4334</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ cat response_result_2.log</span><br><span class="line">process id : 27685</span><br><span class="line">      1571108232.000 	                0.463 	   100 	     0 </span><br><span class="line">      1571108233.000 	                0.082 	   100 	     0 </span><br><span class="line">      1571108234.000 	                0.159 	   100 	     0 </span><br><span class="line">      1571108235.000 	                0.137 	   100 	     0 </span><br><span class="line"></span><br><span class="line">... 중략 ...</span><br><span class="line"></span><br><span class="line">      1571108288.000 	                0.156 	   100 	     0 </span><br><span class="line">      1571108289.000 	                0.211 	   100 	     0 </span><br><span class="line">      1571108290.000 	                0.178 	    50 	    50 </span><br><span class="line">      1571108291.000 	                0.193 	   100 	     0 </span><br><span class="line">total_sucsess_count : 4578 	 total_fail_count : 1422</span><br></pre></td></tr></table></figure>

<p>18000개 데이터 레코드 전송과 관련하여 전송 성공/실패한 결과를 정리하면 다음과 같다.</p>
<p><strong>데이터 레코드 전송, 실패</strong></p>
<ul>
<li>전송 성공<ul>
<li>총 10819 개 (4575 + 1666 + 4578)</li>
<li>평균 180.3167개 / 초,</li>
<li>(추정치) 평균 약 1.0MB/초 (1052521 바이트/초)</li>
</ul>
</li>
<li>전송 실패<ul>
<li>총 7181 개 (1425 + 4334 + 1422)</li>
<li>평균 119.683개 / 초</li>
<li>(추정치) 평균 약 0.6MB/초 (698598 바이트/초)</li>
</ul>
</li>
</ul>
<p>Destination(es, s3)에 데이터 레코드가 저장 되었는지 확인한다.<br>es에는 10819개의 Document가 생성되었다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ curl -XGET https://search-kevin-es-test-dtdgdko7cas7f6umwhssry2koq.ap-northeast-2.es.amazonaws.com/kevin_shard_per_limit/_count</span><br><span class="line">&#123;<span class="string">"count"</span>:10819,<span class="string">"_shards"</span>:&#123;<span class="string">"total"</span>:5,<span class="string">"successful"</span>:5,<span class="string">"skipped"</span>:0,<span class="string">"failed"</span>:0&#125;&#125;%</span><br></pre></td></tr></table></figure>

<p>S3에 총 60.2MB 크기를 갖는 파일들이 생성되었다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ aws s3 ls s3://kevin-bucket-test --recursive</span><br><span class="line">2019-10-15 11:57:13    1050614 2019/10/15/02/kevin-shard-per-limit-1-2019-10-15-02-57-12-1e0b3f2f-ad22-4f26-9d0c-5741f96178da</span><br><span class="line">2019-10-15 11:57:14    1050797 2019/10/15/02/kevin-shard-per-limit-1-2019-10-15-02-57-12-9139e196-5b5b-4ed0-9b69-d92d9fc3ad08</span><br><span class="line">2019-10-15 11:57:15    1050691 2019/10/15/02/kevin-shard-per-limit-1-2019-10-15-02-57-13-f0395a0b-5c64-4678-9584-6708ddda5987</span><br><span class="line"></span><br><span class="line">... 중략 ...</span><br><span class="line"></span><br><span class="line">2019-10-15 11:58:12    1050966 2019/10/15/02/kevin-shard-per-limit-1-2019-10-15-02-58-09-4e6995a7-be7d-42ba-9bc3-fa554280f01e</span><br><span class="line">2019-10-15 11:58:13    1050674 2019/10/15/02/kevin-shard-per-limit-1-2019-10-15-02-58-11-9766d09a-25d4-4dc7-8c69-7d8a5db52d73</span><br><span class="line">2019-10-15 11:59:14     110940 2019/10/15/02/kevin-shard-per-limit-1-2019-10-15-02-58-11-c8ed5eb6-3a00-4d25-b2b8-49930407983b</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>“전송 성공한 데이터 레코드가 S3에 저장되었다”고 추정</strong></p>
<p>s3 버킷에는 60.2MB(63156884바이트)가 저장 된 것을 알 수 있다.<br>“S3에 저장된 파일들의 내용”과 “전송 성공한 데이터 레코드”를 일일이 대조한다면 “전송 성공한 데이터 레코드가 S3에 저장되었다”고 확정할 수 있다.<br>하지만 많은 시간이 소요될 것이라 판단되어 “전송 성공한 데이터 레코드가 S3에 저장되었다” 추정하는 것으로 마무리 짓는다.</p>
<p>전송 성공하였을 것이라 추정되는 데이터 레코드 크기는 약 60.2MB (약 63151260 바이트)이다.</p>
<ul>
<li>1751121 바이트 * 60초 * (10819개 / 18000개) =   105067260 * 0.601055555555556 = 약 63151260 바이트</li>
</ul>
<p>S3에 저장된 파일들의 크기의 합은 60.2MB (63156884 바이트) 이다.</p>
<p>따라서 전송 성공한 데이터 레코드는 S3에 저장되었다는 것으로 추정할 수 있다.</p>
</blockquote>
<p>테스트 결과를 정리하면 다음과 같다.</p>
<ul>
<li>60초동안 초당 1.6MB의 데이터 레코드를 전송한 결과,  개발자 안내서에서 제시한 제약조건과 유사하다는 것을 알 수 있다.<ul>
<li>전송 성공은 1.0MB/초</li>
<li>전송 실패는 0.6MB/초</li>
</ul>
</li>
<li>전송 성공한 데이터 레코드 10819개는 Amazon es는 저장되었고, S3에는 저장된 것으로 추정한다.</li>
</ul>
<hr>
<h1 id="테스트-결과"><a href="#테스트-결과" class="headerlink" title="테스트 결과"></a>테스트 결과</h1><p>테스트 결과를 정리하면 다음과 같다.</p>
<blockquote>
<ul>
<li><p>샤드 제약조건(샤드당 쓰기 1000레코드/초, 1MB/초)과 유사한 데이터 레코드는 Data steam에 전송되고 나머지 데이터 레코드는 저장되지 않는다.</p>
</li>
<li><p>전송 성공한 데이터 레코드에 대하여 Amazon es에 저장되는 것을 확인하였고, S3에는 저장되는 것으로 추정된다.</p>
</li>
</ul>
<p>따라서 Data stream의 샤드 개수를 고려하여 샤드 1개당 1MB/초 미만, 1000개/초 미만이 되는 데이터 레코드를 전송하는 것을 권장한다.</p>
</blockquote>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/Kinesis-Data-Stream/" rel="tag">Kinesis Data Stream</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2019/10/29/pytest-%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%AC-%EA%B8%B0%EC%B4%88-%ED%95%99%EC%8A%B5/"
                    data-tooltip="pytest 프레임워크 기초 학습"
                    aria-label="PREVIOUS: pytest 프레임워크 기초 학습"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2019/09/19/Fluentd-%EA%B8%B0%EC%B4%88-%EC%82%AC%EC%9A%A9%EB%B2%95-%EC%8B%A4%ED%96%89-%EC%A2%85%EB%A3%8C-%EB%93%B1/"
                    data-tooltip="Fluentd 기초 사용법(실행, 종료 등)"
                    aria-label="NEXT: Fluentd 기초 사용법(실행, 종료 등)"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://usehun0625.github.io/2019/10/16/Kinesis-Data-Stream-%EC%83%A4%EB%93%9C%EB%8B%B9-%EC%A0%9C%EC%95%BD-%EC%A1%B0%EA%B1%B4-%ED%99%95%EC%9D%B8/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=http://usehun0625.github.io/2019/10/16/Kinesis-Data-Stream-%EC%83%A4%EB%93%9C%EB%8B%B9-%EC%A0%9C%EC%95%BD-%EC%A1%B0%EA%B1%B4-%ED%99%95%EC%9D%B8/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=http://usehun0625.github.io/2019/10/16/Kinesis-Data-Stream-%EC%83%A4%EB%93%9C%EB%8B%B9-%EC%A0%9C%EC%95%BD-%EC%A1%B0%EA%B1%B4-%ED%99%95%EC%9D%B8/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#disqus_thread"
                        aria-label="Leave a comment"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="Table of Contents">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
                <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript>
</div>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2020 Kevin. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2019/10/29/pytest-%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%AC-%EA%B8%B0%EC%B4%88-%ED%95%99%EC%8A%B5/"
                    data-tooltip="pytest 프레임워크 기초 학습"
                    aria-label="PREVIOUS: pytest 프레임워크 기초 학습"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2019/09/19/Fluentd-%EA%B8%B0%EC%B4%88-%EC%82%AC%EC%9A%A9%EB%B2%95-%EC%8B%A4%ED%96%89-%EC%A2%85%EB%A3%8C-%EB%93%B1/"
                    data-tooltip="Fluentd 기초 사용법(실행, 종료 등)"
                    aria-label="NEXT: Fluentd 기초 사용법(실행, 종료 등)"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://usehun0625.github.io/2019/10/16/Kinesis-Data-Stream-%EC%83%A4%EB%93%9C%EB%8B%B9-%EC%A0%9C%EC%95%BD-%EC%A1%B0%EA%B1%B4-%ED%99%95%EC%9D%B8/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=http://usehun0625.github.io/2019/10/16/Kinesis-Data-Stream-%EC%83%A4%EB%93%9C%EB%8B%B9-%EC%A0%9C%EC%95%BD-%EC%A1%B0%EA%B1%B4-%ED%99%95%EC%9D%B8/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=http://usehun0625.github.io/2019/10/16/Kinesis-Data-Stream-%EC%83%A4%EB%93%9C%EB%8B%B9-%EC%A0%9C%EC%95%BD-%EC%A1%B0%EA%B1%B4-%ED%99%95%EC%9D%B8/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#disqus_thread"
                        aria-label="Leave a comment"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="Table of Contents">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="5">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=http://usehun0625.github.io/2019/10/16/Kinesis-Data-Stream-%EC%83%A4%EB%93%9C%EB%8B%B9-%EC%A0%9C%EC%95%BD-%EC%A1%B0%EA%B1%B4-%ED%99%95%EC%9D%B8/"
                        aria-label="Share on Facebook"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=http://usehun0625.github.io/2019/10/16/Kinesis-Data-Stream-%EC%83%A4%EB%93%9C%EB%8B%B9-%EC%A0%9C%EC%95%BD-%EC%A1%B0%EA%B1%B4-%ED%99%95%EC%9D%B8/"
                        aria-label="Share on Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://plus.google.com/share?url=http://usehun0625.github.io/2019/10/16/Kinesis-Data-Stream-%EC%83%A4%EB%93%9C%EB%8B%B9-%EC%A0%9C%EC%95%BD-%EC%A1%B0%EA%B1%B4-%ED%99%95%EC%9D%B8/"
                        aria-label="Share on Google+"
                    >
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Share on Google+</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/beer.jpg" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">Kevin</h4>
        
            <div id="about-card-bio"><p>Kevin, 이용훈<br>어릴 때부터 코딩에 흥미를 가지고 살아왔습니다. 새로운 기술도 열정적으로 받아들이며 더 좋은 개발을 위하여 학습하고 경험하고 노력하고 있습니다.</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Developer, DE</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                서울 / 대한민국
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/curtain.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/jquery.js"></script>


<script src="/assets/js/jquery.fancybox.js"></script>


<script src="/assets/js/thumbs.js"></script>


<script src="/assets/js/tranquilpeak.js"></script>

<!--SCRIPTS END-->


    
        <script>
          var disqus_config = function() {
            this.page.url = 'http://usehun0625.github.io/2019/10/16/Kinesis-Data-Stream-%EC%83%A4%EB%93%9C%EB%8B%B9-%EC%A0%9C%EC%95%BD-%EC%A1%B0%EA%B1%B4-%ED%99%95%EC%9D%B8/';
              
            this.page.identifier = '2019/10/16/Kinesis-Data-Stream-샤드당-제약-조건-확인/';
              
          };
          (function() {
            var d = document, s = d.createElement('script');
            var disqus_shortname = 'usehun0625';
            s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
          })();
        </script>
    




    </body>
</html>
