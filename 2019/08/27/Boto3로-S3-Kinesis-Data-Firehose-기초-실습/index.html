
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Kevin의 블로그">
    <title>Boto3로 S3, Kinesis Data Firehose 기초 실습 - Kevin의 블로그</title>
    <meta name="author" content="Kevin">
    
    
        <link rel="icon" href="http://usehun0625.github.io/assets/images/beer_favaicon.png">
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Kevin","sameAs":["https://github.com/usehun0625/","mailto:usehun0625@gmail.com"],"image":"beer.jpg"},"articleBody":"\n\nBoto3를 이용하여 다음과 같은 AWS 서비스를 사용하는 방법(기초)을 정리한다.\n\nAmazon S3\nKinesis Data Firehose\n\n\n\n환경테스트 환경은 다음과 같다.\n\nOS : macOS mojave 10.14.6\nPython 버전 : 3.7.3\nBoto3 버전 : 1.9.215\nAWS CLI 버전 정보\naws-cli : 1.16.222 \nPython : 2.7.16 \nDarwin : 18.7.0 \nbotocore : 1.12.212\nTree 버전 : 1.8.0\n\n\n\n환경 구성 및 AWS CLI 사용법테스트 환경 구성 방법virtual env로 환경을 구성한다.\n12345678$ virtualenv .venvUsing base prefix '/usr/local/Cellar/python/3.7.3/Frameworks/Python.framework/Versions/3.7'New python executable in /Users/kevin/dev/boto3_test/amazon_s3/.venv/bin/python3.7Also creating executable in /Users/kevin/dev/boto3_test/amazon_s3/.venv/bin/pythonInstalling setuptools, pip, wheel... ``` virtual env 활성화후 boto3 설치\n$ source .venv/bin/activate$ pip3 install boto3\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101## AWS CLI 사용법다음 링크를 참고한다.* https:&#x2F;&#x2F;docs.aws.amazon.com&#x2F;ko_kr&#x2F;cli&#x2F;latest&#x2F;userguide&#x2F;install-macos.html* https:&#x2F;&#x2F;docs.aws.amazon.com&#x2F;ko_kr&#x2F;cli&#x2F;latest&#x2F;userguide&#x2F;cli-services-s3.html # Boto3로 AWS S3 실습## S3 클라이언트 인스턴스 할당아래와 같은 함수를 이용하여 S3에&#96;&#96;&#96;bashimport boto3def get_s3():    # aws profile    session &#x3D; boto3.Session(profile_name&#x3D;&quot;profile_kevin&quot;)    s3 &#x3D; session.resource(&#39;s3&#39;)    return s3 &#96;&#96;&#96; ## 로컬 파일을 S3에 업로드 하기다음과 같은 시나리오를 바탕으로 테스트를 진행한다.1. 로컬 파일을 생성한다.2. 생성된 로컬 파일을 s3:&#x2F;&#x2F;boto3_test&#x2F;kevin-boto3-test&#x2F; 경로에 업로드 한다. 다음과 같이 Python 코드를 작성하고 실행한다.&#96;&#96;&#96;bashimport boto3def get_s3():    session &#x3D; boto3.Session(profile_name&#x3D;&quot;profile_kevin&quot;)    s3 &#x3D; session.resource(&#39;s3&#39;)    return s3def make_file(path&#x3D;&quot;.&#x2F;boto3_file_upload_test.txt&quot;):    with open(path, &quot;w&quot;) as wf:        wf.write(&quot;This file boto3 file upload test !!!!&quot;)def main():    # make file    file_path &#x3D; &quot;.&#x2F;boto3_file_upload_test.txt&quot;    make_file(file_path)    # upload s3    s3 &#x3D; get_s3()    bucket &#x3D; s3.Bucket(&#39;boto3_test&#39;)    bucket.upload_file(        file_path, &#39;kevin-boto3-test&#x2F;boto3_file_upload_test.txt&#39;)if __name__ &#x3D;&#x3D; &quot;__main__&quot;:    main()&#96;&#96;&#96; 생성한 로컬 파일이 s3에 업로드 되었는지 확인한다. 이상없이 파일 업도드 된 것을 확인할 수 있다.&#96;&#96;&#96;bash$ aws s3 ls s3:&#x2F;&#x2F;boto3_test&#x2F;kevin-boto3-test&#x2F;2019-08-23 14:39:54          02019-08-23 14:45:08         37 boto3_file_upload_test.txt&#96;&#96;&#96;  ## S3에서 로컬로 파일 다운로드하기다음과 같은 시나리오를 바탕으로 테스트를 진행한다.1. s3:&#x2F;&#x2F;boto3_test&#x2F;kevin-boto3-test&#x2F;boto3_file_upload.txt 파일을 로컬로 다운로드 한다. 다음과 같이 Python코드를 작성하고 실행한다.&#96;&#96;&#96;bashimport boto3def get_s3():    # aws profile    session &#x3D; boto3.Session(profile_name&#x3D;&quot;profile_kevin&quot;)    s3 &#x3D; session.resource(&#39;s3&#39;)    return s3def main():    download_file_path &#x3D; &quot;.&#x2F;boto3_file_upload_test2.txt&quot;    # download s3    s3 &#x3D; get_s3()    bucket &#x3D; s3.Bucket(&#39;boto3_test&#39;)    bucket.download_file(        &#39;kevin-boto3-test&#x2F;boto3_file_upload_test.txt&#39;, download_file_path)if __name__ &#x3D;&#x3D; &quot;__main__&quot;:    main()&#96;&#96;&#96; 다운로드한 파일을 확인하면 다음과 같다.&#96;&#96;&#96;bash$ cat boto3_file_upload_test2.txtThis file boto3 file upload test !!!!%\n\n결과는 다음과 정리할 수 있다.\n\nBoto3를 이용하여 S3의 업로드된 파일을 다운로드한다.\n커널 명령을 통해 실제로 S3에서 파일이 다운로드 된 것을 확인할 수 있다.\n\nS3의 파일 삭제하기다음과 같은 시나리오를 바탕으로 테스트를 진행한다.\n\ns3://boto3_test/kevin-boto3-test/boto3_file_upload.txt 파일을 삭제한다.\n다음과 같이 Python코드를 작성하고 실행한다.\n1234567891011121314151617181920212223import boto3def get_s3():    # aws profile    session = boto3.Session(profile_name=\"profile_kevin\")    s3 = session.resource('s3')    return s3def main():    # delete s3    s3 = get_s3()    bucket = s3.Bucket('boto3_test')    obj = bucket.Object('kevin-boto3-test/boto3_file_upload_test.txt')    obj.delete()if __name__ == \"__main__\":    main()``` 삭제 되었는지 확인한다. 에러없이 삭제 된 것을 알 수 있다.```bash$ aws s3 ls s3://boto3_test/kevin-boto3-test/2019-08-23 14:39:54          0\n\n\n\n결과는 다음과 정리할 수 있다.\n\nBoto3를 이용하여 S3의 업로드된 파일을 삭제한다.\nAWS CLI를 통해 실제로 S3에서 파일이 삭제 된 것을 확인할 수 있었다\n\nS3 디렉터리 다운로드 하기다음과 같은 시나리오를 바탕으로 트를 진행한다.\n\n위의 S3 경로 s3://boto3_test/kevin-boto3-test/download_test_directory 디렉터리(빈 디렉터리는 제외)를 로컬로 다운로드한다.\n\n다운로드 할 파일을 확인하면 다음과 같다.\n123456789$ aws s3 ls s3://boto3_test/kevin-boto3-test/download_test_directory --recursive2019-08-26 19:07:16         39 kevin-boto3-test/download_test_directory/dir1/dir1_1/dir1_1_file1.txt2019-08-26 19:07:17         39 kevin-boto3-test/download_test_directory/dir1/dir1_1/dir1_1_file2.txt2019-08-26 19:07:15         39 kevin-boto3-test/download_test_directory/dir1/dir1_file1.txt2019-08-26 19:07:14         39 kevin-boto3-test/download_test_directory/dir2/dir2_file1.txt2019-08-26 19:07:14         39 kevin-boto3-test/download_test_directory/dir2/dir2_file2.txt2019-08-26 19:08:10          0 kevin-boto3-test/download_test_directory/dir3/2019-08-26 19:07:13         39 kevin-boto3-test/download_test_directory/file1.txt2019-08-26 19:07:13         39 kevin-boto3-test/download_test_directory/file2.txt\n\n다음과 같은 Python 코드를 작성하고 실행한다.\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061import boto3import osdef get_s3():    session = boto3.Session(profile_name=\"profile_kevin\")    s3 = session.resource('s3')    return s3def download_directory_to_s3(s3_dir_path, local_dir_path):    s3 = get_s3()    bucket = s3.Bucket('boto3_test')    path_list = list()    for obj in bucket.objects.filter(Prefix=s3_dir_path):        s3_path = obj.key        local_path = s3_path.replace(s3_dir_path, local_dir_path)        if s3_path[-1] == '/':            continue        dir_name = os.path.dirname(local_path)        if not os.path.exists(dir_name):            print(\"make directory &#123;&#125;\".format(dir_name))            os.makedirs(dir_name)        path_list.append([s3_path, local_path])    for path in path_list:        print(\"Download from &#123;&#125; to &#123;&#125;\".format(path[0], path[1]))        bucket.download_file(path[0], path[1])def main():    parameter = &#123;\"s3_dir_path\": \"kevin-boto3-test/download_test_directory/\",                 \"local_dir_path\": \"./download_test_directory/\",                 &#125;    download_directory_to_s3(**parameter)if __name__ == \"__main__\":    main()``` 디렉터리가 정상적으로 다운로드 되었는지 확인한다.```bash$ tree download_test_directorydownload_test_directory├── dir1│   ├── dir1_1│   │   ├── dir1_1_file1.txt│   │   └── dir1_1_file2.txt│   └── dir1_file1.txt├── dir2│   ├── dir2_file1.txt│   └── dir2_file2.txt├── file1.txt└── file2.txt3 directories, 7 files\n\n결과는 다음과 같이 정리할 수 있다.\n\nBoto3를 이용하여 S3의 업로드된 디렉터리를 로컬로 다운로드한다. (빈 디렉터리는 제외)\n커널 명령을 통해 실제로 S3에서 로컬로 디렉터리가 다운로드 된 것을 확인할 수 있다.\n\n로컬 디렉터리를 S3에 업로드 하기다음과 같은 시나리오를 바탕으로 테스트를 진행한다.\n\n로컬 디렉터리(빈 디렉터리는 제외)를 s3 경로 s3://boto3_test/kevin-boto3-test/upload_test_directory에 업로드 한다.\n\n업로드할 디렉터리는 다음과 같은 구조로 이루어져 있다.\n12345678910111213$ tree upload_test_directoryupload_test_directory├── dir1│   ├── dir1_1│   │   ├── dir1_1_file1.txt│   │   └── dir1_1_file2.txt│   └── dir1_file1.txt├── dir2│   ├── dir2_file1.txt│   └── dir2_file2.txt├── dir3├── file1.txt└── file2.txt\n\n다음과 같은 Python 코드를 작성하고 실행한다.\n12345678910111213141516171819202122232425262728293031323334353637import boto3import osdef get_s3():    session = boto3.Session(profile_name=\"profile_kevin\")    s3 = session.resource('s3')    return s3def upload_directory_to_s3(local_dir_path, s3_dir_path):    path_list = list()    for path, sub_dirs, files in os.walk(local_dir_path):        for filename in files:            local_file_path = os.path.join(path, filename)            s3_file_path_depart = [s3_dir_path,                                   os.path.relpath(local_file_path, local_dir_path)]            s3_file_path = \"\".join(s3_file_path_depart)            path_list.append([local_file_path, s3_file_path])    s3 = get_s3()    bucket = s3.Bucket('boto3_test')    for paths in path_list:        print(\"upload from &#123;&#125; to &#123;&#125;\".format(paths[0], paths[1]))        bucket.upload_file(paths[0], paths[1])def main():    parameter = &#123;\"local_dir_path\": \"./upload_test_directory/\",                 \"s3_dir_path\": \"kevin-boto3-test/upload_test_directory/\"&#125;    upload_directory_to_s3(**parameter)if __name__ == \"__main__\":    main()\n\n위의 소스 코드중 os 모듈을 사용하는 부분이 있어 아래와 같이 정리한다.\n\nos.walk(디렉터리 경로)\n해당 디렉터리 경로를 중심으로 하위 디렉터리를 탐색하여 generator 타입로 반환해준다.반환되는 정보는 path, sub_dirs, files 형태이며 이에 대한 설명은 다음과 같다path : 경로sub_dirs : path 하위 디렉터리들의 이름들files : path 하위 파일의 이름들\n\n디렉터리의 업로드가 잘 되었는지 확인하면 다음과 같다.\n1234567891011$ aws s3 ls s3://boto3_test/kevin-boto3-test/upload_test_directory/ --recursive2019-08-26 16:42:02       6148 kevin-boto3-test/upload_test_directory/.DS_Store2019-08-26 16:42:04       6148 kevin-boto3-test/upload_test_directory/dir1/.DS_Store2019-08-26 16:42:05       6148 kevin-boto3-test/upload_test_directory/dir1/dir1_1/.DS_Store2019-08-26 16:42:07         37 kevin-boto3-test/upload_test_directory/dir1/dir1_1/dir1_1_file1.txt2019-08-26 16:42:08         37 kevin-boto3-test/upload_test_directory/dir1/dir1_1/dir1_1_file2.txt2019-08-26 16:42:04         37 kevin-boto3-test/upload_test_directory/dir1/dir1_file1.txt2019-08-26 16:42:03         37 kevin-boto3-test/upload_test_directory/dir2/dir2_file1.txt2019-08-26 16:42:03         37 kevin-boto3-test/upload_test_directory/dir2/dir2_file2.txt2019-08-26 16:42:02         37 kevin-boto3-test/upload_test_directory/file1.txt2019-08-26 16:42:01         37 kevin-boto3-test/upload_test_directory/file2.txt\n\n결과는 다음과 같이 정리할 수 있다.\n\nBoto3를 이용하여 로컬 디렉터리(빈 디렉터리는 제외)를 S3에 업로드한다.\nAWS CLI 명령을 통해 실제로 로컬에서 S3에 업로드 된 것을 확인할 수 있었다.\n\nKinesis Data Firehose 실습\n테스트전 Firehose 정상 동작 확인Firehose가 정상적으로 동작하는지에 대한 확인은 Management console상에서 해당 Delivery Stream의 “Test with demo data”를 통하여 알 수 있다.\n\nDelivery stream 리스트 확인하기다음과 같은 시나리오를 바탕으로 진행한다.\n\nFirehose 클라이언트에 접근하여 접근가능한 Delivery stream의 목록을 출력한다.\n\n다음과 같은 파이썬 코드를 작성한다.\n123456789101112131415161718192021222324252627import boto3def get_firehose_client():    session = boto3.Session(profile_name=\"profile_kevin\")    firehose = session.client(\"firehose\")    return firehosedef list_delivery_streams():    firehose = get_firehose_client()    response_direct_put = firehose.list_delivery_streams(        DeliveryStreamType=\"DirectPut\")    response_kinesis_stream = firehose.list_delivery_streams(        DeliveryStreamType=\"KinesisStreamAsSource\")    print(\"List of Deliver Streams\")    print(\"Direct Put : &#123;&#125;\".format(response_direct_put[\"DeliveryStreamNames\"]))    print(\"Kinesis Stream As Source : &#123;&#125;\".format(        response_kinesis_stream[\"DeliveryStreamNames\"]))def main():    list_delivery_streams()if __name__ == \"__main__\":    main()\n\n파이썬 코드를 실행하면 다음과 같은 결과를 확인할 수 있다.\n1234$ python3 main.pyList of Deliver StreamsDirectPut : ['kevin-firehose-test']KinesisStream As Source : ['bloodwind-stream-firehose-es-poc']\n\nAWS CLI로 Delivery stream 리스트를 확인하면 다음과 같다.\n12345678$ aws firehose list-delivery-streams&#123; \"DeliveryStreamNames\": [ \"kevin-firehose-test\", \"bloodwind-stream-firehose-es-poc\" ], \"HasMoreDeliveryStreams\": false&#125;\n\n결과는 다음과 같이 정리할 수 있다.\n\nBoto3를 이용하여 Delivery Stream의 목록을 확인할 수 있다.\nAWS CLI 명령을 통해 실제로 확인한 결과와 Boto3로 확인한 결과가 동일함을 알 수 있다.\n\n단일 레코드를 Firehose에 보내기다음과 같은 시나리오를 바탕으로 진행한다.\n\n다음과 같은 샘플 데이터를 “kevin-firehose-test” Delivery stream으로 전송한다.\n\n123456789101112131415161718&#123;\t\"user_id\": \"Aster-Kotlin-Sapphire-564\",\t\"app_version\": \"v1.5.16(90)\",\t\"device_id\": \"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738\",\t\"device_manufacturer\": \"LG\",\t\"device_name\": \"LG G7 ThinQ\",\t\"device_model\": \"LM-G710N\",\t\"device_os\": \"Android\",\t\"device_os_number\": \"8.0\",\t\"event\": \"interest_service_click\",\t\"interest_id\": 1201,\t\"index\": 1,\t\"interest_name\": \"교육\",\t\"interest_service_id\": None,\t\"interest_service_type\": \"교육지원\",\t\"interest_service_name\": \"자료들\",\t\"timestamp\": \"2019-04-30T07:30:00Z\"&#125;\n\n\n“kevin-firehose-test” Deliver stream은 Direct put으로 들어온 데이터를 Amazon elasticsearch에 전송하고 s3에 백업 데이터를 생성한다.\n\n다음과 같은 Python 코드를 작성한다.\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748import boto3import jsondef get_firehose_client():    session = boto3.Session(profile_name=\"profile_kevin\")    firehose = session.client(\"firehose\")    return firehosedef put_record_to_delivery_stream(test_data):    print(\"Put record to Delivery Stream\")    firehose = get_firehose_client()    response = firehose.put_record(        DeliveryStreamName=\"kevin-firehose-test\",        Record=&#123;\"Data\": json.dumps(test_data, ensure_ascii=False)&#125;    )    print(response)def main():    test_data = &#123;        \"user_id\": \"Aster-Kotlin-Sapphire-564\",        \"app_version\": \"v1.5.16(90)\",        \"device_id\": \"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738\",        \"device_manufacturer\": \"LG\",        \"device_name\": \"LG G7 ThinQ\",        \"device_model\": \"LM-G710N\",        \"device_os\": \"Android\",        \"device_os_number\": \"8.0\",        \"event\": \"interest_service_click\",        \"interest_id\": 1201,        \"index\": 1,        \"interest_name\": \"교육\",        \"interest_service_id\": None,        \"interest_service_type\": \"교육지원\",        \"interest_service_name\": \"자료들\",        \"timestamp\": \"2019-04-30T07:30:00Z\"    &#125;    put_record_to_delivery_stream(test_data)if __name__ == \"__main__\":    main()\n\n\n\nPython 코드를 실행하면 다음과 같다.\n1234567891011121314151617181920212223242526272829303132333435363738394041$ python3 main.pyPut record to Delivery Stream&#123;'RecordId': 'OkvHgs4vIsuRjYw0O5VZB1EobIDBMq7nrvxe/eXDMtdQEDC+eFnEL3T5cILNN+pGD4cu284LsuuC0dAWO7GCZcU3tVcxnr8gFfYfFMsNLuz6KLrbOAV1NaN6oPcxhicH5CpdBHAsxFoZPugkAGe7axq9odkI+CMIsD76w7pHUF2I7rQUb8hswnKp1iHx6O6Ip4MbvwefA2U1kPyyqnP1hTPprg/M8xY4', 'Encrypted': False, 'ResponseMetadata': &#123;'RequestId': 'f609df57-39b8-ccff-a3d4-eadd7b964c48', 'HTTPStatusCode': 200, 'HTTPHeaders': &#123;'x-amzn-requestid': 'f609df57-39b8-ccff-a3d4-eadd7b964c48', 'x-amz-id-2': 'Rwyt+v8XyhuqHJYMgpacWRLeSUAQg7Im9hEVdeR/4Utu49+fOyxC20NmHppA9UUg2v+FiDfvVquVx1K7mrGFUiVXOXmLalUd', 'content-type': 'application/x-amz-json-1.1', 'content-length': '257', 'date': 'Mon, 26 Aug 2019 01:18:02 GMT'&#125;, 'RetryAttempts': 0&#125;&#125;``` 실제로 Amazon elasticsearch에 샘플데이터가 입력 되었는지 확인한다.```bash$ curl -XGET ## AWS Elasticsearch 엔드포인트/interest_service_click2/_search\\?filter_path\\=hits\\&amp;format\\=json\\&amp;pretty&#123;  \"hits\" : &#123;    \"total\" : 1,    \"max_score\" : 1.0,    \"hits\" : [      &#123;        \"_index\" : \"interest_service_click2\",        \"_type\" : \"isc\",        \"_id\" : \"49595937143545169094912243846452981551249391789660962818.0\",        \"_score\" : 1.0,        \"_source\" : &#123;          \"user_id\" : \"Aster-Kotlin-Sapphire-564\",          \"app_version\" : \"v1.5.16(90)\",          \"device_id\" : \"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738\",          \"device_manufacturer\" : \"LG\",          \"device_name\" : \"LG G7 ThinQ\",          \"device_model\" : \"LM-G710N\",          \"device_os\" : \"Android\",          \"device_os_number\" : \"8.0\",          \"event\" : \"interest_service_click\",          \"interest_id\" : 1201,          \"index\" : 1,          \"interest_name\" : \"교육\",          \"interest_service_id\" : null,          \"interest_service_type\" : \"교육지원\",          \"interest_service_name\" : \"자료들\",          \"timestamp\" : \"2019-04-30T07:30:00Z\"        &#125;      &#125;    ]  &#125;&#125;\n\nAmazon elasticsearch의 백업용도로 저장된 S3를 확인하면 다음과 같다.\n12345678$ aws s3 ls s3://kevin_bucket_test/2019/08/26/01/2019-08-26 10:19:05        520 kevin-firehose-test-1-2019-08-26-01-18-03-d2346539-c5c2-4385-b163-4b60b14ea33c$ aws s3 cp s3://kevin_bucket_test/2019/08/26/01/kevin-firehose-test-1-2019-08-26-01-18-03-d2346539-c5c2-4385-b163-4b60b14ea33c ./single_record.txtdownload: s3://kevin_bucket_test/2019/08/26/01/kevin-firehose-test-1-2019-08-26-01-18-03-d2346539-c5c2-4385-b163-4b60b14ea33c to ./single_record.txt$ cat single_record.txt&#123;\"user_id\": \"Aster-Kotlin-Sapphire-564\", \"app_version\": \"v1.5.16(90)\", \"device_id\": \"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738\", \"device_manufacturer\": \"LG\", \"device_name\": \"LG G7 ThinQ\", \"device_model\": \"LM-G710N\", \"device_os\": \"Android\", \"device_os_number\": \"8.0\", \"event\": \"interest_service_click\", \"interest_id\": 1201, \"index\": 1, \"interest_name\": \"교육\", \"interest_service_id\": null, \"interest_service_type\": \"교육지원\", \"interest_service_name\": \"자료들\", \"timestamp\": \"2019-04-30T07:30:00Z\"&#125;%\n\n결과는 다음과 같이 정리할 수 있다.\n\nBoto3를 이용하여 단일 레코드를 firehose에 전송한다.\nAmazon elasticsearch의 index와 S3의 백업 데이터를 확인한 결과 단일 레코드가 정상적으로 전송된 것을 확인할 수 있다.\n\n다중 레코드를 firehose에 보내기다음과 같은 시나리오를 바탕으로 진행한다.\n\n다음과 같은 샘플 데이터를 “kevin-firehose-test” Delivery stream으로 전송한다.123&#123; \"user_id\" : \"Aster-Kotlin-Sapphire-564\", \"app_version\" : \"v1.5.16(90)\", \"device_id\" : \"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738\", \"device_manufacturer\" : \"LG\", \"device_name\" : \"LG G7 ThinQ\", \"device_model\" : \"LM-G710N\", \"device_os\" : \"Android\", \"device_os_number\" : \"8.0\", \"event\" : \"interest_service_click\", \"interest_id\" : 1201, \"index\" : 1, \"interest_name\" : \"교육\", \"interest_service_id\" : null, \"interest_service_type\" : \"교육지원\", \"interest_service_name\" : \"자료들\", \"timestamp\" : \"2019-05-03T01:15:00Z\" &#125;&#123; \"user_id\" : \"Aster-Kotlin-Sapphire-564\", \"app_version\" : \"v1.5.16(90)\", \"device_id\" : \"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738\", \"device_manufacturer\" : \"LG\", \"device_name\" : \"LG G7 ThinQ\", \"device_model\" : \"LM-G710N\", \"device_os\" : \"Android\", \"device_os_number\" : \"8.0\", \"event\" : \"interest_service_click\", \"interest_id\" : 1301, \"index\" : 1, \"interest_name\" : \"취업\", \"interest_service_id\" : null, \"interest_service_type\" : \"배워봐요\", \"interest_service_name\" : \"학원\",  \"timestamp\" : \"2019-05-03T00:50:00Z\" &#125;&#123; \"user_id\" : \"Aster-Kotlin-Sapphire-564\", \"app_version\" : \"v1.5.16(90)\", \"device_id\" : \"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738\", \"device_manufacturer\" : \"LG\", \"device_name\" : \"LG G7 ThinQ\", \"device_model\" : \"LM-G710N\", \"device_os\" : \"Android\", \"device_os_number\" : \"8.0\", \"event\" : \"interest_service_click\", \"interest_id\" : 1101, \"index\" : 1, \"interest_name\" : \"초등학교\", \"interest_service_id\" : null, \"interest_service_type\" : \"물어봐요\", \"interest_service_name\" : \"익명게시판\", \"timestamp\" : \"2019-05-03T00:20:00Z\" &#125;\n\n“kevin-firehose-test” Deliver stream은 Direct put으로 들어온 데이터를 Amazon elasticsearch에 전송하고 s3에 백업 데이터를 생성한다.\n\n\n\n다음과 같은 Python 코드를 작성한다.\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778import boto3import jsondef get_firehose_client():    session = boto3.Session(profile_name=\"profile_kevin\")    firehose = session.client(\"firehose\")    return firehosedef batch_record_to_delivery_stream(test_data_list):    print(\"Put multiple records to Deliver Stream\")    records = list(map(lambda data : &#123;\"Data\": json.dumps(data, ensure_ascii=False)&#125;, test_data_list))    firehose = get_firehose_client()        response = firehose.put_record_batch(DeliveryStreamName=\"kevin-firehose-test\",Records=records)    print(response)def main():    test_data_list = [            &#123;                \"user_id\": \"Aster-Kotlin-Sapphire-564\",                \"app_version\": \"v1.5.16(90)\",                \"device_id\": \"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738\",                \"device_manufacturer\": \"LG\", \"device_name\": \"LG G7 ThinQ\", \"device_model\": \"LM-G710N\", \"device_os\": \"Android\", \"device_os_number\": \"8.0\",                \"event\": \"interest_service_click\",                \"interest_id\": 1101,                \"index\": 1,                \"interest_name\": \"초등학교\", \"interest_service_id\": None, \"interest_service_type\": \"물어봐요\",\"interest_service_name\": \"익명게시판\",                \"timestamp\": \"2019-05-03T00:20:00Z\"            &#125;,            &#123;                \"user_id\": \"Aster-Kotlin-Sapphire-564\",                \"app_version\": \"v1.5.16(90)\",                \"device_id\": \"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738\",                \"device_manufacturer\": \"LG\", \"device_name\": \"LG G7 ThinQ\", \"device_model\": \"LM-G710N\", \"device_os\": \"Android\", \"device_os_number\": \"8.0\",                \"event\": \"interest_service_click\",                \"interest_id\": 1301,                \"index\": 1,                \"interest_name\": \"취업\", \"interest_service_id\": None, \"interest_service_type\": \"배워봐요\",\"interest_service_name\": \"학원\",                \"timestamp\": \"2019-05-03T00:50:00Z\"            &#125;,            &#123;                \"user_id\": \"Aster-Kotlin-Sapphire-564\",                \"app_version\": \"v1.5.16(90)\",                \"device_id\": \"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738\",                \"device_manufacturer\": \"LG\", \"device_name\": \"LG G7 ThinQ\", \"device_model\": \"LM-G710N\", \"device_os\": \"Android\", \"device_os_number\": \"8.0\",                \"event\": \"interest_service_click\",                \"interest_id\": 1201,                \"index\": 1,                \"interest_name\": \"교육\", \"interest_service_id\": None, \"interest_service_type\": \"교육지원\",\"interest_service_name\": \"자료들\",                \"timestamp\": \"2019-05-03T01:15:00Z\"            &#125;,            &#123;                \"user_id\": \"Aster-Kotlin-Sapphire-564\",                \"app_version\": \"v1.5.16(90)\",                \"device_id\": \"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738\",                \"device_manufacturer\": \"LG\",                \"device_name\": \"LG G7 ThinQ\",                \"device_model\": \"LM-G710N\",                \"device_os\": \"Android\",                \"device_os_number\": \"8.0\",                \"event\": \"interest_service_click\",                \"interest_id\": 1201,                \"index\": 1,                \"interest_name\": \"교육\",                \"interest_service_id\": None,                \"interest_service_type\": \"교육지원\",                \"interest_service_name\": \"자료들\",                \"timestamp\": \"2019-04-30T07:30:00Z\"            &#125;        ]    \tbatch_record_to_delivery_stream(test_data_list)if __name__ == \"__main__\":    main()\n\n위의 코드를 실행하면 다음과 같다.\n123$ python3 main.pyPut multiple records to Deliver Stream&#123;'FailedPutCount': 0, 'Encrypted': False, 'RequestResponses': [&#123;'RecordId': 'JvtN3+H/2oeKA6g087JPipW+g8STzCQQp50mcIw5FQ0wQIC2EihXrB1C31kMjNXY0lcQvXo6bn3H1O/PQMWI3veWxxCb9vkL3lieblJOu+v/q8TLAlsfNCsMADGz9yPLQg4B5uRfogNKv1+M44c6RnAHIg+n5aX/K8UUgbVVF47ZeyiJsokbshNmhO7F8+3BA4rAdXW2O4hSZj640O0RAtw6QuTB3CQN'&#125;, &#123;'RecordId': 'JT+5YNtI/3nwtCiiaoA/w5pBxkHYdbJFwGv8KiYDk7cTjIhenCGmnlBZqpwDswVWNGdnTT+e/qEP3VQI2dx1cwjHDpRRlilNBOYwKZaueoazeQ77p2NKgarweztvVVK1r91PjIlEUlW3fJfSAqiZsCoa6NQDs3u51gRNxi8Z9iBA/3uUXDehUkszxmlIzpvFKmrYrJ6UGIdBDHIpyqmWYdCAwAXJJTBk'&#125;, &#123;'RecordId': 'Mriv4BFuAEpziVO0hX0zZsoCspb8Sl4fdTOUitqYYTKGhfr+7noUWfYTTp0QF0JkuS8z/KHEr8aiV53IrLe860NzZY1mSN4ZAxmIKLxQqwQceFaj0xEBJJuYjrSOuDKRVD3rCz8n/Ab4QzEP/FOrUioKK7uf4kySsE7TvTkW1pWeKHabE27FjK/+9x4//3ep3fjp5K3TO81UX6Xk7AFa5BxiGUjVzcTI'&#125;], 'ResponseMetadata': &#123;'RequestId': 'c59f84d4-d42a-432f-9042-d44926133eb6', 'HTTPStatusCode': 200, 'HTTPHeaders': &#123;'x-amzn-requestid': 'c59f84d4-d42a-432f-9042-d44926133eb6', 'x-amz-id-2': '01OYNLqVZ9T7VGgpQ/pSJ1MtwblA5/kShluUDM6sLzv4ncJEyTrM7lHoKxEwo1EWzbXZmIu7Nz0oaw72UhQhAzAl3Ji9BgqZ', 'content-type': 'application/x-amz-json-1.1', 'content-length': '779', 'date': 'Mon, 26 Aug 2019 03:13:32 GMT'&#125;, 'RetryAttempts': 0&#125;&#125;\n\n실제 Amazon elasticsearch에서 레코드가 입력되었는지 확인하면 다음과 같다.\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081$ curl -XGET ## AWS Elasticsearch 엔드포인트/interest_service_click2/_search\\?filter_path\\=hits\\&amp;format\\=json\\&amp;pretty&#123;  \"hits\" : &#123;    \"total\" : 4,    \"max_score\" : 1.0,    \"hits\" : [      &#123;        \"_index\" : \"interest_service_click2\",        \"_type\" : \"isc\",        \"_id\" : \"49595937143545169094912246787272632161781037484956712962.0\",        \"_score\" : 1.0,        \"_source\" : &#123;          \"user_id\" : \"Aster-Kotlin-Sapphire-564\",          \"app_version\" : \"v1.5.16(90)\",          \"device_id\" : \"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738\",          \"device_manufacturer\" : \"LG\",          \"device_name\" : \"LG G7 ThinQ\",          \"device_model\" : \"LM-G710N\",          \"device_os\" : \"Android\",          \"device_os_number\" : \"8.0\",          \"event\" : \"interest_service_click\",          \"interest_id\" : 1201,          \"index\" : 1,          \"interest_name\" : \"교육\",          \"interest_service_id\" : null,          \"interest_service_type\" : \"교육지원\",          \"interest_service_name\" : \"자료들\",          \"timestamp\" : \"2019-05-03T01:15:00Z\"        &#125;      &#125;,      &#123;        \"_index\" : \"interest_service_click2\",        \"_type\" : \"isc\",        \"_id\" : \"49595937143545169094912246787271423235961422855782006786.0\",        \"_score\" : 1.0,        \"_source\" : &#123;          \"user_id\" : \"Aster-Kotlin-Sapphire-564\",          \"app_version\" : \"v1.5.16(90)\",          \"device_id\" : \"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738\",          \"device_manufacturer\" : \"LG\",          \"device_name\" : \"LG G7 ThinQ\",          \"device_model\" : \"LM-G710N\",          \"device_os\" : \"Android\",          \"device_os_number\" : \"8.0\",          \"event\" : \"interest_service_click\",          \"interest_id\" : 1301,          \"index\" : 1,          \"interest_name\" : \"취업\",          \"interest_service_id\" : null,          \"interest_service_type\" : \"배워봐요\",          \"interest_service_name\" : \"학원\",          \"timestamp\" : \"2019-05-03T00:50:00Z\"        &#125;      &#125;,      &#123;        \"_index\" : \"interest_service_click2\",        \"_type\" : \"isc\",        \"_id\" : \"49595937143545169094912246787270214310141808226607300610.0\",        \"_score\" : 1.0,        \"_source\" : &#123;          \"user_id\" : \"Aster-Kotlin-Sapphire-564\",          \"app_version\" : \"v1.5.16(90)\",          \"device_id\" : \"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738\",          \"device_manufacturer\" : \"LG\",          \"device_name\" : \"LG G7 ThinQ\",          \"device_model\" : \"LM-G710N\",          \"device_os\" : \"Android\",          \"device_os_number\" : \"8.0\",          \"event\" : \"interest_service_click\",          \"interest_id\" : 1101,          \"index\" : 1,          \"interest_name\" : \"초등학교\",          \"interest_service_id\" : null,          \"interest_service_type\" : \"물어봐요\",          \"interest_service_name\" : \"익명게시판\",          \"timestamp\" : \"2019-05-03T00:20:00Z\"        &#125;      &#125;,    ]  &#125;&#125;\n\n백업용 s3 데이터를 확인하면 다음과 같다.\n12345678910$ aws s3 ls s3://kevin_bucket_test/2019/08/26/03/2019-08-26 12:14:35       1528 kevin-firehose-test-1-2019-08-26-03-13-33-dd434742-87da-4cbe-b62a-b84c0366215f$ aws s3 cp s3://kevin_bucket_test/2019/08/26/03/kevin-firehose-test-1-2019-08-26-03-13-33-dd434742-87da-4cbe-b62a-b84c0366215f ~/dev/boto3_test/kinesis_data_firehose/multiple_record.txtdownload: s3://kevin_bucket_test/2019/08/26/03/kevin-firehose-test-1-2019-08-26-03-13-33-dd434742-87da-4cbe-b62a-b84c0366215f to dev/boto3_test/kinesis_data_firehose/multiple_record.txt$ cat dev/boto3_test/kinesis_data_firehose/multiple_record.txt&#123;\"user_id\": \"Aster-Kotlin-Sapphire-564\", \"app_version\": \"v1.5.16(90)\", \"device_id\": \"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738\", \"device_manufacturer\": \"LG\", \"device_name\": \"LG G7 ThinQ\", \"device_model\": \"LM-G710N\", \"device_os\": \"Android\", \"device_os_number\": \"8.0\", \"event\": \"interest_service_click\", \"interest_id\": 1101, \"index\": 1, \"interest_name\": \"초등학교\", \"interest_service_id\": null, \"interest_service_type\": \"물어봐요\", \"interest_service_name\": \"익명게시판\", \"timestamp\": \"2019-05-03T00:20:00Z\"&#125;&#123;\"user_id\": \"Aster-Kotlin-Sapphire-564\", \"app_version\": \"v1.5.16(90)\", \"device_id\": \"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738\", \"device_manufacturer\": \"LG\", \"device_name\": \"LG G7 ThinQ\", \"device_model\": \"LM-G710N\", \"device_os\": \"Android\", \"device_os_number\": \"8.0\", \"event\": \"interest_service_click\", \"interest_id\": 1301, \"index\": 1, \"interest_name\": \"취업\", \"interest_service_id\": null, \"interest_service_type\": \"배워봐요\", \"interest_service_name\": \"학원\", \"timestamp\": \"2019-05-03T00:50:00Z\"&#125;&#123;\"user_id\": \"Aster-Kotlin-Sapphire-564\", \"app_version\": \"v1.5.16(90)\", \"device_id\": \"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738\", \"device_manufacturer\": \"LG\", \"device_name\": \"LG G7 ThinQ\", \"device_model\": \"LM-G710N\", \"device_os\": \"Android\", \"device_os_number\": \"8.0\", \"event\": \"interest_service_click\", \"interest_id\": 1201, \"index\": 1, \"interest_name\": \"교육\", \"interest_service_id\": null, \"interest_service_type\": \"교육지원\", \"interest_service_name\": \"자료들\", \"timestamp\": \"2019-05-03T01:15:00Z\"&#125;%\n\n결과는 다음과 같이 정리할 수 있다.\n\nBoto3를 이용하여 다중 레코드를 firehose에 전송한다.\nAmazon elasticsearch의 index와 S3의 백업 데이터를 확인한 결과 다중 레코드가 정상적으로 전송된 것을 확인할 수 있다.\n\n","dateCreated":"2019-08-27T18:36:01+09:00","dateModified":"2020-02-28T19:09:53+09:00","datePublished":"2019-08-27T18:36:01+09:00","description":"\n\nBoto3를 이용하여 다음과 같은 AWS 서비스를 사용하는 방법(기초)을 정리한다.\n\nAmazon S3\nKinesis Data Firehose\n","headline":"Boto3로 S3, Kinesis Data Firehose 기초 실습","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"http://usehun0625.github.io/2019/08/27/Boto3%EB%A1%9C-S3-Kinesis-Data-Firehose-%EA%B8%B0%EC%B4%88-%EC%8B%A4%EC%8A%B5/"},"publisher":{"@type":"Organization","name":"Kevin","sameAs":["https://github.com/usehun0625/","mailto:usehun0625@gmail.com"],"image":"beer.jpg","logo":{"@type":"ImageObject","url":"beer.jpg"}},"url":"http://usehun0625.github.io/2019/08/27/Boto3%EB%A1%9C-S3-Kinesis-Data-Firehose-%EA%B8%B0%EC%B4%88-%EC%8B%A4%EC%8A%B5/","keywords":"Kinesis Data Firehose, Boto3, S3"}</script>
    <meta name="description" content="Boto3를 이용하여 다음과 같은 AWS 서비스를 사용하는 방법(기초)을 정리한다.  Amazon S3 Kinesis Data Firehose">
<meta property="og:type" content="blog">
<meta property="og:title" content="Boto3로 S3, Kinesis Data Firehose 기초 실습">
<meta property="og:url" content="http://usehun0625.github.io/2019/08/27/Boto3%EB%A1%9C-S3-Kinesis-Data-Firehose-%EA%B8%B0%EC%B4%88-%EC%8B%A4%EC%8A%B5/index.html">
<meta property="og:site_name" content="Kevin의 블로그">
<meta property="og:description" content="Boto3를 이용하여 다음과 같은 AWS 서비스를 사용하는 방법(기초)을 정리한다.  Amazon S3 Kinesis Data Firehose">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2019-08-27T09:36:01.000Z">
<meta property="article:modified_time" content="2020-02-28T10:09:53.598Z">
<meta property="article:author" content="Kevin">
<meta property="article:tag" content="Kinesis Data Firehose">
<meta property="article:tag" content="Boto3">
<meta property="article:tag" content="S3">
<meta name="twitter:card" content="summary">
    
    
        
    
    
        <meta property="og:image" content="http://usehun0625.github.io/assets/images/beer.jpg"/>
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/all.css">

    
<link rel="stylesheet" href="/assets/css/jquery.fancybox.css">

    
<link rel="stylesheet" href="/assets/css/thumbs.css">

    
<link rel="stylesheet" href="/assets/css/tranquilpeak.css">

    <!--STYLES END-->
    

    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            Kevin의 블로그
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
            <img class="header-picture" src="/assets/images/beer.jpg" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="Read more about the author"
                >
                    <img class="sidebar-profile-picture" src="/assets/images/beer.jpg" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">Kevin</h4>
                
                    <h5 class="sidebar-profile-bio"><p>Kevin, 이용훈<br>어릴 때부터 코딩에 흥미를 가지고 살아왔습니다. 새로운 기술도 열정적으로 받아들이며 더 좋은 개발을 위하여 학습하고 경험하고 노력하고 있습니다.</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/"
                            title="홈"
                        >
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">홈</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                            title="카테고리"
                        >
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">카테고리</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                            title="태그"
                        >
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">태그</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link open-algolia-search"
                             href="/all-archives"
                            
                            title="아카이브"
                        >
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">아카이브</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/usehun0625/" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="mailto:usehun0625@gmail.com" target="_blank" rel="noopener" title="Mail">
                    
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="5"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            Boto3로 S3, Kinesis Data Firehose 기초 실습
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2019-08-27T18:36:01+09:00">
	
		    Aug 27, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C/">클라우드</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <h1 id="table-of-contents">Table of Contents</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#환경"><span class="toc-text">환경</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#환경-구성-및-AWS-CLI-사용법"><span class="toc-text">환경 구성 및 AWS CLI 사용법</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#테스트-환경-구성-방법"><span class="toc-text">테스트 환경 구성 방법</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#S3의-파일-삭제하기"><span class="toc-text">S3의 파일 삭제하기</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#S3-디렉터리-다운로드-하기"><span class="toc-text">S3 디렉터리 다운로드 하기</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#로컬-디렉터리를-S3에-업로드-하기"><span class="toc-text">로컬 디렉터리를 S3에 업로드 하기</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Kinesis-Data-Firehose-실습"><span class="toc-text">Kinesis Data Firehose 실습</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Delivery-stream-리스트-확인하기"><span class="toc-text">Delivery stream 리스트 확인하기</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#단일-레코드를-Firehose에-보내기"><span class="toc-text">단일 레코드를 Firehose에 보내기</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#다중-레코드를-firehose에-보내기"><span class="toc-text">다중 레코드를 firehose에 보내기</span></a></li></ol></li></ol>

<p>Boto3를 이용하여 다음과 같은 AWS 서비스를 사용하는 방법(기초)을 정리한다.</p>
<ul>
<li>Amazon S3</li>
<li>Kinesis Data Firehose</li>
</ul>
<a id="more"></a>

<h1 id="환경"><a href="#환경" class="headerlink" title="환경"></a>환경</h1><p>테스트 환경은 다음과 같다.</p>
<ul>
<li>OS : macOS mojave 10.14.6</li>
<li>Python 버전 : 3.7.3</li>
<li>Boto3 버전 : 1.9.215</li>
<li>AWS CLI 버전 정보<ul>
<li>aws-cli : 1.16.222 </li>
<li>Python : 2.7.16 </li>
<li>Darwin : 18.7.0 </li>
<li>botocore : 1.12.212</li>
<li>Tree 버전 : 1.8.0</li>
</ul>
</li>
</ul>
<h1 id="환경-구성-및-AWS-CLI-사용법"><a href="#환경-구성-및-AWS-CLI-사용법" class="headerlink" title="환경 구성 및 AWS CLI 사용법"></a>환경 구성 및 AWS CLI 사용법</h1><h2 id="테스트-환경-구성-방법"><a href="#테스트-환경-구성-방법" class="headerlink" title="테스트 환경 구성 방법"></a>테스트 환경 구성 방법</h2><p>virtual env로 환경을 구성한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ virtualenv .venv</span><br><span class="line">Using base prefix <span class="string">'/usr/local/Cellar/python/3.7.3/Frameworks/Python.framework/Versions/3.7'</span></span><br><span class="line">New python executable <span class="keyword">in</span> /Users/kevin/dev/boto3_test/amazon_s3/.venv/bin/python3.7</span><br><span class="line">Also creating executable <span class="keyword">in</span> /Users/kevin/dev/boto3_test/amazon_s3/.venv/bin/python</span><br><span class="line">Installing setuptools, pip, wheel... </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">virtual env 활성화후 boto3 설치</span><br></pre></td></tr></table></figure>
<p>$ source .venv/bin/activate<br>$ pip3 install boto3</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## AWS CLI 사용법</span><br><span class="line">다음 링크를 참고한다.</span><br><span class="line">* https:&#x2F;&#x2F;docs.aws.amazon.com&#x2F;ko_kr&#x2F;cli&#x2F;latest&#x2F;userguide&#x2F;install-macos.html</span><br><span class="line">* https:&#x2F;&#x2F;docs.aws.amazon.com&#x2F;ko_kr&#x2F;cli&#x2F;latest&#x2F;userguide&#x2F;cli-services-s3.html</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"># Boto3로 AWS S3 실습</span><br><span class="line"></span><br><span class="line">## S3 클라이언트 인스턴스 할당</span><br><span class="line">아래와 같은 함수를 이용하여 S3에</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;bash</span><br><span class="line">import boto3</span><br><span class="line"></span><br><span class="line">def get_s3():</span><br><span class="line">    # aws profile</span><br><span class="line">    session &#x3D; boto3.Session(profile_name&#x3D;&quot;profile_kevin&quot;)</span><br><span class="line">    s3 &#x3D; session.resource(&#39;s3&#39;)</span><br><span class="line">    return s3 </span><br><span class="line">&#96;&#96;&#96; </span><br><span class="line"></span><br><span class="line">## 로컬 파일을 S3에 업로드 하기</span><br><span class="line">다음과 같은 시나리오를 바탕으로 테스트를 진행한다.</span><br><span class="line">1. 로컬 파일을 생성한다.</span><br><span class="line">2. 생성된 로컬 파일을 s3:&#x2F;&#x2F;boto3_test&#x2F;kevin-boto3-test&#x2F; 경로에 업로드 한다.</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">다음과 같이 Python 코드를 작성하고 실행한다.</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;bash</span><br><span class="line">import boto3</span><br><span class="line"></span><br><span class="line">def get_s3():</span><br><span class="line">    session &#x3D; boto3.Session(profile_name&#x3D;&quot;profile_kevin&quot;)</span><br><span class="line">    s3 &#x3D; session.resource(&#39;s3&#39;)</span><br><span class="line">    return s3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def make_file(path&#x3D;&quot;.&#x2F;boto3_file_upload_test.txt&quot;):</span><br><span class="line">    with open(path, &quot;w&quot;) as wf:</span><br><span class="line">        wf.write(&quot;This file boto3 file upload test !!!!&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    # make file</span><br><span class="line">    file_path &#x3D; &quot;.&#x2F;boto3_file_upload_test.txt&quot;</span><br><span class="line">    make_file(file_path)</span><br><span class="line"></span><br><span class="line">    # upload s3</span><br><span class="line">    s3 &#x3D; get_s3()</span><br><span class="line">    bucket &#x3D; s3.Bucket(&#39;boto3_test&#39;)</span><br><span class="line">    bucket.upload_file(</span><br><span class="line">        file_path, &#39;kevin-boto3-test&#x2F;boto3_file_upload_test.txt&#39;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &quot;__main__&quot;:</span><br><span class="line">    main()</span><br><span class="line">&#96;&#96;&#96; </span><br><span class="line"></span><br><span class="line">생성한 로컬 파일이 s3에 업로드 되었는지 확인한다. 이상없이 파일 업도드 된 것을 확인할 수 있다.</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;bash</span><br><span class="line">$ aws s3 ls s3:&#x2F;&#x2F;boto3_test&#x2F;kevin-boto3-test&#x2F;</span><br><span class="line">2019-08-23 14:39:54          0</span><br><span class="line">2019-08-23 14:45:08         37 boto3_file_upload_test.txt</span><br><span class="line">&#96;&#96;&#96;  </span><br><span class="line"></span><br><span class="line">## S3에서 로컬로 파일 다운로드하기</span><br><span class="line">다음과 같은 시나리오를 바탕으로 테스트를 진행한다.</span><br><span class="line">1. s3:&#x2F;&#x2F;boto3_test&#x2F;kevin-boto3-test&#x2F;boto3_file_upload.txt 파일을 로컬로 다운로드 한다. </span><br><span class="line"></span><br><span class="line">다음과 같이 Python코드를 작성하고 실행한다.</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;bash</span><br><span class="line">import boto3</span><br><span class="line"></span><br><span class="line">def get_s3():</span><br><span class="line">    # aws profile</span><br><span class="line">    session &#x3D; boto3.Session(profile_name&#x3D;&quot;profile_kevin&quot;)</span><br><span class="line">    s3 &#x3D; session.resource(&#39;s3&#39;)</span><br><span class="line">    return s3</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    download_file_path &#x3D; &quot;.&#x2F;boto3_file_upload_test2.txt&quot;</span><br><span class="line"></span><br><span class="line">    # download s3</span><br><span class="line">    s3 &#x3D; get_s3()</span><br><span class="line">    bucket &#x3D; s3.Bucket(&#39;boto3_test&#39;)</span><br><span class="line">    bucket.download_file(</span><br><span class="line">        &#39;kevin-boto3-test&#x2F;boto3_file_upload_test.txt&#39;, download_file_path)</span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &quot;__main__&quot;:</span><br><span class="line">    main()</span><br><span class="line">&#96;&#96;&#96; </span><br><span class="line"></span><br><span class="line">다운로드한 파일을 확인하면 다음과 같다.</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;bash</span><br><span class="line">$ cat boto3_file_upload_test2.txt</span><br><span class="line">This file boto3 file upload test !!!!%</span><br></pre></td></tr></table></figure>

<p>결과는 다음과 정리할 수 있다.</p>
<ul>
<li>Boto3를 이용하여 S3의 업로드된 파일을 다운로드한다.</li>
<li>커널 명령을 통해 실제로 S3에서 파일이 다운로드 된 것을 확인할 수 있다.</li>
</ul>
<h2 id="S3의-파일-삭제하기"><a href="#S3의-파일-삭제하기" class="headerlink" title="S3의 파일 삭제하기"></a>S3의 파일 삭제하기</h2><p>다음과 같은 시나리오를 바탕으로 테스트를 진행한다.</p>
<ol>
<li><p>s3://boto3_test/kevin-boto3-test/boto3_file_upload.txt 파일을 삭제한다.</p>
<p>다음과 같이 Python코드를 작성하고 실행한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import boto3</span><br><span class="line"></span><br><span class="line">def get_s3():</span><br><span class="line">    <span class="comment"># aws profile</span></span><br><span class="line">    session = boto3.Session(profile_name=<span class="string">"profile_kevin"</span>)</span><br><span class="line">    s3 = session.resource(<span class="string">'s3'</span>)</span><br><span class="line">    <span class="built_in">return</span> s3</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    <span class="comment"># delete s3</span></span><br><span class="line">    s3 = get_s3()</span><br><span class="line">    bucket = s3.Bucket(<span class="string">'boto3_test'</span>)</span><br><span class="line">    obj = bucket.Object(<span class="string">'kevin-boto3-test/boto3_file_upload_test.txt'</span>)</span><br><span class="line">    obj.delete()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">삭제 되었는지 확인한다. 에러없이 삭제 된 것을 알 수 있다.</span><br><span class="line">```bash</span><br><span class="line">$ aws s3 ls s3://boto3_test/kevin-boto3-test/</span><br><span class="line">2019-08-23 14:39:54          0</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>결과는 다음과 정리할 수 있다.</p>
<ul>
<li>Boto3를 이용하여 S3의 업로드된 파일을 삭제한다.</li>
<li>AWS CLI를 통해 실제로 S3에서 파일이 삭제 된 것을 확인할 수 있었다</li>
</ul>
<h2 id="S3-디렉터리-다운로드-하기"><a href="#S3-디렉터리-다운로드-하기" class="headerlink" title="S3 디렉터리 다운로드 하기"></a>S3 디렉터리 다운로드 하기</h2><p>다음과 같은 시나리오를 바탕으로 트를 진행한다.</p>
<ol>
<li>위의 S3 경로 s3://boto3_test/kevin-boto3-test/download_test_directory 디렉터리(빈 디렉터리는 제외)를 로컬로 다운로드한다.</li>
</ol>
<p>다운로드 할 파일을 확인하면 다음과 같다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ aws s3 ls s3://boto3_test/kevin-boto3-test/download_test_directory --recursive</span><br><span class="line">2019-08-26 19:07:16         39 kevin-boto3-test/download_test_directory/dir1/dir1_1/dir1_1_file1.txt</span><br><span class="line">2019-08-26 19:07:17         39 kevin-boto3-test/download_test_directory/dir1/dir1_1/dir1_1_file2.txt</span><br><span class="line">2019-08-26 19:07:15         39 kevin-boto3-test/download_test_directory/dir1/dir1_file1.txt</span><br><span class="line">2019-08-26 19:07:14         39 kevin-boto3-test/download_test_directory/dir2/dir2_file1.txt</span><br><span class="line">2019-08-26 19:07:14         39 kevin-boto3-test/download_test_directory/dir2/dir2_file2.txt</span><br><span class="line">2019-08-26 19:08:10          0 kevin-boto3-test/download_test_directory/dir3/</span><br><span class="line">2019-08-26 19:07:13         39 kevin-boto3-test/download_test_directory/file1.txt</span><br><span class="line">2019-08-26 19:07:13         39 kevin-boto3-test/download_test_directory/file2.txt</span><br></pre></td></tr></table></figure>

<p>다음과 같은 Python 코드를 작성하고 실행한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">import boto3</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_s3():</span><br><span class="line">    session = boto3.Session(profile_name=<span class="string">"profile_kevin"</span>)</span><br><span class="line">    s3 = session.resource(<span class="string">'s3'</span>)</span><br><span class="line">    <span class="built_in">return</span> s3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def download_directory_to_s3(s3_dir_path, local_dir_path):</span><br><span class="line">    s3 = get_s3()</span><br><span class="line">    bucket = s3.Bucket(<span class="string">'boto3_test'</span>)</span><br><span class="line"></span><br><span class="line">    path_list = list()</span><br><span class="line">    <span class="keyword">for</span> obj <span class="keyword">in</span> bucket.objects.filter(Prefix=s3_dir_path):</span><br><span class="line">        s3_path = obj.key</span><br><span class="line">        local_path = s3_path.replace(s3_dir_path, local_dir_path)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> s3_path[-1] == <span class="string">'/'</span>:</span><br><span class="line">            <span class="built_in">continue</span></span><br><span class="line"></span><br><span class="line">        dir_name = os.path.dirname(local_path)</span><br><span class="line">        <span class="keyword">if</span> not os.path.exists(dir_name):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"make directory &#123;&#125;"</span>.format(dir_name))</span><br><span class="line">            os.makedirs(dir_name)</span><br><span class="line"></span><br><span class="line">        path_list.append([s3_path, local_path])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> path <span class="keyword">in</span> path_list:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Download from &#123;&#125; to &#123;&#125;"</span>.format(path[0], path[1]))</span><br><span class="line">        bucket.download_file(path[0], path[1])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    parameter = &#123;<span class="string">"s3_dir_path"</span>: <span class="string">"kevin-boto3-test/download_test_directory/"</span>,</span><br><span class="line">                 <span class="string">"local_dir_path"</span>: <span class="string">"./download_test_directory/"</span>,</span><br><span class="line">                 &#125;</span><br><span class="line">    download_directory_to_s3(**parameter)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">디렉터리가 정상적으로 다운로드 되었는지 확인한다.</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">$ tree download_test_directory</span><br><span class="line">download_test_directory</span><br><span class="line">├── dir1</span><br><span class="line">│   ├── dir1_1</span><br><span class="line">│   │   ├── dir1_1_file1.txt</span><br><span class="line">│   │   └── dir1_1_file2.txt</span><br><span class="line">│   └── dir1_file1.txt</span><br><span class="line">├── dir2</span><br><span class="line">│   ├── dir2_file1.txt</span><br><span class="line">│   └── dir2_file2.txt</span><br><span class="line">├── file1.txt</span><br><span class="line">└── file2.txt</span><br><span class="line">3 directories, 7 files</span><br></pre></td></tr></table></figure>

<p>결과는 다음과 같이 정리할 수 있다.</p>
<ul>
<li>Boto3를 이용하여 S3의 업로드된 디렉터리를 로컬로 다운로드한다. (빈 디렉터리는 제외)</li>
<li>커널 명령을 통해 실제로 S3에서 로컬로 디렉터리가 다운로드 된 것을 확인할 수 있다.</li>
</ul>
<h2 id="로컬-디렉터리를-S3에-업로드-하기"><a href="#로컬-디렉터리를-S3에-업로드-하기" class="headerlink" title="로컬 디렉터리를 S3에 업로드 하기"></a>로컬 디렉터리를 S3에 업로드 하기</h2><p>다음과 같은 시나리오를 바탕으로 테스트를 진행한다.</p>
<ol>
<li>로컬 디렉터리(빈 디렉터리는 제외)를 s3 경로 s3://boto3_test/kevin-boto3-test/upload_test_directory에 업로드 한다.</li>
</ol>
<p>업로드할 디렉터리는 다음과 같은 구조로 이루어져 있다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ tree upload_test_directory</span><br><span class="line">upload_test_directory</span><br><span class="line">├── dir1</span><br><span class="line">│   ├── dir1_1</span><br><span class="line">│   │   ├── dir1_1_file1.txt</span><br><span class="line">│   │   └── dir1_1_file2.txt</span><br><span class="line">│   └── dir1_file1.txt</span><br><span class="line">├── dir2</span><br><span class="line">│   ├── dir2_file1.txt</span><br><span class="line">│   └── dir2_file2.txt</span><br><span class="line">├── dir3</span><br><span class="line">├── file1.txt</span><br><span class="line">└── file2.txt</span><br></pre></td></tr></table></figure>

<p>다음과 같은 Python 코드를 작성하고 실행한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">import boto3</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_s3():</span><br><span class="line">    session = boto3.Session(profile_name=<span class="string">"profile_kevin"</span>)</span><br><span class="line">    s3 = session.resource(<span class="string">'s3'</span>)</span><br><span class="line">    <span class="built_in">return</span> s3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def upload_directory_to_s3(local_dir_path, s3_dir_path):</span><br><span class="line">    path_list = list()</span><br><span class="line">    <span class="keyword">for</span> path, sub_dirs, files <span class="keyword">in</span> os.walk(local_dir_path):</span><br><span class="line">        <span class="keyword">for</span> filename <span class="keyword">in</span> files:</span><br><span class="line">            local_file_path = os.path.join(path, filename)</span><br><span class="line"></span><br><span class="line">            s3_file_path_depart = [s3_dir_path,</span><br><span class="line">                                   os.path.relpath(local_file_path, local_dir_path)]</span><br><span class="line">            s3_file_path = <span class="string">""</span>.join(s3_file_path_depart)</span><br><span class="line">            path_list.append([local_file_path, s3_file_path])</span><br><span class="line"></span><br><span class="line">    s3 = get_s3()</span><br><span class="line">    bucket = s3.Bucket(<span class="string">'boto3_test'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> paths <span class="keyword">in</span> path_list:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"upload from &#123;&#125; to &#123;&#125;"</span>.format(paths[0], paths[1]))</span><br><span class="line">        bucket.upload_file(paths[0], paths[1])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    parameter = &#123;<span class="string">"local_dir_path"</span>: <span class="string">"./upload_test_directory/"</span>,</span><br><span class="line">                 <span class="string">"s3_dir_path"</span>: <span class="string">"kevin-boto3-test/upload_test_directory/"</span>&#125;</span><br><span class="line">    upload_directory_to_s3(**parameter)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>위의 소스 코드중 os 모듈을 사용하는 부분이 있어 아래와 같이 정리한다.</p>
<blockquote>
<p>os.walk(디렉터리 경로)</p>
<p>해당 디렉터리 경로를 중심으로 하위 디렉터리를 탐색하여 generator 타입로 반환해준다.<br>반환되는 정보는 path, sub_dirs, files 형태이며 이에 대한 설명은 다음과 같다<br>path : 경로<br>sub_dirs : path 하위 디렉터리들의 이름들<br>files : path 하위 파일의 이름들</p>
</blockquote>
<p>디렉터리의 업로드가 잘 되었는지 확인하면 다음과 같다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ aws s3 ls s3://boto3_test/kevin-boto3-test/upload_test_directory/ --recursive</span><br><span class="line">2019-08-26 16:42:02       6148 kevin-boto3-test/upload_test_directory/.DS_Store</span><br><span class="line">2019-08-26 16:42:04       6148 kevin-boto3-test/upload_test_directory/dir1/.DS_Store</span><br><span class="line">2019-08-26 16:42:05       6148 kevin-boto3-test/upload_test_directory/dir1/dir1_1/.DS_Store</span><br><span class="line">2019-08-26 16:42:07         37 kevin-boto3-test/upload_test_directory/dir1/dir1_1/dir1_1_file1.txt</span><br><span class="line">2019-08-26 16:42:08         37 kevin-boto3-test/upload_test_directory/dir1/dir1_1/dir1_1_file2.txt</span><br><span class="line">2019-08-26 16:42:04         37 kevin-boto3-test/upload_test_directory/dir1/dir1_file1.txt</span><br><span class="line">2019-08-26 16:42:03         37 kevin-boto3-test/upload_test_directory/dir2/dir2_file1.txt</span><br><span class="line">2019-08-26 16:42:03         37 kevin-boto3-test/upload_test_directory/dir2/dir2_file2.txt</span><br><span class="line">2019-08-26 16:42:02         37 kevin-boto3-test/upload_test_directory/file1.txt</span><br><span class="line">2019-08-26 16:42:01         37 kevin-boto3-test/upload_test_directory/file2.txt</span><br></pre></td></tr></table></figure>

<p>결과는 다음과 같이 정리할 수 있다.</p>
<ul>
<li>Boto3를 이용하여 로컬 디렉터리(빈 디렉터리는 제외)를 S3에 업로드한다.</li>
<li>AWS CLI 명령을 통해 실제로 로컬에서 S3에 업로드 된 것을 확인할 수 있었다.</li>
</ul>
<h1 id="Kinesis-Data-Firehose-실습"><a href="#Kinesis-Data-Firehose-실습" class="headerlink" title="Kinesis Data Firehose 실습"></a>Kinesis Data Firehose 실습</h1><blockquote>
<p>테스트전 Firehose 정상 동작 확인<br>Firehose가 정상적으로 동작하는지에 대한 확인은 Management console상에서 해당 Delivery Stream의 “Test with demo data”를 통하여 알 수 있다.</p>
</blockquote>
<h2 id="Delivery-stream-리스트-확인하기"><a href="#Delivery-stream-리스트-확인하기" class="headerlink" title="Delivery stream 리스트 확인하기"></a>Delivery stream 리스트 확인하기</h2><p>다음과 같은 시나리오를 바탕으로 진행한다.</p>
<ol>
<li>Firehose 클라이언트에 접근하여 접근가능한 Delivery stream의 목록을 출력한다.</li>
</ol>
<p>다음과 같은 파이썬 코드를 작성한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import boto3</span><br><span class="line"></span><br><span class="line">def get_firehose_client():</span><br><span class="line">    session = boto3.Session(profile_name=<span class="string">"profile_kevin"</span>)</span><br><span class="line">    firehose = session.client(<span class="string">"firehose"</span>)</span><br><span class="line">    <span class="built_in">return</span> firehose</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def list_delivery_streams():</span><br><span class="line">    firehose = get_firehose_client()</span><br><span class="line"></span><br><span class="line">    response_direct_put = firehose.list_delivery_streams(</span><br><span class="line">        DeliveryStreamType=<span class="string">"DirectPut"</span>)</span><br><span class="line">    response_kinesis_stream = firehose.list_delivery_streams(</span><br><span class="line">        DeliveryStreamType=<span class="string">"KinesisStreamAsSource"</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"List of Deliver Streams"</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Direct Put : &#123;&#125;"</span>.format(response_direct_put[<span class="string">"DeliveryStreamNames"</span>]))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Kinesis Stream As Source : &#123;&#125;"</span>.format(</span><br><span class="line">        response_kinesis_stream[<span class="string">"DeliveryStreamNames"</span>]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    list_delivery_streams()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>파이썬 코드를 실행하면 다음과 같은 결과를 확인할 수 있다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ python3 main.py</span><br><span class="line">List of Deliver Streams</span><br><span class="line">DirectPut : [<span class="string">'kevin-firehose-test'</span>]</span><br><span class="line">KinesisStream As Source : [<span class="string">'bloodwind-stream-firehose-es-poc'</span>]</span><br></pre></td></tr></table></figure>

<p>AWS CLI로 Delivery stream 리스트를 확인하면 다음과 같다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ aws firehose list-delivery-streams</span><br><span class="line">&#123;</span><br><span class="line"> <span class="string">"DeliveryStreamNames"</span>: [</span><br><span class="line"> <span class="string">"kevin-firehose-test"</span>,</span><br><span class="line"> <span class="string">"bloodwind-stream-firehose-es-poc"</span></span><br><span class="line"> ],</span><br><span class="line"> <span class="string">"HasMoreDeliveryStreams"</span>: <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>결과는 다음과 같이 정리할 수 있다.</p>
<ul>
<li>Boto3를 이용하여 Delivery Stream의 목록을 확인할 수 있다.</li>
<li>AWS CLI 명령을 통해 실제로 확인한 결과와 Boto3로 확인한 결과가 동일함을 알 수 있다.</li>
</ul>
<h2 id="단일-레코드를-Firehose에-보내기"><a href="#단일-레코드를-Firehose에-보내기" class="headerlink" title="단일 레코드를 Firehose에 보내기"></a>단일 레코드를 Firehose에 보내기</h2><p>다음과 같은 시나리오를 바탕으로 진행한다.</p>
<ol>
<li>다음과 같은 샘플 데이터를 “kevin-firehose-test” Delivery stream으로 전송한다.</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="string">"user_id"</span>: <span class="string">"Aster-Kotlin-Sapphire-564"</span>,</span><br><span class="line">	<span class="string">"app_version"</span>: <span class="string">"v1.5.16(90)"</span>,</span><br><span class="line">	<span class="string">"device_id"</span>: <span class="string">"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738"</span>,</span><br><span class="line">	<span class="string">"device_manufacturer"</span>: <span class="string">"LG"</span>,</span><br><span class="line">	<span class="string">"device_name"</span>: <span class="string">"LG G7 ThinQ"</span>,</span><br><span class="line">	<span class="string">"device_model"</span>: <span class="string">"LM-G710N"</span>,</span><br><span class="line">	<span class="string">"device_os"</span>: <span class="string">"Android"</span>,</span><br><span class="line">	<span class="string">"device_os_number"</span>: <span class="string">"8.0"</span>,</span><br><span class="line">	<span class="string">"event"</span>: <span class="string">"interest_service_click"</span>,</span><br><span class="line">	<span class="string">"interest_id"</span>: 1201,</span><br><span class="line">	<span class="string">"index"</span>: 1,</span><br><span class="line">	<span class="string">"interest_name"</span>: <span class="string">"교육"</span>,</span><br><span class="line">	<span class="string">"interest_service_id"</span>: None,</span><br><span class="line">	<span class="string">"interest_service_type"</span>: <span class="string">"교육지원"</span>,</span><br><span class="line">	<span class="string">"interest_service_name"</span>: <span class="string">"자료들"</span>,</span><br><span class="line">	<span class="string">"timestamp"</span>: <span class="string">"2019-04-30T07:30:00Z"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>“kevin-firehose-test” Deliver stream은 Direct put으로 들어온 데이터를 Amazon elasticsearch에 전송하고 s3에 백업 데이터를 생성한다.</p>
</blockquote>
<p>다음과 같은 Python 코드를 작성한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">import boto3</span><br><span class="line">import json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_firehose_client():</span><br><span class="line">    session = boto3.Session(profile_name=<span class="string">"profile_kevin"</span>)</span><br><span class="line">    firehose = session.client(<span class="string">"firehose"</span>)</span><br><span class="line">    <span class="built_in">return</span> firehose</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def put_record_to_delivery_stream(test_data):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Put record to Delivery Stream"</span>)</span><br><span class="line"></span><br><span class="line">    firehose = get_firehose_client()</span><br><span class="line"></span><br><span class="line">    response = firehose.put_record(</span><br><span class="line">        DeliveryStreamName=<span class="string">"kevin-firehose-test"</span>,</span><br><span class="line">        Record=&#123;<span class="string">"Data"</span>: json.dumps(test_data, ensure_ascii=False)&#125;</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(response)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    test_data = &#123;</span><br><span class="line">        <span class="string">"user_id"</span>: <span class="string">"Aster-Kotlin-Sapphire-564"</span>,</span><br><span class="line">        <span class="string">"app_version"</span>: <span class="string">"v1.5.16(90)"</span>,</span><br><span class="line">        <span class="string">"device_id"</span>: <span class="string">"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738"</span>,</span><br><span class="line">        <span class="string">"device_manufacturer"</span>: <span class="string">"LG"</span>,</span><br><span class="line">        <span class="string">"device_name"</span>: <span class="string">"LG G7 ThinQ"</span>,</span><br><span class="line">        <span class="string">"device_model"</span>: <span class="string">"LM-G710N"</span>,</span><br><span class="line">        <span class="string">"device_os"</span>: <span class="string">"Android"</span>,</span><br><span class="line">        <span class="string">"device_os_number"</span>: <span class="string">"8.0"</span>,</span><br><span class="line">        <span class="string">"event"</span>: <span class="string">"interest_service_click"</span>,</span><br><span class="line">        <span class="string">"interest_id"</span>: 1201,</span><br><span class="line">        <span class="string">"index"</span>: 1,</span><br><span class="line">        <span class="string">"interest_name"</span>: <span class="string">"교육"</span>,</span><br><span class="line">        <span class="string">"interest_service_id"</span>: None,</span><br><span class="line">        <span class="string">"interest_service_type"</span>: <span class="string">"교육지원"</span>,</span><br><span class="line">        <span class="string">"interest_service_name"</span>: <span class="string">"자료들"</span>,</span><br><span class="line">        <span class="string">"timestamp"</span>: <span class="string">"2019-04-30T07:30:00Z"</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    put_record_to_delivery_stream(test_data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>



<p>Python 코드를 실행하면 다음과 같다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">$ python3 main.py</span><br><span class="line">Put record to Delivery Stream</span><br><span class="line">&#123;<span class="string">'RecordId'</span>: <span class="string">'OkvHgs4vIsuRjYw0O5VZB1EobIDBMq7nrvxe/eXDMtdQEDC+eFnEL3T5cILNN+pGD4cu284LsuuC0dAWO7GCZcU3tVcxnr8gFfYfFMsNLuz6KLrbOAV1NaN6oPcxhicH5CpdBHAsxFoZPugkAGe7axq9odkI+CMIsD76w7pHUF2I7rQUb8hswnKp1iHx6O6Ip4MbvwefA2U1kPyyqnP1hTPprg/M8xY4'</span>, <span class="string">'Encrypted'</span>: False, <span class="string">'ResponseMetadata'</span>: &#123;<span class="string">'RequestId'</span>: <span class="string">'f609df57-39b8-ccff-a3d4-eadd7b964c48'</span>, <span class="string">'HTTPStatusCode'</span>: 200, <span class="string">'HTTPHeaders'</span>: &#123;<span class="string">'x-amzn-requestid'</span>: <span class="string">'f609df57-39b8-ccff-a3d4-eadd7b964c48'</span>, <span class="string">'x-amz-id-2'</span>: <span class="string">'Rwyt+v8XyhuqHJYMgpacWRLeSUAQg7Im9hEVdeR/4Utu49+fOyxC20NmHppA9UUg2v+FiDfvVquVx1K7mrGFUiVXOXmLalUd'</span>, <span class="string">'content-type'</span>: <span class="string">'application/x-amz-json-1.1'</span>, <span class="string">'content-length'</span>: <span class="string">'257'</span>, <span class="string">'date'</span>: <span class="string">'Mon, 26 Aug 2019 01:18:02 GMT'</span>&#125;, <span class="string">'RetryAttempts'</span>: 0&#125;&#125;</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">실제로 Amazon elasticsearch에 샘플데이터가 입력 되었는지 확인한다.</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">$ curl -XGET <span class="comment">## AWS Elasticsearch 엔드포인트/interest_service_click2/_search\?filter_path\=hits\&amp;format\=json\&amp;pretty</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"hits"</span> : &#123;</span><br><span class="line">    <span class="string">"total"</span> : 1,</span><br><span class="line">    <span class="string">"max_score"</span> : 1.0,</span><br><span class="line">    <span class="string">"hits"</span> : [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"interest_service_click2"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"isc"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"49595937143545169094912243846452981551249391789660962818.0"</span>,</span><br><span class="line">        <span class="string">"_score"</span> : 1.0,</span><br><span class="line">        <span class="string">"_source"</span> : &#123;</span><br><span class="line">          <span class="string">"user_id"</span> : <span class="string">"Aster-Kotlin-Sapphire-564"</span>,</span><br><span class="line">          <span class="string">"app_version"</span> : <span class="string">"v1.5.16(90)"</span>,</span><br><span class="line">          <span class="string">"device_id"</span> : <span class="string">"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738"</span>,</span><br><span class="line">          <span class="string">"device_manufacturer"</span> : <span class="string">"LG"</span>,</span><br><span class="line">          <span class="string">"device_name"</span> : <span class="string">"LG G7 ThinQ"</span>,</span><br><span class="line">          <span class="string">"device_model"</span> : <span class="string">"LM-G710N"</span>,</span><br><span class="line">          <span class="string">"device_os"</span> : <span class="string">"Android"</span>,</span><br><span class="line">          <span class="string">"device_os_number"</span> : <span class="string">"8.0"</span>,</span><br><span class="line">          <span class="string">"event"</span> : <span class="string">"interest_service_click"</span>,</span><br><span class="line">          <span class="string">"interest_id"</span> : 1201,</span><br><span class="line">          <span class="string">"index"</span> : 1,</span><br><span class="line">          <span class="string">"interest_name"</span> : <span class="string">"교육"</span>,</span><br><span class="line">          <span class="string">"interest_service_id"</span> : null,</span><br><span class="line">          <span class="string">"interest_service_type"</span> : <span class="string">"교육지원"</span>,</span><br><span class="line">          <span class="string">"interest_service_name"</span> : <span class="string">"자료들"</span>,</span><br><span class="line">          <span class="string">"timestamp"</span> : <span class="string">"2019-04-30T07:30:00Z"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Amazon elasticsearch의 백업용도로 저장된 S3를 확인하면 다음과 같다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ aws s3 ls s3://kevin_bucket_test/2019/08/26/01/</span><br><span class="line">2019-08-26 10:19:05        520 kevin-firehose-test-1-2019-08-26-01-18-03-d2346539-c5c2-4385-b163-4b60b14ea33c</span><br><span class="line"></span><br><span class="line">$ aws s3 cp s3://kevin_bucket_test/2019/08/26/01/kevin-firehose-test-1-2019-08-26-01-18-03-d2346539-c5c2-4385-b163-4b60b14ea33c ./single_record.txt</span><br><span class="line">download: s3://kevin_bucket_test/2019/08/26/01/kevin-firehose-test-1-2019-08-26-01-18-03-d2346539-c5c2-4385-b163-4b60b14ea33c to ./single_record.txt</span><br><span class="line"></span><br><span class="line">$ cat single_record.txt</span><br><span class="line">&#123;<span class="string">"user_id"</span>: <span class="string">"Aster-Kotlin-Sapphire-564"</span>, <span class="string">"app_version"</span>: <span class="string">"v1.5.16(90)"</span>, <span class="string">"device_id"</span>: <span class="string">"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738"</span>, <span class="string">"device_manufacturer"</span>: <span class="string">"LG"</span>, <span class="string">"device_name"</span>: <span class="string">"LG G7 ThinQ"</span>, <span class="string">"device_model"</span>: <span class="string">"LM-G710N"</span>, <span class="string">"device_os"</span>: <span class="string">"Android"</span>, <span class="string">"device_os_number"</span>: <span class="string">"8.0"</span>, <span class="string">"event"</span>: <span class="string">"interest_service_click"</span>, <span class="string">"interest_id"</span>: 1201, <span class="string">"index"</span>: 1, <span class="string">"interest_name"</span>: <span class="string">"교육"</span>, <span class="string">"interest_service_id"</span>: null, <span class="string">"interest_service_type"</span>: <span class="string">"교육지원"</span>, <span class="string">"interest_service_name"</span>: <span class="string">"자료들"</span>, <span class="string">"timestamp"</span>: <span class="string">"2019-04-30T07:30:00Z"</span>&#125;%</span><br></pre></td></tr></table></figure>

<p>결과는 다음과 같이 정리할 수 있다.</p>
<ul>
<li>Boto3를 이용하여 단일 레코드를 firehose에 전송한다.</li>
<li>Amazon elasticsearch의 index와 S3의 백업 데이터를 확인한 결과 단일 레코드가 정상적으로 전송된 것을 확인할 수 있다.</li>
</ul>
<h2 id="다중-레코드를-firehose에-보내기"><a href="#다중-레코드를-firehose에-보내기" class="headerlink" title="다중 레코드를 firehose에 보내기"></a>다중 레코드를 firehose에 보내기</h2><p>다음과 같은 시나리오를 바탕으로 진행한다.</p>
<ol>
<li>다음과 같은 샘플 데이터를 “kevin-firehose-test” Delivery stream으로 전송한다.<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"user_id"</span> : <span class="string">"Aster-Kotlin-Sapphire-564"</span>, <span class="string">"app_version"</span> : <span class="string">"v1.5.16(90)"</span>, <span class="string">"device_id"</span> : <span class="string">"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738"</span>, <span class="string">"device_manufacturer"</span> : <span class="string">"LG"</span>, <span class="string">"device_name"</span> : <span class="string">"LG G7 ThinQ"</span>, <span class="string">"device_model"</span> : <span class="string">"LM-G710N"</span>, <span class="string">"device_os"</span> : <span class="string">"Android"</span>, <span class="string">"device_os_number"</span> : <span class="string">"8.0"</span>, <span class="string">"event"</span> : <span class="string">"interest_service_click"</span>, <span class="string">"interest_id"</span> : 1201, <span class="string">"index"</span> : 1, <span class="string">"interest_name"</span> : <span class="string">"교육"</span>, <span class="string">"interest_service_id"</span> : null, <span class="string">"interest_service_type"</span> : <span class="string">"교육지원"</span>, <span class="string">"interest_service_name"</span> : <span class="string">"자료들"</span>, <span class="string">"timestamp"</span> : <span class="string">"2019-05-03T01:15:00Z"</span> &#125;</span><br><span class="line">&#123; <span class="string">"user_id"</span> : <span class="string">"Aster-Kotlin-Sapphire-564"</span>, <span class="string">"app_version"</span> : <span class="string">"v1.5.16(90)"</span>, <span class="string">"device_id"</span> : <span class="string">"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738"</span>, <span class="string">"device_manufacturer"</span> : <span class="string">"LG"</span>, <span class="string">"device_name"</span> : <span class="string">"LG G7 ThinQ"</span>, <span class="string">"device_model"</span> : <span class="string">"LM-G710N"</span>, <span class="string">"device_os"</span> : <span class="string">"Android"</span>, <span class="string">"device_os_number"</span> : <span class="string">"8.0"</span>, <span class="string">"event"</span> : <span class="string">"interest_service_click"</span>, <span class="string">"interest_id"</span> : 1301, <span class="string">"index"</span> : 1, <span class="string">"interest_name"</span> : <span class="string">"취업"</span>, <span class="string">"interest_service_id"</span> : null, <span class="string">"interest_service_type"</span> : <span class="string">"배워봐요"</span>, <span class="string">"interest_service_name"</span> : <span class="string">"학원"</span>,  <span class="string">"timestamp"</span> : <span class="string">"2019-05-03T00:50:00Z"</span> &#125;</span><br><span class="line">&#123; <span class="string">"user_id"</span> : <span class="string">"Aster-Kotlin-Sapphire-564"</span>, <span class="string">"app_version"</span> : <span class="string">"v1.5.16(90)"</span>, <span class="string">"device_id"</span> : <span class="string">"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738"</span>, <span class="string">"device_manufacturer"</span> : <span class="string">"LG"</span>, <span class="string">"device_name"</span> : <span class="string">"LG G7 ThinQ"</span>, <span class="string">"device_model"</span> : <span class="string">"LM-G710N"</span>, <span class="string">"device_os"</span> : <span class="string">"Android"</span>, <span class="string">"device_os_number"</span> : <span class="string">"8.0"</span>, <span class="string">"event"</span> : <span class="string">"interest_service_click"</span>, <span class="string">"interest_id"</span> : 1101, <span class="string">"index"</span> : 1, <span class="string">"interest_name"</span> : <span class="string">"초등학교"</span>, <span class="string">"interest_service_id"</span> : null, <span class="string">"interest_service_type"</span> : <span class="string">"물어봐요"</span>, <span class="string">"interest_service_name"</span> : <span class="string">"익명게시판"</span>, <span class="string">"timestamp"</span> : <span class="string">"2019-05-03T00:20:00Z"</span> &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>“kevin-firehose-test” Deliver stream은 Direct put으로 들어온 데이터를 Amazon elasticsearch에 전송하고 s3에 백업 데이터를 생성한다.</p>
</blockquote>
</li>
</ol>
<p>다음과 같은 Python 코드를 작성한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">import boto3</span><br><span class="line">import json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_firehose_client():</span><br><span class="line">    session = boto3.Session(profile_name=<span class="string">"profile_kevin"</span>)</span><br><span class="line">    firehose = session.client(<span class="string">"firehose"</span>)</span><br><span class="line">    <span class="built_in">return</span> firehose</span><br><span class="line"></span><br><span class="line">def batch_record_to_delivery_stream(test_data_list):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Put multiple records to Deliver Stream"</span>)</span><br><span class="line"></span><br><span class="line">    records = list(map(lambda data : &#123;<span class="string">"Data"</span>: json.dumps(data, ensure_ascii=False)&#125;, test_data_list))</span><br><span class="line"></span><br><span class="line">    firehose = get_firehose_client()</span><br><span class="line">    </span><br><span class="line">    response = firehose.put_record_batch(DeliveryStreamName=<span class="string">"kevin-firehose-test"</span>,Records=records)</span><br><span class="line">    <span class="built_in">print</span>(response)</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    test_data_list = [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">"user_id"</span>: <span class="string">"Aster-Kotlin-Sapphire-564"</span>,</span><br><span class="line">                <span class="string">"app_version"</span>: <span class="string">"v1.5.16(90)"</span>,</span><br><span class="line">                <span class="string">"device_id"</span>: <span class="string">"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738"</span>,</span><br><span class="line">                <span class="string">"device_manufacturer"</span>: <span class="string">"LG"</span>, <span class="string">"device_name"</span>: <span class="string">"LG G7 ThinQ"</span>, <span class="string">"device_model"</span>: <span class="string">"LM-G710N"</span>, <span class="string">"device_os"</span>: <span class="string">"Android"</span>, <span class="string">"device_os_number"</span>: <span class="string">"8.0"</span>,</span><br><span class="line">                <span class="string">"event"</span>: <span class="string">"interest_service_click"</span>,</span><br><span class="line">                <span class="string">"interest_id"</span>: 1101,</span><br><span class="line">                <span class="string">"index"</span>: 1,</span><br><span class="line">                <span class="string">"interest_name"</span>: <span class="string">"초등학교"</span>, <span class="string">"interest_service_id"</span>: None, <span class="string">"interest_service_type"</span>: <span class="string">"물어봐요"</span>,<span class="string">"interest_service_name"</span>: <span class="string">"익명게시판"</span>,</span><br><span class="line">                <span class="string">"timestamp"</span>: <span class="string">"2019-05-03T00:20:00Z"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">"user_id"</span>: <span class="string">"Aster-Kotlin-Sapphire-564"</span>,</span><br><span class="line">                <span class="string">"app_version"</span>: <span class="string">"v1.5.16(90)"</span>,</span><br><span class="line">                <span class="string">"device_id"</span>: <span class="string">"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738"</span>,</span><br><span class="line">                <span class="string">"device_manufacturer"</span>: <span class="string">"LG"</span>, <span class="string">"device_name"</span>: <span class="string">"LG G7 ThinQ"</span>, <span class="string">"device_model"</span>: <span class="string">"LM-G710N"</span>, <span class="string">"device_os"</span>: <span class="string">"Android"</span>, <span class="string">"device_os_number"</span>: <span class="string">"8.0"</span>,</span><br><span class="line">                <span class="string">"event"</span>: <span class="string">"interest_service_click"</span>,</span><br><span class="line">                <span class="string">"interest_id"</span>: 1301,</span><br><span class="line">                <span class="string">"index"</span>: 1,</span><br><span class="line">                <span class="string">"interest_name"</span>: <span class="string">"취업"</span>, <span class="string">"interest_service_id"</span>: None, <span class="string">"interest_service_type"</span>: <span class="string">"배워봐요"</span>,<span class="string">"interest_service_name"</span>: <span class="string">"학원"</span>,</span><br><span class="line">                <span class="string">"timestamp"</span>: <span class="string">"2019-05-03T00:50:00Z"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">"user_id"</span>: <span class="string">"Aster-Kotlin-Sapphire-564"</span>,</span><br><span class="line">                <span class="string">"app_version"</span>: <span class="string">"v1.5.16(90)"</span>,</span><br><span class="line">                <span class="string">"device_id"</span>: <span class="string">"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738"</span>,</span><br><span class="line">                <span class="string">"device_manufacturer"</span>: <span class="string">"LG"</span>, <span class="string">"device_name"</span>: <span class="string">"LG G7 ThinQ"</span>, <span class="string">"device_model"</span>: <span class="string">"LM-G710N"</span>, <span class="string">"device_os"</span>: <span class="string">"Android"</span>, <span class="string">"device_os_number"</span>: <span class="string">"8.0"</span>,</span><br><span class="line">                <span class="string">"event"</span>: <span class="string">"interest_service_click"</span>,</span><br><span class="line">                <span class="string">"interest_id"</span>: 1201,</span><br><span class="line">                <span class="string">"index"</span>: 1,</span><br><span class="line">                <span class="string">"interest_name"</span>: <span class="string">"교육"</span>, <span class="string">"interest_service_id"</span>: None, <span class="string">"interest_service_type"</span>: <span class="string">"교육지원"</span>,<span class="string">"interest_service_name"</span>: <span class="string">"자료들"</span>,</span><br><span class="line">                <span class="string">"timestamp"</span>: <span class="string">"2019-05-03T01:15:00Z"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">"user_id"</span>: <span class="string">"Aster-Kotlin-Sapphire-564"</span>,</span><br><span class="line">                <span class="string">"app_version"</span>: <span class="string">"v1.5.16(90)"</span>,</span><br><span class="line">                <span class="string">"device_id"</span>: <span class="string">"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738"</span>,</span><br><span class="line">                <span class="string">"device_manufacturer"</span>: <span class="string">"LG"</span>,</span><br><span class="line">                <span class="string">"device_name"</span>: <span class="string">"LG G7 ThinQ"</span>,</span><br><span class="line">                <span class="string">"device_model"</span>: <span class="string">"LM-G710N"</span>,</span><br><span class="line">                <span class="string">"device_os"</span>: <span class="string">"Android"</span>,</span><br><span class="line">                <span class="string">"device_os_number"</span>: <span class="string">"8.0"</span>,</span><br><span class="line">                <span class="string">"event"</span>: <span class="string">"interest_service_click"</span>,</span><br><span class="line">                <span class="string">"interest_id"</span>: 1201,</span><br><span class="line">                <span class="string">"index"</span>: 1,</span><br><span class="line">                <span class="string">"interest_name"</span>: <span class="string">"교육"</span>,</span><br><span class="line">                <span class="string">"interest_service_id"</span>: None,</span><br><span class="line">                <span class="string">"interest_service_type"</span>: <span class="string">"교육지원"</span>,</span><br><span class="line">                <span class="string">"interest_service_name"</span>: <span class="string">"자료들"</span>,</span><br><span class="line">                <span class="string">"timestamp"</span>: <span class="string">"2019-04-30T07:30:00Z"</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    </span><br><span class="line">	batch_record_to_delivery_stream(test_data_list)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>위의 코드를 실행하면 다음과 같다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ python3 main.py</span><br><span class="line">Put multiple records to Deliver Stream</span><br><span class="line">&#123;<span class="string">'FailedPutCount'</span>: 0, <span class="string">'Encrypted'</span>: False, <span class="string">'RequestResponses'</span>: [&#123;<span class="string">'RecordId'</span>: <span class="string">'JvtN3+H/2oeKA6g087JPipW+g8STzCQQp50mcIw5FQ0wQIC2EihXrB1C31kMjNXY0lcQvXo6bn3H1O/PQMWI3veWxxCb9vkL3lieblJOu+v/q8TLAlsfNCsMADGz9yPLQg4B5uRfogNKv1+M44c6RnAHIg+n5aX/K8UUgbVVF47ZeyiJsokbshNmhO7F8+3BA4rAdXW2O4hSZj640O0RAtw6QuTB3CQN'</span>&#125;, &#123;<span class="string">'RecordId'</span>: <span class="string">'JT+5YNtI/3nwtCiiaoA/w5pBxkHYdbJFwGv8KiYDk7cTjIhenCGmnlBZqpwDswVWNGdnTT+e/qEP3VQI2dx1cwjHDpRRlilNBOYwKZaueoazeQ77p2NKgarweztvVVK1r91PjIlEUlW3fJfSAqiZsCoa6NQDs3u51gRNxi8Z9iBA/3uUXDehUkszxmlIzpvFKmrYrJ6UGIdBDHIpyqmWYdCAwAXJJTBk'</span>&#125;, &#123;<span class="string">'RecordId'</span>: <span class="string">'Mriv4BFuAEpziVO0hX0zZsoCspb8Sl4fdTOUitqYYTKGhfr+7noUWfYTTp0QF0JkuS8z/KHEr8aiV53IrLe860NzZY1mSN4ZAxmIKLxQqwQceFaj0xEBJJuYjrSOuDKRVD3rCz8n/Ab4QzEP/FOrUioKK7uf4kySsE7TvTkW1pWeKHabE27FjK/+9x4//3ep3fjp5K3TO81UX6Xk7AFa5BxiGUjVzcTI'</span>&#125;], <span class="string">'ResponseMetadata'</span>: &#123;<span class="string">'RequestId'</span>: <span class="string">'c59f84d4-d42a-432f-9042-d44926133eb6'</span>, <span class="string">'HTTPStatusCode'</span>: 200, <span class="string">'HTTPHeaders'</span>: &#123;<span class="string">'x-amzn-requestid'</span>: <span class="string">'c59f84d4-d42a-432f-9042-d44926133eb6'</span>, <span class="string">'x-amz-id-2'</span>: <span class="string">'01OYNLqVZ9T7VGgpQ/pSJ1MtwblA5/kShluUDM6sLzv4ncJEyTrM7lHoKxEwo1EWzbXZmIu7Nz0oaw72UhQhAzAl3Ji9BgqZ'</span>, <span class="string">'content-type'</span>: <span class="string">'application/x-amz-json-1.1'</span>, <span class="string">'content-length'</span>: <span class="string">'779'</span>, <span class="string">'date'</span>: <span class="string">'Mon, 26 Aug 2019 03:13:32 GMT'</span>&#125;, <span class="string">'RetryAttempts'</span>: 0&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>실제 Amazon elasticsearch에서 레코드가 입력되었는지 확인하면 다음과 같다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">$ curl -XGET <span class="comment">## AWS Elasticsearch 엔드포인트/interest_service_click2/_search\?filter_path\=hits\&amp;format\=json\&amp;pretty</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"hits"</span> : &#123;</span><br><span class="line">    <span class="string">"total"</span> : 4,</span><br><span class="line">    <span class="string">"max_score"</span> : 1.0,</span><br><span class="line">    <span class="string">"hits"</span> : [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"interest_service_click2"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"isc"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"49595937143545169094912246787272632161781037484956712962.0"</span>,</span><br><span class="line">        <span class="string">"_score"</span> : 1.0,</span><br><span class="line">        <span class="string">"_source"</span> : &#123;</span><br><span class="line">          <span class="string">"user_id"</span> : <span class="string">"Aster-Kotlin-Sapphire-564"</span>,</span><br><span class="line">          <span class="string">"app_version"</span> : <span class="string">"v1.5.16(90)"</span>,</span><br><span class="line">          <span class="string">"device_id"</span> : <span class="string">"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738"</span>,</span><br><span class="line">          <span class="string">"device_manufacturer"</span> : <span class="string">"LG"</span>,</span><br><span class="line">          <span class="string">"device_name"</span> : <span class="string">"LG G7 ThinQ"</span>,</span><br><span class="line">          <span class="string">"device_model"</span> : <span class="string">"LM-G710N"</span>,</span><br><span class="line">          <span class="string">"device_os"</span> : <span class="string">"Android"</span>,</span><br><span class="line">          <span class="string">"device_os_number"</span> : <span class="string">"8.0"</span>,</span><br><span class="line">          <span class="string">"event"</span> : <span class="string">"interest_service_click"</span>,</span><br><span class="line">          <span class="string">"interest_id"</span> : 1201,</span><br><span class="line">          <span class="string">"index"</span> : 1,</span><br><span class="line">          <span class="string">"interest_name"</span> : <span class="string">"교육"</span>,</span><br><span class="line">          <span class="string">"interest_service_id"</span> : null,</span><br><span class="line">          <span class="string">"interest_service_type"</span> : <span class="string">"교육지원"</span>,</span><br><span class="line">          <span class="string">"interest_service_name"</span> : <span class="string">"자료들"</span>,</span><br><span class="line">          <span class="string">"timestamp"</span> : <span class="string">"2019-05-03T01:15:00Z"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"interest_service_click2"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"isc"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"49595937143545169094912246787271423235961422855782006786.0"</span>,</span><br><span class="line">        <span class="string">"_score"</span> : 1.0,</span><br><span class="line">        <span class="string">"_source"</span> : &#123;</span><br><span class="line">          <span class="string">"user_id"</span> : <span class="string">"Aster-Kotlin-Sapphire-564"</span>,</span><br><span class="line">          <span class="string">"app_version"</span> : <span class="string">"v1.5.16(90)"</span>,</span><br><span class="line">          <span class="string">"device_id"</span> : <span class="string">"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738"</span>,</span><br><span class="line">          <span class="string">"device_manufacturer"</span> : <span class="string">"LG"</span>,</span><br><span class="line">          <span class="string">"device_name"</span> : <span class="string">"LG G7 ThinQ"</span>,</span><br><span class="line">          <span class="string">"device_model"</span> : <span class="string">"LM-G710N"</span>,</span><br><span class="line">          <span class="string">"device_os"</span> : <span class="string">"Android"</span>,</span><br><span class="line">          <span class="string">"device_os_number"</span> : <span class="string">"8.0"</span>,</span><br><span class="line">          <span class="string">"event"</span> : <span class="string">"interest_service_click"</span>,</span><br><span class="line">          <span class="string">"interest_id"</span> : 1301,</span><br><span class="line">          <span class="string">"index"</span> : 1,</span><br><span class="line">          <span class="string">"interest_name"</span> : <span class="string">"취업"</span>,</span><br><span class="line">          <span class="string">"interest_service_id"</span> : null,</span><br><span class="line">          <span class="string">"interest_service_type"</span> : <span class="string">"배워봐요"</span>,</span><br><span class="line">          <span class="string">"interest_service_name"</span> : <span class="string">"학원"</span>,</span><br><span class="line">          <span class="string">"timestamp"</span> : <span class="string">"2019-05-03T00:50:00Z"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"interest_service_click2"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"isc"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"49595937143545169094912246787270214310141808226607300610.0"</span>,</span><br><span class="line">        <span class="string">"_score"</span> : 1.0,</span><br><span class="line">        <span class="string">"_source"</span> : &#123;</span><br><span class="line">          <span class="string">"user_id"</span> : <span class="string">"Aster-Kotlin-Sapphire-564"</span>,</span><br><span class="line">          <span class="string">"app_version"</span> : <span class="string">"v1.5.16(90)"</span>,</span><br><span class="line">          <span class="string">"device_id"</span> : <span class="string">"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738"</span>,</span><br><span class="line">          <span class="string">"device_manufacturer"</span> : <span class="string">"LG"</span>,</span><br><span class="line">          <span class="string">"device_name"</span> : <span class="string">"LG G7 ThinQ"</span>,</span><br><span class="line">          <span class="string">"device_model"</span> : <span class="string">"LM-G710N"</span>,</span><br><span class="line">          <span class="string">"device_os"</span> : <span class="string">"Android"</span>,</span><br><span class="line">          <span class="string">"device_os_number"</span> : <span class="string">"8.0"</span>,</span><br><span class="line">          <span class="string">"event"</span> : <span class="string">"interest_service_click"</span>,</span><br><span class="line">          <span class="string">"interest_id"</span> : 1101,</span><br><span class="line">          <span class="string">"index"</span> : 1,</span><br><span class="line">          <span class="string">"interest_name"</span> : <span class="string">"초등학교"</span>,</span><br><span class="line">          <span class="string">"interest_service_id"</span> : null,</span><br><span class="line">          <span class="string">"interest_service_type"</span> : <span class="string">"물어봐요"</span>,</span><br><span class="line">          <span class="string">"interest_service_name"</span> : <span class="string">"익명게시판"</span>,</span><br><span class="line">          <span class="string">"timestamp"</span> : <span class="string">"2019-05-03T00:20:00Z"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>백업용 s3 데이터를 확인하면 다음과 같다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ aws s3 ls s3://kevin_bucket_test/2019/08/26/03/</span><br><span class="line">2019-08-26 12:14:35       1528 kevin-firehose-test-1-2019-08-26-03-13-33-dd434742-87da-4cbe-b62a-b84c0366215f</span><br><span class="line"></span><br><span class="line">$ aws s3 cp s3://kevin_bucket_test/2019/08/26/03/kevin-firehose-test-1-2019-08-26-03-13-33-dd434742-87da-4cbe-b62a-b84c0366215f ~/dev/boto3_test/kinesis_data_firehose/multiple_record.txt</span><br><span class="line">download: s3://kevin_bucket_test/2019/08/26/03/kevin-firehose-test-1-2019-08-26-03-13-33-dd434742-87da-4cbe-b62a-b84c0366215f to dev/boto3_test/kinesis_data_firehose/multiple_record.txt</span><br><span class="line"></span><br><span class="line">$ cat dev/boto3_test/kinesis_data_firehose/multiple_record.txt</span><br><span class="line">&#123;<span class="string">"user_id"</span>: <span class="string">"Aster-Kotlin-Sapphire-564"</span>, <span class="string">"app_version"</span>: <span class="string">"v1.5.16(90)"</span>, <span class="string">"device_id"</span>: <span class="string">"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738"</span>, <span class="string">"device_manufacturer"</span>: <span class="string">"LG"</span>, <span class="string">"device_name"</span>: <span class="string">"LG G7 ThinQ"</span>, <span class="string">"device_model"</span>: <span class="string">"LM-G710N"</span>, <span class="string">"device_os"</span>: <span class="string">"Android"</span>, <span class="string">"device_os_number"</span>: <span class="string">"8.0"</span>, <span class="string">"event"</span>: <span class="string">"interest_service_click"</span>, <span class="string">"interest_id"</span>: 1101, <span class="string">"index"</span>: 1, <span class="string">"interest_name"</span>: <span class="string">"초등학교"</span>, <span class="string">"interest_service_id"</span>: null, <span class="string">"interest_service_type"</span>: <span class="string">"물어봐요"</span>, <span class="string">"interest_service_name"</span>: <span class="string">"익명게시판"</span>, <span class="string">"timestamp"</span>: <span class="string">"2019-05-03T00:20:00Z"</span>&#125;</span><br><span class="line">&#123;<span class="string">"user_id"</span>: <span class="string">"Aster-Kotlin-Sapphire-564"</span>, <span class="string">"app_version"</span>: <span class="string">"v1.5.16(90)"</span>, <span class="string">"device_id"</span>: <span class="string">"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738"</span>, <span class="string">"device_manufacturer"</span>: <span class="string">"LG"</span>, <span class="string">"device_name"</span>: <span class="string">"LG G7 ThinQ"</span>, <span class="string">"device_model"</span>: <span class="string">"LM-G710N"</span>, <span class="string">"device_os"</span>: <span class="string">"Android"</span>, <span class="string">"device_os_number"</span>: <span class="string">"8.0"</span>, <span class="string">"event"</span>: <span class="string">"interest_service_click"</span>, <span class="string">"interest_id"</span>: 1301, <span class="string">"index"</span>: 1, <span class="string">"interest_name"</span>: <span class="string">"취업"</span>, <span class="string">"interest_service_id"</span>: null, <span class="string">"interest_service_type"</span>: <span class="string">"배워봐요"</span>, <span class="string">"interest_service_name"</span>: <span class="string">"학원"</span>, <span class="string">"timestamp"</span>: <span class="string">"2019-05-03T00:50:00Z"</span>&#125;</span><br><span class="line">&#123;<span class="string">"user_id"</span>: <span class="string">"Aster-Kotlin-Sapphire-564"</span>, <span class="string">"app_version"</span>: <span class="string">"v1.5.16(90)"</span>, <span class="string">"device_id"</span>: <span class="string">"a03cd3d6-0b14-46e1-a2c8-18b1c86cf738"</span>, <span class="string">"device_manufacturer"</span>: <span class="string">"LG"</span>, <span class="string">"device_name"</span>: <span class="string">"LG G7 ThinQ"</span>, <span class="string">"device_model"</span>: <span class="string">"LM-G710N"</span>, <span class="string">"device_os"</span>: <span class="string">"Android"</span>, <span class="string">"device_os_number"</span>: <span class="string">"8.0"</span>, <span class="string">"event"</span>: <span class="string">"interest_service_click"</span>, <span class="string">"interest_id"</span>: 1201, <span class="string">"index"</span>: 1, <span class="string">"interest_name"</span>: <span class="string">"교육"</span>, <span class="string">"interest_service_id"</span>: null, <span class="string">"interest_service_type"</span>: <span class="string">"교육지원"</span>, <span class="string">"interest_service_name"</span>: <span class="string">"자료들"</span>, <span class="string">"timestamp"</span>: <span class="string">"2019-05-03T01:15:00Z"</span>&#125;%</span><br></pre></td></tr></table></figure>

<p>결과는 다음과 같이 정리할 수 있다.</p>
<ul>
<li>Boto3를 이용하여 다중 레코드를 firehose에 전송한다.</li>
<li>Amazon elasticsearch의 index와 S3의 백업 데이터를 확인한 결과 다중 레코드가 정상적으로 전송된 것을 확인할 수 있다.</li>
</ul>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/Boto3/" rel="tag">Boto3</a> <a class="tag tag--primary tag--small t-link" href="/tags/Kinesis-Data-Firehose/" rel="tag">Kinesis Data Firehose</a> <a class="tag tag--primary tag--small t-link" href="/tags/S3/" rel="tag">S3</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2019/08/30/Fluentd-%ED%8C%8C%EC%9D%BC-%EB%A1%9C%EA%B7%B8-%EC%88%98%EC%A7%91-%EA%B4%80%EB%A0%A8-%ED%8C%8C%EC%9D%BC-%EC%83%9D%EC%84%B1-%EC%8B%9C%EC%A0%90-%ED%85%8C%EC%8A%A4%ED%8A%B8/"
                    data-tooltip="Fluentd - 파일 로그 수집 관련 파일 생성 시점 테스트"
                    aria-label="PREVIOUS: Fluentd - 파일 로그 수집 관련 파일 생성 시점 테스트"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2019/08/27/AWS-CLI-%EA%B8%B0%EC%B4%88-%ED%95%99%EC%8A%B5-%EC%A0%95%EB%A6%AC/"
                    data-tooltip="AWS CLI 기초 학습 정리"
                    aria-label="NEXT: AWS CLI 기초 학습 정리"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://usehun0625.github.io/2019/08/27/Boto3%EB%A1%9C-S3-Kinesis-Data-Firehose-%EA%B8%B0%EC%B4%88-%EC%8B%A4%EC%8A%B5/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=http://usehun0625.github.io/2019/08/27/Boto3%EB%A1%9C-S3-Kinesis-Data-Firehose-%EA%B8%B0%EC%B4%88-%EC%8B%A4%EC%8A%B5/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=http://usehun0625.github.io/2019/08/27/Boto3%EB%A1%9C-S3-Kinesis-Data-Firehose-%EA%B8%B0%EC%B4%88-%EC%8B%A4%EC%8A%B5/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#disqus_thread"
                        aria-label="Leave a comment"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="Table of Contents">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
                <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript>
</div>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2021 Kevin. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2019/08/30/Fluentd-%ED%8C%8C%EC%9D%BC-%EB%A1%9C%EA%B7%B8-%EC%88%98%EC%A7%91-%EA%B4%80%EB%A0%A8-%ED%8C%8C%EC%9D%BC-%EC%83%9D%EC%84%B1-%EC%8B%9C%EC%A0%90-%ED%85%8C%EC%8A%A4%ED%8A%B8/"
                    data-tooltip="Fluentd - 파일 로그 수집 관련 파일 생성 시점 테스트"
                    aria-label="PREVIOUS: Fluentd - 파일 로그 수집 관련 파일 생성 시점 테스트"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2019/08/27/AWS-CLI-%EA%B8%B0%EC%B4%88-%ED%95%99%EC%8A%B5-%EC%A0%95%EB%A6%AC/"
                    data-tooltip="AWS CLI 기초 학습 정리"
                    aria-label="NEXT: AWS CLI 기초 학습 정리"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://usehun0625.github.io/2019/08/27/Boto3%EB%A1%9C-S3-Kinesis-Data-Firehose-%EA%B8%B0%EC%B4%88-%EC%8B%A4%EC%8A%B5/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=http://usehun0625.github.io/2019/08/27/Boto3%EB%A1%9C-S3-Kinesis-Data-Firehose-%EA%B8%B0%EC%B4%88-%EC%8B%A4%EC%8A%B5/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=http://usehun0625.github.io/2019/08/27/Boto3%EB%A1%9C-S3-Kinesis-Data-Firehose-%EA%B8%B0%EC%B4%88-%EC%8B%A4%EC%8A%B5/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#disqus_thread"
                        aria-label="Leave a comment"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="Table of Contents">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="5">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=http://usehun0625.github.io/2019/08/27/Boto3%EB%A1%9C-S3-Kinesis-Data-Firehose-%EA%B8%B0%EC%B4%88-%EC%8B%A4%EC%8A%B5/"
                        aria-label="Share on Facebook"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=http://usehun0625.github.io/2019/08/27/Boto3%EB%A1%9C-S3-Kinesis-Data-Firehose-%EA%B8%B0%EC%B4%88-%EC%8B%A4%EC%8A%B5/"
                        aria-label="Share on Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://plus.google.com/share?url=http://usehun0625.github.io/2019/08/27/Boto3%EB%A1%9C-S3-Kinesis-Data-Firehose-%EA%B8%B0%EC%B4%88-%EC%8B%A4%EC%8A%B5/"
                        aria-label="Share on Google+"
                    >
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Share on Google+</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/beer.jpg" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">Kevin</h4>
        
            <div id="about-card-bio"><p>Kevin, 이용훈<br>어릴 때부터 코딩에 흥미를 가지고 살아왔습니다. 새로운 기술도 열정적으로 받아들이며 더 좋은 개발을 위하여 학습하고 경험하고 노력하고 있습니다.</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Developer, DE</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                서울 / 대한민국
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/curtain.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/jquery.js"></script>


<script src="/assets/js/jquery.fancybox.js"></script>


<script src="/assets/js/thumbs.js"></script>


<script src="/assets/js/tranquilpeak.js"></script>

<!--SCRIPTS END-->


    
        <script>
          var disqus_config = function() {
            this.page.url = 'http://usehun0625.github.io/2019/08/27/Boto3%EB%A1%9C-S3-Kinesis-Data-Firehose-%EA%B8%B0%EC%B4%88-%EC%8B%A4%EC%8A%B5/';
              
            this.page.identifier = '2019/08/27/Boto3로-S3-Kinesis-Data-Firehose-기초-실습/';
              
          };
          (function() {
            var d = document, s = d.createElement('script');
            var disqus_shortname = 'usehun0625';
            s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
          })();
        </script>
    




    </body>
</html>
